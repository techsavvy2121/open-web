import{s as J,M as ce,q as ue,E as P,F as W,a as T,d as h,f as c,i as I,g as w,n as H,z as de,B as he,j as F,p as fe,e as j,t as L,k as N,c as E,b as M,o as O,G as me,u as Z,h as A}from"./BDiUIGvQ.js";import{S as G,i as Y,b as X,d as ee,m as te,t as $,a as q,e as ae,f as pe,g as _e,c as ge}from"./CMw2dQw9.js";import{a as we,b as ye,u as re,d as ne,e as ke,f as K,s as be,h as ve}from"./CJKdcpwZ.js";import{r as oe,m as Ce,c as Se,e as z}from"./0WLtkgvg.js";import{T as Te}from"./BKnRhfIz.js";import{t as Q}from"./CCWCPRcv.js";import{m as Ie}from"./CXA2wbo1.js";import{M as je}from"./cyg7nPOp.js";function Ee(r){let e,a;return e=new Te({props:{tags:r[0]}}),e.$on("delete",r[4]),e.$on("add",r[5]),{c(){X(e.$$.fragment)},l(t){ee(e.$$.fragment,t)},m(t,s){te(e,t,s),a=!0},p(t,[s]){const n={};s&1&&(n.tags=t[0]),e.$set(n)},i(t){a||($(e.$$.fragment,t),a=!0)},o(t){q(e.$$.fragment,t),a=!1},d(t){ae(e,t)}}}function Be(r,e,a){const t=ce();let{chatId:s=""}=e,n=[];const o=async()=>await we(localStorage.token,s).catch(async m=>[]),i=async m=>{await ye(localStorage.token,s,m).catch(async f=>(Q.error(`${f}`),null))&&(a(0,n=await o()),await re(localStorage.token,s,{tags:n}),await oe.set(await ne(localStorage.token)),t("add",{name:m}))},p=async m=>{await ke(localStorage.token,s,m),a(0,n=await o()),await re(localStorage.token,s,{tags:n}),await oe.set(await ne(localStorage.token)),t("delete",{name:m})};ue(async()=>{s&&a(0,n=await o())});const v=m=>{p(m.detail)},C=m=>{i(m.detail)};return r.$$set=m=>{"chatId"in m&&a(3,s=m.chatId)},[n,i,p,s,v,C]}class Fe extends G{constructor(e){super(),Y(this,e,Be,Ee,J,{chatId:3})}}function Le(r){let e,a,t;return{c(){e=P("svg"),a=P("path"),t=P("path"),this.h()},l(s){e=W(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var n=T(e);a=W(n,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),T(a).forEach(h),t=W(n,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),T(t).forEach(h),n.forEach(h),this.h()},h(){c(a,"fill-rule","evenodd"),c(a,"d","M8.914 6.025a.75.75 0 0 1 1.06 0 3.5 3.5 0 0 1 0 4.95l-2 2a3.5 3.5 0 0 1-5.396-4.402.75.75 0 0 1 1.251.827 2 2 0 0 0 3.085 2.514l2-2a2 2 0 0 0 0-2.828.75.75 0 0 1 0-1.06Z"),c(a,"clip-rule","evenodd"),c(t,"fill-rule","evenodd"),c(t,"d","M7.086 9.975a.75.75 0 0 1-1.06 0 3.5 3.5 0 0 1 0-4.95l2-2a3.5 3.5 0 0 1 5.396 4.402.75.75 0 0 1-1.251-.827 2 2 0 0 0-3.085-2.514l-2 2a2 2 0 0 0 0 2.828.75.75 0 0 1 0 1.06Z"),c(t,"clip-rule","evenodd"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"viewBox","0 0 16 16"),c(e,"fill","currentColor"),c(e,"class",r[0])},m(s,n){I(s,e,n),w(e,a),w(e,t)},p(s,[n]){n&1&&c(e,"class",s[0])},i:H,o:H,d(s){s&&h(e)}}}function Me(r,e,a){let{className:t="w-4 h-4"}=e;return r.$$set=s=>{"className"in s&&a(0,t=s.className)},[t]}class Ue extends G{constructor(e){super(),Y(this,e,Me,Le,J,{className:0})}}function le(r){var B;let e,a,t,s,n,o,i,p,v,C,m,b,f;function _(l,d){return l[2].share_id?Ne:Ae}let y=_(r),k=y(r),g=((B=r[4])==null?void 0:B.features.enable_community_sharing)&&ie(r);v=new Ue({});function U(l,d){return l[2].share_id?De:Oe}let u=U(r),S=u(r);return{c(){e=j("div"),a=j("div"),k.c(),t=N(),s=j("div"),n=j("div"),o=j("div"),g&&g.c(),i=N(),p=j("button"),X(v.$$.fragment),C=N(),S.c(),this.h()},l(l){e=E(l,"DIV",{class:!0});var d=T(e);a=E(d,"DIV",{class:!0});var D=T(a);k.l(D),D.forEach(h),t=O(d),s=E(d,"DIV",{class:!0});var V=T(s);n=E(V,"DIV",{class:!0});var se=T(n);o=E(se,"DIV",{class:!0});var x=T(o);g&&g.l(x),i=O(x),p=E(x,"BUTTON",{class:!0,type:!0,id:!0});var R=T(p);ee(v.$$.fragment,R),C=O(R),S.l(R),R.forEach(h),x.forEach(h),se.forEach(h),V.forEach(h),d.forEach(h),this.h()},h(){c(a,"class","text-sm dark:text-gray-300 mb-1"),c(p,"class","self-center flex items-center gap-1 px-3.5 py-2 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),c(p,"type","button"),c(p,"id","copy-and-share-chat-button"),c(o,"class","flex gap-1"),c(n,"class","flex flex-col items-end space-x-1 mt-3"),c(s,"class","flex justify-end"),c(e,"class","px-5 pt-4 pb-5 w-full flex flex-col justify-center")},m(l,d){I(l,e,d),w(e,a),k.m(a,null),w(e,t),w(e,s),w(s,n),w(n,o),g&&g.m(o,null),w(o,i),w(o,p),te(v,p,null),w(p,C),S.m(p,null),m=!0,b||(f=Z(p,"click",r[11]),b=!0)},p(l,d){var D;y===(y=_(l))&&k?k.p(l,d):(k.d(1),k=y(l),k&&(k.c(),k.m(a,null))),(D=l[4])!=null&&D.features.enable_community_sharing?g?g.p(l,d):(g=ie(l),g.c(),g.m(o,i)):g&&(g.d(1),g=null),u===(u=U(l))&&S?S.p(l,d):(S.d(1),S=u(l),S&&(S.c(),S.m(p,null)))},i(l){m||($(v.$$.fragment,l),m=!0)},o(l){q(v.$$.fragment,l),m=!1},d(l){l&&h(e),k.d(),g&&g.d(),ae(v),S.d(),b=!1,f()}}}function Ae(r){let e=r[3].t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")+"",a;return{c(){a=L(e)},l(t){a=M(t,e)},m(t,s){I(t,a,s)},p(t,s){s&8&&e!==(e=t[3].t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")+"")&&A(a,e)},d(t){t&&h(a)}}}function Ne(r){let e,a=r[3].t("You have shared this chat")+"",t,s,n,o=r[3].t("before")+"",i,p,v,C,m=r[3].t("Click here to")+"",b,f,_,y=r[3].t("delete this link")+"",k,g,U=r[3].t("and create a new shared link.")+"",u,S,B;return{c(){e=j("a"),t=L(a),s=N(),n=j("span"),i=L(o),p=L("."),C=N(),b=L(m),f=N(),_=j("button"),k=L(y),g=N(),u=L(U),this.h()},l(l){e=E(l,"A",{href:!0,target:!0});var d=T(e);t=M(d,a),s=O(d),n=E(d,"SPAN",{class:!0});var D=T(n);i=M(D,o),D.forEach(h),p=M(d,"."),d.forEach(h),C=O(l),b=M(l,m),f=O(l),_=E(l,"BUTTON",{class:!0});var V=T(_);k=M(V,y),V.forEach(h),g=O(l),u=M(l,U),this.h()},h(){c(n,"class","underline"),c(e,"href",v="/s/"+r[2].share_id),c(e,"target","_blank"),c(_,"class","underline")},m(l,d){I(l,e,d),w(e,t),w(e,s),w(e,n),w(n,i),w(e,p),I(l,C,d),I(l,b,d),I(l,f,d),I(l,_,d),w(_,k),I(l,g,d),I(l,u,d),S||(B=Z(_,"click",r[9]),S=!0)},p(l,d){d&8&&a!==(a=l[3].t("You have shared this chat")+"")&&A(t,a),d&8&&o!==(o=l[3].t("before")+"")&&A(i,o),d&4&&v!==(v="/s/"+l[2].share_id)&&c(e,"href",v),d&8&&m!==(m=l[3].t("Click here to")+"")&&A(b,m),d&8&&y!==(y=l[3].t("delete this link")+"")&&A(k,y),d&8&&U!==(U=l[3].t("and create a new shared link.")+"")&&A(u,U)},d(l){l&&(h(e),h(C),h(b),h(f),h(_),h(g),h(u)),S=!1,B()}}}function ie(r){let e,a=r[3].t("Share to Open WebUI Community")+"",t,s,n;return{c(){e=j("button"),t=L(a),this.h()},l(o){e=E(o,"BUTTON",{class:!0,type:!0});var i=T(e);t=M(i,a),i.forEach(h),this.h()},h(){c(e,"class","self-center flex items-center gap-1 px-3.5 py-2 text-sm font-medium bg-gray-100 hover:bg-gray-200 text-gray-800 dark:bg-gray-850 dark:text-white dark:hover:bg-gray-800 transition rounded-full"),c(e,"type","button")},m(o,i){I(o,e,i),w(e,t),s||(n=Z(e,"click",r[10]),s=!0)},p(o,i){i&8&&a!==(a=o[3].t("Share to Open WebUI Community")+"")&&A(t,a)},d(o){o&&h(e),s=!1,n()}}}function Oe(r){let e=r[3].t("Copy Link")+"",a;return{c(){a=L(e)},l(t){a=M(t,e)},m(t,s){I(t,a,s)},p(t,s){s&8&&e!==(e=t[3].t("Copy Link")+"")&&A(a,e)},d(t){t&&h(a)}}}function De(r){let e=r[3].t("Update and Copy Link")+"",a;return{c(){a=L(e)},l(t){a=M(t,e)},m(t,s){I(t,a,s)},p(t,s){s&8&&e!==(e=t[3].t("Update and Copy Link")+"")&&A(a,e)},d(t){t&&h(a)}}}function $e(r){let e,a,t,s=r[3].t("Share Chat")+"",n,o,i,p='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',v,C,m,b,f=r[2]&&le(r);return{c(){e=j("div"),a=j("div"),t=j("div"),n=L(s),o=N(),i=j("button"),i.innerHTML=p,v=N(),f&&f.c(),this.h()},l(_){e=E(_,"DIV",{});var y=T(e);a=E(y,"DIV",{class:!0});var k=T(a);t=E(k,"DIV",{class:!0});var g=T(t);n=M(g,s),g.forEach(h),o=O(k),i=E(k,"BUTTON",{class:!0,"data-svelte-h":!0}),me(i)!=="svelte-745w2y"&&(i.innerHTML=p),k.forEach(h),v=O(y),f&&f.l(y),y.forEach(h),this.h()},h(){c(t,"class","text-lg font-medium self-center"),c(i,"class","self-center"),c(a,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-0.5")},m(_,y){I(_,e,y),w(e,a),w(a,t),w(t,n),w(a,o),w(a,i),w(e,v),f&&f.m(e,null),C=!0,m||(b=Z(i,"click",r[8]),m=!0)},p(_,y){(!C||y&8)&&s!==(s=_[3].t("Share Chat")+"")&&A(n,s),_[2]?f?(f.p(_,y),y&4&&$(f,1)):(f=le(_),f.c(),$(f,1),f.m(e,null)):f&&(_e(),q(f,1,1,()=>{f=null}),ge())},i(_){C||($(f),C=!0)},o(_){q(f),C=!1},d(_){_&&h(e),f&&f.d(),m=!1,b()}}}function ze(r){let e,a,t;function s(o){r[12](o)}let n={size:"md",$$slots:{default:[$e]},$$scope:{ctx:r}};return r[0]!==void 0&&(n.show=r[0]),e=new je({props:n}),de.push(()=>pe(e,"show",s)),{c(){X(e.$$.fragment)},l(o){ee(e.$$.fragment,o)},m(o,i){te(e,o,i),t=!0},p(o,[i]){const p={};i&65567&&(p.$$scope={dirty:i,ctx:o}),!a&&i&1&&(a=!0,p.show=o[0],he(()=>a=!1)),e.$set(p)},i(o){t||($(e.$$.fragment,o),t=!0)},o(o){q(e.$$.fragment,o),t=!1},d(o){ae(e,o)}}}function Ve(r,e,a){let t,s,n;F(r,Ce,u=>a(14,t=u)),F(r,Se,u=>a(4,n=u));let{chatId:o}=e,i=null,p=null;const v=fe("i18n");F(r,v,u=>a(3,s=u));const C=async()=>{const u=await be(localStorage.token,o);return p=`${window.location.origin}/s/${u.id}`,console.log(p),a(2,i=await K(localStorage.token,o)),p},m=async()=>{const u=i.chat;console.log("share",u),Q.success(s.t("Redirecting you to Open WebUI Community"));const S="https://openwebui.com",B=await window.open(`${S}/chats/upload`,"_blank");window.addEventListener("message",l=>{l.origin===S&&l.data==="loaded"&&B.postMessage(JSON.stringify({chat:u,models:t.filter(d=>u.models.includes(d.id))}),"*")},!1)};let{show:b=!1}=e;const f=u=>i?u?i.id!==u.id||i.share_id!==u.share_id:!1:!0,_=()=>{a(0,b=!1)},y=async()=>{await ve(localStorage.token,o)&&a(2,i=await K(localStorage.token,o))},k=()=>{m(),a(0,b=!1)},g=async()=>{if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent)){console.log("isSafari");const S=async()=>{const B=await C();return new Blob([B],{type:"text/plain"})};navigator.clipboard.write([new ClipboardItem({"text/plain":S()})]).then(()=>(console.log("Async: Copying to clipboard was successful!"),!0)).catch(B=>(console.error("Async: Could not copy text: ",B),!1))}else Ie(await C());Q.success(s.t("Copied shared chat URL to clipboard!")),a(0,b=!1)};function U(u){b=u,a(0,b)}return r.$$set=u=>{"chatId"in u&&a(1,o=u.chatId),"show"in u&&a(0,b=u.show)},r.$$.update=()=>{r.$$.dirty&7&&b&&(async()=>{if(o){const u=await K(localStorage.token,o);f(u)&&a(2,i=u)}else a(2,i=null),console.log(i)})()},[b,o,i,s,n,v,C,m,_,y,k,g,U]}class Ke extends G{constructor(e){super(),Y(this,e,Ve,ze,J,{chatId:1,show:0})}}function Pe(r){let e,a;return{c(){e=P("svg"),a=P("path"),this.h()},l(t){e=W(t,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=T(e);a=W(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),T(a).forEach(h),s.forEach(h),this.h()},h(){c(a,"stroke-linecap","round"),c(a,"stroke-linejoin","round"),c(a,"d","m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"stroke-width",r[1]),c(e,"stroke","currentColor"),c(e,"class",r[0])},m(t,s){I(t,e,s),w(e,a)},p(t,[s]){s&2&&c(e,"stroke-width",t[1]),s&1&&c(e,"class",t[0])},i:H,o:H,d(t){t&&h(e)}}}function We(r,e,a){let{className:t="size-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&a(0,t=n.className),"strokeWidth"in n&&a(1,s=n.strokeWidth)},[t,s]}class Qe extends G{constructor(e){super(),Y(this,e,We,Pe,J,{className:0,strokeWidth:1})}}const Xe=async r=>{let e=null;const a=await fetch(`${z}/memories/`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${r}`}}).then(async t=>{if(!t.ok)throw await t.json();return t.json()}).catch(t=>(e=t.detail,console.error(t),null));if(e)throw e;return a},et=async(r,e)=>{let a=null;const t=await fetch(`${z}/memories/add`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${r}`},body:JSON.stringify({content:e})}).then(async s=>{if(!s.ok)throw await s.json();return s.json()}).catch(s=>(a=s.detail,console.error(s),null));if(a)throw a;return t},tt=async(r,e,a)=>{let t=null;const s=await fetch(`${z}/memories/${e}/update`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${r}`},body:JSON.stringify({content:a})}).then(async n=>{if(!n.ok)throw await n.json();return n.json()}).catch(n=>(t=n.detail,console.error(n),null));if(t)throw t;return s},at=async(r,e)=>{let a=null;const t=await fetch(`${z}/memories/query`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${r}`},body:JSON.stringify({content:e})}).then(async s=>{if(!s.ok)throw await s.json();return s.json()}).catch(s=>(a=s.detail,console.error(s),null));if(a)throw a;return t},st=async(r,e)=>{let a=null;const t=await fetch(`${z}/memories/${e}`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${r}`}}).then(async s=>{if(!s.ok)throw await s.json();return s.json()}).then(s=>s).catch(s=>(a=s.detail,console.error(s),null));if(a)throw a;return t},rt=async r=>{let e=null;const a=await fetch(`${z}/memories/delete/user`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${r}`}}).then(async t=>{if(!t.ok)throw await t.json();return t.json()}).then(t=>t).catch(t=>(e=t.detail,console.error(t),null));if(e)throw e;return a};export{Qe as P,Ke as S,Fe as T,et as a,st as b,rt as d,Xe as g,at as q,tt as u};
//# sourceMappingURL=DWSWdbNX.js.map
