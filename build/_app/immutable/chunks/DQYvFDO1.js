var hr=Object.defineProperty;var mr=(n,e,t)=>e in n?hr(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var pt=(n,e,t)=>mr(n,typeof e!="symbol"?e+"":e,t);import{s as Be,e as y,k as H,c as I,a as w,d as m,o as j,f as h,i as V,g as p,n as Me,t as W,b as q,G as Ue,C as ot,u as de,h as K,Q as Ge,I as $e,j as Ee,p as Ke,M as vt,q as kt,z as je,B as Ye,r as gr,v as _r,w as pr,x as br,l as fe,E as ye,F as Ie,T as Rt,D as Ve,N as vr,an as kr,y as Lt,P as Bt,Z as wr,_ as yr}from"./BDiUIGvQ.js";import{S as Le,i as Pe,b as x,d as ee,m as te,t as b,a as D,e as le,f as Xe,g as se,c as ne,j as St}from"./CMw2dQw9.js";import{e as De,u as Jt,o as Bn,d as Ir}from"./DgmbscGK.js";import{m as jt,e as dl,j as Sn,b as gt,i as Mr,G as hl,H as ml,J as Er,K as Dr,c as On,T as gl,u as zt,n as Gt,g as Pt,W as Nr,d as _l,B as pl,D as Vr}from"./0WLtkgvg.js";import{t as He}from"./CCWCPRcv.js";import{f as Cr,u as Tr,i as Br}from"./CJKdcpwZ.js";import{b as Ft,w as Sr,m as Rn,x as Or,i as bt,u as At,l as Ln,v as bl}from"./CXA2wbo1.js";import{d as at}from"./I1CDPYOB.js";import"./BFK-koEx.js";import{u as vl,c as Rr}from"./CZSY5qDY.js";import{c as Lr}from"./CkdqFX_w.js";import{s as Pr}from"./VRd9YPu6.js";import{i as Ar,E as Hr}from"./CMqxxCwe.js";import{P as Pn,N as Kt}from"./BRAB8y4I.js";import{I as Zt}from"./CVWlYbfy.js";import{T as Oe}from"./DZF3XBRY.js";import{T as jr}from"./BKnRhfIz.js";import{C as An}from"./BZH8uq8K.js";import{C as Hn}from"./Cv_KpQSI.js";import{M as zr}from"./BfvhWxBg.js";import{aF as jn,aU as Ur,aK as It,aV as Wr,aW as qr}from"./ahIyCdRL.js";import{S as Fr}from"./BcuA_kYM.js";import{C as zn}from"./79Rinja3.js";import{I as Jr}from"./D5u-7KnL.js";import{M as Un}from"./cyg7nPOp.js";import{S as Qt}from"./B8jKL4d6.js";import{B as Yt}from"./D27omodB.js";import{C as Gr}from"./DI-gbz9w.js";import{X as Kr}from"./DMy3xy05.js";import{E as Zr}from"./ChutD0tV.js";import"./CF4_YkFU.js";import{m as Ht}from"./5uy4Zm2q.js";import{c as kl}from"./ClErufDF.js";import{F as Xt}from"./DLXIUI1u.js";import{L as Qr}from"./B2Ko6bA5.js";import{f as Ot}from"./ZLcEirMF.js";import{F as Yr}from"./CU2r43ac.js";function Xr(n){return new Worker(""+new URL("../workers/kokoro.worker-Cev3ZHQt.js",import.meta.url).href,{type:"module",name:n==null?void 0:n.name})}class $r{constructor(e="fp32"){pt(this,"worker",null);pt(this,"initialized",!1);pt(this,"dtype");pt(this,"requestQueue",[]);pt(this,"processing",!1);this.dtype=e}async init(){if(this.worker){console.warn("KokoroWorker is already initialized.");return}return this.worker=new Xr,this.worker.onmessage=e=>{const{status:t,error:l,audioUrl:s}=e.data;if(t==="init:complete")this.initialized=!0;else if(t==="init:error")console.error(l),this.initialized=!1;else if(t==="generate:complete"){const r=this.requestQueue.shift();r&&(r.resolve(s),this.processNextRequest())}else if(t==="generate:error"){const r=this.requestQueue.shift();r&&(r.reject(new Error(l)),this.processNextRequest())}},new Promise((e,t)=>{this.worker.postMessage({type:"init",payload:{dtype:this.dtype}});const l=s=>{s.data.status==="init:complete"?(this.worker.removeEventListener("message",l),this.initialized=!0,e()):s.data.status==="init:error"&&(this.worker.removeEventListener("message",l),t(new Error(s.data.error)))};this.worker.addEventListener("message",l)})}async generate({text:e,voice:t}){if(!this.initialized||!this.worker)throw new Error("KokoroTTS Worker is not initialized yet.");return new Promise((l,s)=>{this.requestQueue.push({text:e,voice:t,resolve:l,reject:s}),this.processing||this.processNextRequest()})}processNextRequest(){if(this.requestQueue.length===0){this.processing=!1;return}this.processing=!0;const{text:e,voice:t}=this.requestQueue[0];this.worker.postMessage({type:"generate",payload:{text:e,voice:t}})}terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.initialized=!1,this.requestQueue=[],this.processing=!1)}}function xr(n){let e,t,l,s,r,i,a,o,f,u,d,g,c,_,v,M,E,C,R,L,O,k,N,S,B,T;return{c(){e=y("div"),t=y("div"),l=y("div"),s=y("div"),i=H(),a=y("div"),o=y("div"),u=H(),d=y("div"),c=H(),_=y("div"),v=y("div"),E=H(),C=y("div"),L=H(),O=y("div"),N=H(),S=y("div"),this.h()},l(P){e=I(P,"DIV",{class:!0});var Q=w(e);t=I(Q,"DIV",{class:!0});var F=w(t);l=I(F,"DIV",{class:!0});var re=w(l);s=I(re,"DIV",{class:!0}),w(s).forEach(m),i=j(re),a=I(re,"DIV",{class:!0});var Y=w(a);o=I(Y,"DIV",{class:!0}),w(o).forEach(m),u=j(Y),d=I(Y,"DIV",{class:!0}),w(d).forEach(m),Y.forEach(m),c=j(re),_=I(re,"DIV",{class:!0});var oe=w(_);v=I(oe,"DIV",{class:!0}),w(v).forEach(m),E=j(oe),C=I(oe,"DIV",{class:!0}),w(C).forEach(m),L=j(oe),O=I(oe,"DIV",{class:!0}),w(O).forEach(m),oe.forEach(m),N=j(re),S=I(re,"DIV",{class:!0}),w(S).forEach(m),re.forEach(m),F.forEach(m),Q.forEach(m),this.h()},h(){h(s,"class",r=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm mr-14"),h(o,"class",f=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2"),h(d,"class",g=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1"),h(a,"class","grid grid-cols-3 gap-4"),h(v,"class",M=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1"),h(C,"class",R=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2"),h(O,"class",k=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4"),h(_,"class","grid grid-cols-4 gap-4"),h(S,"class",B=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm"),h(l,"class",T=(n[0]==="md"?"space-y-2":"space-y-1.5")+" w-full"),h(t,"class","animate-pulse flex w-full"),h(e,"class","w-full mt-2 mb-2")},m(P,Q){V(P,e,Q),p(e,t),p(t,l),p(l,s),p(l,i),p(l,a),p(a,o),p(a,u),p(a,d),p(l,c),p(l,_),p(_,v),p(_,E),p(_,C),p(_,L),p(_,O),p(l,N),p(l,S)},p(P,[Q]){Q&1&&r!==(r=(P[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm mr-14")&&h(s,"class",r),Q&1&&f!==(f=(P[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2")&&h(o,"class",f),Q&1&&g!==(g=(P[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1")&&h(d,"class",g),Q&1&&M!==(M=(P[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1")&&h(v,"class",M),Q&1&&R!==(R=(P[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2")&&h(C,"class",R),Q&1&&k!==(k=(P[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4")&&h(O,"class",k),Q&1&&B!==(B=(P[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm")&&h(S,"class",B),Q&1&&T!==(T=(P[0]==="md"?"space-y-2":"space-y-1.5")+" w-full")&&h(l,"class",T)},i:Me,o:Me,d(P){P&&m(e)}}}function ei(n,e,t){let{size:l="md"}=e;return n.$$set=s=>{"size"in s&&t(0,l=s.size)},[l]}class $t extends Le{constructor(e){super(),Pe(this,e,ei,xr,Be,{size:0})}}function wl(n,e,t){const l=n.slice();return l[23]=e[t],l}function yl(n,e,t){const l=n.slice();return l[26]=e[t],l}function Il(n){var s;let e,t=n[8].t('This response was generated by "{{model}}"',{model:n[7]?((s=n[7])==null?void 0:s.name)??n[7].id:n[1].selectedModelId})+"",l;return{c(){e=y("div"),l=W(t),this.h()},l(r){e=I(r,"DIV",{class:!0});var i=w(e);l=q(i,t),i.forEach(m),this.h()},h(){h(e,"class","text-xs font-medium pt-1.5 -mb-0.5")},m(r,i){V(r,e,i),p(e,l)},p(r,i){var a;i&386&&t!==(t=r[8].t('This response was generated by "{{model}}"',{model:r[7]?((a=r[7])==null?void 0:a.name)??r[7].id:r[1].selectedModelId})+"")&&K(l,t)},d(r){r&&m(e)}}}function Ml(n){let e,t=n[26]+"",l,s,r,i,a,o;function f(){return n[12](n[26])}return{c(){e=y("button"),l=W(t),s=H(),this.h()},l(u){e=I(u,"BUTTON",{class:!0});var d=w(e);l=q(d,t),s=j(d),d.forEach(m),this.h()},h(){var u,d;h(e,"class",r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900"),e.disabled=i=((d=(u=n[1])==null?void 0:u.annotation)==null?void 0:d.rating)===-1?n[26]>5:n[26]<6},m(u,d){V(u,e,d),p(e,l),p(e,s),a||(o=de(e,"click",f),a=!0)},p(u,d){var g,c;n=u,d&64&&r!==(r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900")&&h(e,"class",r),d&2&&i!==(i=((c=(g=n[1])==null?void 0:g.annotation)==null?void 0:c.rating)===-1?n[26]>5:n[26]<6)&&(e.disabled=i)},d(u){u&&m(e),a=!1,o()}}}function El(n){let e,t=n[8].t("Why?")+"",l,s,r,i=De(n[3]),a=[];for(let o=0;o<i.length;o+=1)a[o]=Dl(wl(n,i,o));return{c(){e=y("div"),l=W(t),s=H(),r=y("div");for(let o=0;o<a.length;o+=1)a[o].c();this.h()},l(o){e=I(o,"DIV",{class:!0});var f=w(e);l=q(f,t),f.forEach(m),s=j(o),r=I(o,"DIV",{class:!0});var u=w(r);for(let d=0;d<a.length;d+=1)a[d].l(u);u.forEach(m),this.h()},h(){h(e,"class","text-sm mt-1.5 font-medium"),h(r,"class","flex flex-wrap gap-1.5 text-sm mt-1.5")},m(o,f){V(o,e,f),p(e,l),V(o,s,f),V(o,r,f);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(r,null)},p(o,f){if(f&256&&t!==(t=o[8].t("Why?")+"")&&K(l,t),f&280){i=De(o[3]);let u;for(u=0;u<i.length;u+=1){const d=wl(o,i,u);a[u]?a[u].p(d,f):(a[u]=Dl(d),a[u].c(),a[u].m(r,null))}for(;u<a.length;u+=1)a[u].d(1);a.length=i.length}},d(o){o&&(m(e),m(s),m(r)),Ge(a,o)}}}function ti(n){let e=n[23]+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&8&&e!==(e=l[23]+"")&&K(t,e)},d(l){l&&m(t)}}}function li(n){let e=n[8].t("Other")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Other")+"")&&K(t,e)},d(l){l&&m(t)}}}function si(n){let e=n[8].t("Being lazy")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Being lazy")+"")&&K(t,e)},d(l){l&&m(t)}}}function ni(n){let e=n[8].t("Refused when it shouldn't have")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Refused when it shouldn't have")+"")&&K(t,e)},d(l){l&&m(t)}}}function ri(n){let e=n[8].t("Didn't fully follow instructions")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Didn't fully follow instructions")+"")&&K(t,e)},d(l){l&&m(t)}}}function ii(n){let e=n[8].t("Not factually correct")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not factually correct")+"")&&K(t,e)},d(l){l&&m(t)}}}function oi(n){let e=n[8].t("Not helpful")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not helpful")+"")&&K(t,e)},d(l){l&&m(t)}}}function ai(n){let e=n[8].t("Too verbose")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Too verbose")+"")&&K(t,e)},d(l){l&&m(t)}}}function fi(n){let e=n[8].t("Don't like the style")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Don't like the style")+"")&&K(t,e)},d(l){l&&m(t)}}}function ui(n){let e=n[8].t("Thorough explanation")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Thorough explanation")+"")&&K(t,e)},d(l){l&&m(t)}}}function ci(n){let e=n[8].t("Attention to detail")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Attention to detail")+"")&&K(t,e)},d(l){l&&m(t)}}}function di(n){let e=n[8].t("Positive attitude")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Positive attitude")+"")&&K(t,e)},d(l){l&&m(t)}}}function hi(n){let e=n[8].t("Showcased creativity")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Showcased creativity")+"")&&K(t,e)},d(l){l&&m(t)}}}function mi(n){let e=n[8].t("Followed instructions perfectly")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Followed instructions perfectly")+"")&&K(t,e)},d(l){l&&m(t)}}}function gi(n){let e=n[8].t("Accurate information")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Accurate information")+"")&&K(t,e)},d(l){l&&m(t)}}}function Dl(n){let e,t,l,s,r;function i(u,d){return u[23]==="accurate_information"?gi:u[23]==="followed_instructions_perfectly"?mi:u[23]==="showcased_creativity"?hi:u[23]==="positive_attitude"?di:u[23]==="attention_to_detail"?ci:u[23]==="thorough_explanation"?ui:u[23]==="dont_like_the_style"?fi:u[23]==="too_verbose"?ai:u[23]==="not_helpful"?oi:u[23]==="not_factually_correct"?ii:u[23]==="didnt_fully_follow_instructions"?ri:u[23]==="refused_when_it_shouldnt_have"?ni:u[23]==="being_lazy"?si:u[23]==="other"?li:ti}let a=i(n),o=a(n);function f(){return n[13](n[23])}return{c(){e=y("button"),o.c(),t=H(),this.h()},l(u){e=I(u,"BUTTON",{class:!0});var d=w(e);o.l(d),t=j(d),d.forEach(m),this.h()},h(){h(e,"class",l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")},m(u,d){V(u,e,d),o.m(e,null),p(e,t),s||(r=de(e,"click",f),s=!0)},p(u,d){n=u,a===(a=i(n))&&o?o.p(n,d):(o.d(1),o=a(n),o&&(o.c(),o.m(e,t))),d&24&&l!==(l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")&&h(e,"class",l)},d(u){u&&m(e),o.d(),s=!1,r()}}}function _i(n){var $;let e,t,l,s,r=n[8].t("How would you rate this response?")+"",i,a,o,f='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path></svg>',u,d,g,c,_,v,M,E,C=n[8].t("Awful")+"",R,L,O,k,N=n[8].t("Amazing")+"",S,B,T,P,Q,F,re,Y,oe,he,ue,ke,U,Z=n[8].t("Save")+"",ge,pe,_e,J,me,ae=(($=n[1])==null?void 0:$.arena)&&Il(n),be=De(Array.from({length:10}).map(Nl)),A=[];for(let X=0;X<be.length;X+=1)A[X]=Ml(yl(n,be,X));let G=n[3].length>0&&El(n);return ue=new jr({props:{tags:n[2]}}),ue.$on("delete",n[15]),ue.$on("add",n[16]),{c(){ae&&ae.c(),e=H(),t=y("div"),l=y("div"),s=y("div"),i=W(r),a=H(),o=y("button"),o.innerHTML=f,u=H(),d=y("div"),g=y("div"),c=y("div");for(let X=0;X<A.length;X+=1)A[X].c();_=H(),v=y("div"),M=y("div"),E=W("1 - "),R=W(C),L=H(),O=y("div"),k=W("10 - "),S=W(N),B=H(),T=y("div"),G&&G.c(),P=H(),Q=y("div"),F=y("textarea"),Y=H(),oe=y("div"),he=y("div"),x(ue.$$.fragment),ke=H(),U=y("button"),ge=W(Z),this.h()},l(X){ae&&ae.l(X),e=j(X),t=I(X,"DIV",{class:!0,id:!0});var ce=w(t);l=I(ce,"DIV",{class:!0});var ve=w(l);s=I(ve,"DIV",{class:!0});var Te=w(s);i=q(Te,r),Te.forEach(m),a=j(ve),o=I(ve,"BUTTON",{"data-svelte-h":!0}),Ue(o)!=="svelte-1ew22ui"&&(o.innerHTML=f),ve.forEach(m),u=j(ce),d=I(ce,"DIV",{class:!0});var Ne=w(d);g=I(Ne,"DIV",{class:!0});var Ae=w(g);c=I(Ae,"DIV",{class:!0});var ze=w(c);for(let rt=0;rt<A.length;rt+=1)A[rt].l(ze);ze.forEach(m),_=j(Ae),v=I(Ae,"DIV",{class:!0});var We=w(v);M=I(We,"DIV",{});var ie=w(M);E=q(ie,"1 - "),R=q(ie,C),ie.forEach(m),L=j(We),O=I(We,"DIV",{});var Fe=w(O);k=q(Fe,"10 - "),S=q(Fe,N),Fe.forEach(m),We.forEach(m),Ae.forEach(m),Ne.forEach(m),B=j(ce),T=I(ce,"DIV",{});var tt=w(T);G&&G.l(tt),tt.forEach(m),P=j(ce),Q=I(ce,"DIV",{class:!0});var qe=w(Q);F=I(qe,"TEXTAREA",{class:!0,placeholder:!0,rows:!0}),w(F).forEach(m),qe.forEach(m),Y=j(ce),oe=I(ce,"DIV",{class:!0});var Ze=w(oe);he=I(Ze,"DIV",{class:!0});var ft=w(he);ee(ue.$$.fragment,ft),ft.forEach(m),ke=j(Ze),U=I(Ze,"BUTTON",{class:!0});var ut=w(U);ge=q(ut,Z),ut.forEach(m),Ze.forEach(m),ce.forEach(m),this.h()},h(){h(s,"class","text-sm font-medium"),h(l,"class","flex justify-between items-center"),h(c,"class","mt-1.5 w-fit flex gap-1 pb-5"),h(v,"class","absolute bottom-0 left-0 right-0 flex justify-between text-xs"),h(g,"class","relative w-fit"),h(d,"class","w-full flex justify-center"),h(F,"class","w-full text-sm px-1 py-2 bg-transparent outline-hidden resize-none rounded-xl"),h(F,"placeholder",re=n[8].t("Feel free to add specific details")),h(F,"rows","3"),h(Q,"class","mt-2"),h(he,"class","flex items-end group"),h(U,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),h(oe,"class","mt-2 gap-1.5 flex justify-between"),h(t,"class","my-2.5 rounded-xl px-4 py-3 border border-gray-100 dark:border-gray-850"),h(t,"id",pe="message-feedback-"+n[1].id)},m(X,ce){ae&&ae.m(X,ce),V(X,e,ce),V(X,t,ce),p(t,l),p(l,s),p(s,i),p(l,a),p(l,o),p(t,u),p(t,d),p(d,g),p(g,c);for(let ve=0;ve<A.length;ve+=1)A[ve]&&A[ve].m(c,null);p(g,_),p(g,v),p(v,M),p(M,E),p(M,R),p(v,L),p(v,O),p(O,k),p(O,S),p(t,B),p(t,T),G&&G.m(T,null),p(t,P),p(t,Q),p(Q,F),ot(F,n[5]),p(t,Y),p(t,oe),p(oe,he),te(ue,he,null),p(oe,ke),p(oe,U),p(U,ge),_e=!0,J||(me=[de(o,"click",n[11]),de(F,"input",n[14]),de(U,"click",n[17])],J=!0)},p(X,[ce]){var Te;if((Te=X[1])!=null&&Te.arena?ae?ae.p(X,ce):(ae=Il(X),ae.c(),ae.m(e.parentNode,e)):ae&&(ae.d(1),ae=null),(!_e||ce&256)&&r!==(r=X[8].t("How would you rate this response?")+"")&&K(i,r),ce&66){be=De(Array.from({length:10}).map(Nl));let Ne;for(Ne=0;Ne<be.length;Ne+=1){const Ae=yl(X,be,Ne);A[Ne]?A[Ne].p(Ae,ce):(A[Ne]=Ml(Ae),A[Ne].c(),A[Ne].m(c,null))}for(;Ne<A.length;Ne+=1)A[Ne].d(1);A.length=be.length}(!_e||ce&256)&&C!==(C=X[8].t("Awful")+"")&&K(R,C),(!_e||ce&256)&&N!==(N=X[8].t("Amazing")+"")&&K(S,N),X[3].length>0?G?G.p(X,ce):(G=El(X),G.c(),G.m(T,null)):G&&(G.d(1),G=null),(!_e||ce&256&&re!==(re=X[8].t("Feel free to add specific details")))&&h(F,"placeholder",re),ce&32&&ot(F,X[5]);const ve={};ce&4&&(ve.tags=X[2]),ue.$set(ve),(!_e||ce&256)&&Z!==(Z=X[8].t("Save")+"")&&K(ge,Z),(!_e||ce&2&&pe!==(pe="message-feedback-"+X[1].id))&&h(t,"id",pe)},i(X){_e||(b(ue.$$.fragment,X),_e=!0)},o(X){D(ue.$$.fragment,X),_e=!1},d(X){X&&(m(e),m(t)),ae&&ae.d(X),Ge(A,X),G&&G.d(),le(ue),J=!1,$e(me)}}}const Nl=(n,e)=>e+1;function pi(n,e,t){let l,s;Ee(n,jt,T=>t(18,s=T));const r=Ke("i18n");Ee(n,r,T=>t(8,l=T));const i=vt();let{message:a}=e,{show:o=!1}=e,f=["accurate_information","followed_instructions_perfectly","showcased_creativity","positive_attitude","attention_to_detail","thorough_explanation","other"],u=["dont_like_the_style","too_verbose","not_helpful","not_factually_correct","didnt_fully_follow_instructions","refused_when_it_shouldnt_have","being_lazy","other"],d=[],g=[],c=null,_="",v=null,M=null;const E=()=>{var T,P,Q,F,re;c||t(4,c=((T=a==null?void 0:a.annotation)==null?void 0:T.reason)??""),_||t(5,_=((P=a==null?void 0:a.annotation)==null?void 0:P.comment)??""),t(2,d=(((Q=a==null?void 0:a.annotation)==null?void 0:Q.tags)??[]).map(Y=>({name:Y}))),v||t(6,v=((re=(F=a==null?void 0:a.annotation)==null?void 0:F.details)==null?void 0:re.rating)??null)};kt(()=>{a!=null&&a.arena&&(t(7,M=s.find(T=>T.id===a.selectedModelId)),He.success(l.t('This response was generated by "{{model}}"',{model:M?(M==null?void 0:M.name)??M.id:a.selectedModelId})))});const C=()=>{console.log("saveHandler"),i("save",{reason:c,comment:_,tags:d.map(T=>T.name),details:{rating:v}}),He.success(l.t("Thanks for your feedback!")),t(0,o=!1)},R=()=>{t(0,o=!1)},L=T=>{t(6,v=T)},O=T=>{t(4,c=T)};function k(){_=this.value,t(5,_)}const N=T=>{t(2,d=d.filter(P=>P.name.replaceAll(" ","_").toLowerCase()!==T.detail.replaceAll(" ","_").toLowerCase()))},S=T=>{t(2,d=[...d,{name:T.detail}])},B=()=>{C()};return n.$$set=T=>{"message"in T&&t(1,a=T.message),"show"in T&&t(0,o=T.show)},n.$$.update=()=>{var T,P;n.$$.dirty&2&&(((T=a==null?void 0:a.annotation)==null?void 0:T.rating)===1?t(3,g=f):((P=a==null?void 0:a.annotation)==null?void 0:P.rating)===-1&&t(3,g=u)),n.$$.dirty&2&&a&&E()},[o,a,d,g,c,_,v,M,l,r,C,R,L,O,k,N,S,B]}class bi extends Le{constructor(e){super(),Pe(this,e,pi,_i,Be,{message:1,show:0})}}function Vl(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function vi(n){let e,t;return e=new An({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ki(n){let e,t;return e=new Hn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function wi(n){let e,t,l,s,r;const i=n[2].default,a=gr(i,n,n[4],null),o=[ki,vi],f=[];function u(d,g){return d[1]?0:1}return l=u(n),s=f[l]=o[l](n),{c(){e=y("div"),a&&a.c(),t=H(),s.c(),this.h()},l(d){e=I(d,"DIV",{class:!0});var g=w(e);a&&a.l(g),t=j(g),s.l(g),g.forEach(m),this.h()},h(){h(e,"class","flex items-center gap-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition")},m(d,g){V(d,e,g),a&&a.m(e,null),p(e,t),f[l].m(e,null),r=!0},p(d,g){a&&a.p&&(!r||g&16)&&_r(a,i,d,d[4],r?br(i,d[4],g,null):pr(d[4]),null);let c=l;l=u(d),l!==c&&(se(),D(f[c],1,1,()=>{f[c]=null}),ne(),s=f[l],s||(s=f[l]=o[l](d),s.c()),b(s,1),s.m(e,null))},i(d){r||(b(a,d),b(s),r=!0)},o(d){D(a,d),D(s),r=!1},d(d){d&&m(e),a&&a.d(d),f[l].d()}}}function Cl(n){let e,t,l,s,r,i=n[0].query+"",a,o,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',d,g;return l=new zr({}),{c(){e=y("a"),t=y("div"),x(l.$$.fragment),s=H(),r=y("div"),a=W(i),o=H(),f=y("div"),f.innerHTML=u,this.h()},l(c){e=I(c,"A",{href:!0,target:!0,class:!0});var _=w(e);t=I(_,"DIV",{class:!0});var v=w(t);ee(l.$$.fragment,v),s=j(v),r=I(v,"DIV",{class:!0});var M=w(r);a=q(M,i),M.forEach(m),v.forEach(m),o=j(_),f=I(_,"DIV",{class:!0,"data-svelte-h":!0}),Ue(f)!=="svelte-14xjows"&&(f.innerHTML=u),_.forEach(m),this.h()},h(){h(r,"class","line-clamp-1"),h(t,"class","flex gap-2 items-center"),h(f,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),h(e,"href",d="https://www.google.com/search?q="+n[0].query),h(e,"target","_blank"),h(e,"class","flex w-full items-center p-3 px-4 border-b border-gray-300/30 dark:border-gray-700/50 group/item justify-between font-normal text-gray-800 dark:text-gray-300 no-underline")},m(c,_){V(c,e,_),p(e,t),te(l,t,null),p(t,s),p(t,r),p(r,a),p(e,o),p(e,f),g=!0},p(c,_){(!g||_&1)&&i!==(i=c[0].query+"")&&K(a,i),(!g||_&1&&d!==(d="https://www.google.com/search?q="+c[0].query))&&h(e,"href",d)},i(c){g||(b(l.$$.fragment,c),g=!0)},o(c){D(l.$$.fragment,c),g=!1},d(c){c&&m(e),le(l)}}}function Tl(n){let e,t,l=n[5]+"",s,r,i,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',o,f,u;return{c(){e=y("a"),t=y("div"),s=W(l),r=H(),i=y("div"),i.innerHTML=a,o=H(),this.h()},l(d){e=I(d,"A",{href:!0,target:!0,class:!0});var g=w(e);t=I(g,"DIV",{class:!0});var c=w(t);s=q(c,l),c.forEach(m),r=j(g),i=I(g,"DIV",{class:!0,"data-svelte-h":!0}),Ue(i)!=="svelte-14xjows"&&(i.innerHTML=a),o=j(g),g.forEach(m),this.h()},h(){h(t,"class","line-clamp-1"),h(i,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),h(e,"href",f=n[5]),h(e,"target","_blank"),h(e,"class",u="flex w-full items-center p-3 px-4 "+(n[7]===n[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")},m(d,g){V(d,e,g),p(e,t),p(t,s),p(e,r),p(e,i),p(e,o)},p(d,g){g&1&&l!==(l=d[5]+"")&&K(s,l),g&1&&f!==(f=d[5])&&h(e,"href",f),g&1&&u!==(u="flex w-full items-center p-3 px-4 "+(d[7]===d[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")&&h(e,"class",u)},d(d){d&&m(e)}}}function yi(n){var a;let e,t,l,s=((a=n[0])==null?void 0:a.query)&&Cl(n),r=De(n[0].urls),i=[];for(let o=0;o<r.length;o+=1)i[o]=Tl(Vl(n,r,o));return{c(){e=y("div"),s&&s.c(),t=H();for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=I(o,"DIV",{class:!0,slot:!0});var f=w(e);s&&s.l(f),t=j(f);for(let u=0;u<i.length;u+=1)i[u].l(f);f.forEach(m),this.h()},h(){h(e,"class","text-sm border border-gray-300/30 dark:border-gray-700/50 rounded-xl mb-1.5"),h(e,"slot","content")},m(o,f){V(o,e,f),s&&s.m(e,null),p(e,t);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);l=!0},p(o,f){var u;if((u=o[0])!=null&&u.query?s?(s.p(o,f),f&1&&b(s,1)):(s=Cl(o),s.c(),b(s,1),s.m(e,t)):s&&(se(),D(s,1,1,()=>{s=null}),ne()),f&1){r=De(o[0].urls);let d;for(d=0;d<r.length;d+=1){const g=Vl(o,r,d);i[d]?i[d].p(g,f):(i[d]=Tl(g),i[d].c(),i[d].m(e,null))}for(;d<i.length;d+=1)i[d].d(1);i.length=r.length}},i(o){l||(b(s),l=!0)},o(o){D(s),l=!1},d(o){o&&m(e),s&&s.d(),Ge(i,o)}}}function Ii(n){let e,t,l;function s(i){n[3](i)}let r={className:"w-full space-y-1",$$slots:{content:[yi],default:[wi]},$$scope:{ctx:n}};return n[1]!==void 0&&(r.open=n[1]),e=new jn({props:r}),je.push(()=>Xe(e,"open",s)),{c(){x(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,a){te(e,i,a),l=!0},p(i,[a]){const o={};a&19&&(o.$$scope={dirty:a,ctx:i}),!t&&a&2&&(t=!0,o.open=i[1],Ye(()=>t=!1)),e.$set(o)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){le(e,i)}}}function Mi(n,e,t){let{$$slots:l={},$$scope:s}=e,{status:r={urls:[],query:""}}=e,i=!1;function a(o){i=o,t(1,i)}return n.$$set=o=>{"status"in o&&t(0,r=o.status),"$$scope"in o&&t(4,s=o.$$scope)},[r,i,l,a,s]}class Ei extends Le{constructor(e){super(),Pe(this,e,Mi,Ii,Be,{status:0})}}function Di(n){let e,t,l,s,r,i=(typeof n[0]=="string"?n[0]:JSON.stringify(n[0]))+"",a,o;return l=new Jr({props:{className:"size-5 text-red-700 dark:text-red-400"}}),{c(){e=y("div"),t=y("div"),x(l.$$.fragment),s=H(),r=y("div"),a=W(i),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=w(e);t=I(u,"DIV",{class:!0});var d=w(t);ee(l.$$.fragment,d),d.forEach(m),s=j(u),r=I(u,"DIV",{class:!0});var g=w(r);a=q(g,i),g.forEach(m),u.forEach(m),this.h()},h(){h(t,"class","self-start mt-0.5"),h(r,"class","self-center text-sm"),h(e,"class","flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg")},m(f,u){V(f,e,u),p(e,t),te(l,t,null),p(e,s),p(e,r),p(r,a),o=!0},p(f,[u]){(!o||u&1)&&i!==(i=(typeof f[0]=="string"?f[0]:JSON.stringify(f[0]))+"")&&K(a,i)},i(f){o||(b(l.$$.fragment,f),o=!0)},o(f){D(l.$$.fragment,f),o=!1},d(f){f&&m(e),le(l)}}}function Ni(n,e,t){let{content:l=""}=e;return n.$$set=s=>{"content"in s&&t(0,l=s.content)},[l]}let Vi=class extends Le{constructor(e){super(),Pe(this,e,Ni,Di,Be,{content:0})}};function Bl(n,e,t){const l=n.slice();return l[10]=e[t],l[12]=t,l}function Ci(n){const e=n.slice(),t=Ui(e[10].distance);return e[13]=t,e}function Ti(n){let e,t=n[4].t("No source available")+"",l;return{c(){e=y("div"),l=W(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var r=w(e);l=q(r,t),r.forEach(m),this.h()},h(){h(e,"class","text-sm dark:text-gray-400")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No source available")+"")&&K(l,t)},i:Me,o:Me,d(s){s&&m(e)}}}function Bi(n){let e,t,l,s;e=new Oe({props:{className:"w-fit",content:n[4].t("Open file"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Si]},$$scope:{ctx:n}}});let r=n[2]&&Ol(n);return{c(){x(e.$$.fragment),t=H(),r&&r.c(),l=fe()},l(i){ee(e.$$.fragment,i),t=j(i),r&&r.l(i),l=fe()},m(i,a){te(e,i,a),V(i,t,a),r&&r.m(i,a),V(i,l,a),s=!0},p(i,a){const o={};a&16&&(o.content=i[4].t("Open file")),a&16408&&(o.$$scope={dirty:a,ctx:i}),e.$set(o),i[2]?r?(r.p(i,a),a&4&&b(r,1)):(r=Ol(i),r.c(),b(r,1),r.m(l.parentNode,l)):r&&(se(),D(r,1,1,()=>{r=null}),ne())},i(i){s||(b(e.$$.fragment,i),b(r),s=!0)},o(i){D(e.$$.fragment,i),D(r),s=!1},d(i){i&&(m(t),m(l)),le(e,i),r&&r.d(i)}}}function Sl(n){let e,t,l=n[4].t("page")+"",s,r,i=n[10].metadata.page+1+"",a,o;return{c(){e=y("span"),t=W("("),s=W(l),r=H(),a=W(i),o=W(")"),this.h()},l(f){e=I(f,"SPAN",{class:!0});var u=w(e);t=q(u,"("),s=q(u,l),r=j(u),a=q(u,i),o=q(u,")"),u.forEach(m),this.h()},h(){h(e,"class","text-xs text-gray-500 dark:text-gray-400")},m(f,u){V(f,e,u),p(e,t),p(e,s),p(e,r),p(e,a),p(e,o)},p(f,u){u&16&&l!==(l=f[4].t("page")+"")&&K(s,l),u&8&&i!==(i=f[10].metadata.page+1+"")&&K(a,i)},d(f){f&&m(e)}}}function Si(n){var o,f,u,d;let e,t,l=n[6](((f=(o=n[10])==null?void 0:o.metadata)==null?void 0:f.name)??n[10].source.name)+"",s,r,i,a=((d=(u=n[10])==null?void 0:u.metadata)==null?void 0:d.page)&&Sl(n);return{c(){e=y("div"),t=y("a"),s=W(l),i=H(),a&&a.c(),this.h()},l(g){e=I(g,"DIV",{class:!0});var c=w(e);t=I(c,"A",{class:!0,href:!0,target:!0});var _=w(t);s=q(_,l),_.forEach(m),i=j(c),a&&a.l(c),c.forEach(m),this.h()},h(){var g,c,_,v,M,E,C,R;h(t,"class","hover:text-gray-500 dark:hover:text-gray-100 underline grow"),h(t,"href",r=(c=(g=n[10])==null?void 0:g.metadata)!=null&&c.file_id?`${dl}/files/${(v=(_=n[10])==null?void 0:_.metadata)==null?void 0:v.file_id}/content${((E=(M=n[10])==null?void 0:M.metadata)==null?void 0:E.page)!==void 0?`#page=${n[10].metadata.page+1}`:""}`:(R=(C=n[10].source)==null?void 0:C.url)!=null&&R.includes("http")?n[10].source.url:"#"),h(t,"target","_blank"),h(e,"class","text-sm dark:text-gray-400 flex items-center gap-2 w-fit")},m(g,c){V(g,e,c),p(e,t),p(t,s),p(e,i),a&&a.m(e,null)},p(g,c){var _,v,M,E,C,R,L,O,k,N,S,B;c&8&&l!==(l=g[6](((v=(_=g[10])==null?void 0:_.metadata)==null?void 0:v.name)??g[10].source.name)+"")&&K(s,l),c&8&&r!==(r=(E=(M=g[10])==null?void 0:M.metadata)!=null&&E.file_id?`${dl}/files/${(R=(C=g[10])==null?void 0:C.metadata)==null?void 0:R.file_id}/content${((O=(L=g[10])==null?void 0:L.metadata)==null?void 0:O.page)!==void 0?`#page=${g[10].metadata.page+1}`:""}`:(N=(k=g[10].source)==null?void 0:k.url)!=null&&N.includes("http")?g[10].source.url:"#")&&h(t,"href",r),(B=(S=g[10])==null?void 0:S.metadata)!=null&&B.page?a?a.p(g,c):(a=Sl(g),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},d(g){g&&m(e),a&&a.d()}}}function Ol(n){let e,t=n[4].t("Relevance")+"",l,s,r,i,a,o;const f=[Ri,Oi],u=[];function d(g,c){return g[10].distance!==void 0?0:1}return r=d(n),i=u[r]=f[r](n),{c(){e=y("div"),l=W(t),s=H(),i.c(),a=fe(),this.h()},l(g){e=I(g,"DIV",{class:!0});var c=w(e);l=q(c,t),c.forEach(m),s=j(g),i.l(g),a=fe(),this.h()},h(){h(e,"class","text-sm font-medium dark:text-gray-300 mt-2")},m(g,c){V(g,e,c),p(e,l),V(g,s,c),u[r].m(g,c),V(g,a,c),o=!0},p(g,c){(!o||c&16)&&t!==(t=g[4].t("Relevance")+"")&&K(l,t);let _=r;r=d(g),r===_?u[r].p(g,c):(se(),D(u[_],1,1,()=>{u[_]=null}),ne(),i=u[r],i?i.p(g,c):(i=u[r]=f[r](g),i.c()),b(i,1),i.m(a.parentNode,a))},i(g){o||(b(i),o=!0)},o(g){D(i),o=!1},d(g){g&&(m(e),m(s),m(a)),u[r].d(g)}}}function Oi(n){let e,t=n[4].t("No distance available")+"",l;return{c(){e=y("div"),l=W(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var r=w(e);l=q(r,t),r.forEach(m),this.h()},h(){h(e,"class","text-sm dark:text-gray-400")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No distance available")+"")&&K(l,t)},i:Me,o:Me,d(s){s&&m(e)}}}function Ri(n){let e,t;return e=new Oe({props:{className:"w-fit",content:n[4].t("Semantic distance to query"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Pi]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s&16&&(r.content=l[4].t("Semantic distance to query")),s&16394&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Li(n){var i;let e,t,l=(((i=n[10])==null?void 0:i.distance)??0).toFixed(4)+"",s,r;return{c(){e=y("span"),t=W("("),s=W(l),r=W(")"),this.h()},l(a){e=I(a,"SPAN",{class:!0});var o=w(e);t=q(o,"("),s=q(o,l),r=q(o,")"),o.forEach(m),this.h()},h(){h(e,"class","text-gray-500 dark:text-gray-500")},m(a,o){V(a,e,o),p(e,t),p(e,s),p(e,r)},p(a,o){var f;o&8&&l!==(l=(((f=a[10])==null?void 0:f.distance)??0).toFixed(4)+"")&&K(s,l)},d(a){a&&m(e)}}}function Rl(n){var r;let e,t,l=typeof n[13]=="number"&&Ll(n),s=typeof((r=n[10])==null?void 0:r.distance)=="number"&&Pl(n);return{c(){l&&l.c(),e=H(),s&&s.c(),t=fe()},l(i){l&&l.l(i),e=j(i),s&&s.l(i),t=fe()},m(i,a){l&&l.m(i,a),V(i,e,a),s&&s.m(i,a),V(i,t,a)},p(i,a){var o;typeof i[13]=="number"?l?l.p(i,a):(l=Ll(i),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null),typeof((o=i[10])==null?void 0:o.distance)=="number"?s?s.p(i,a):(s=Pl(i),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null)},d(i){i&&(m(e),m(t)),l&&l.d(i),s&&s.d(i)}}}function Ll(n){let e,t=n[13].toFixed(2)+"",l,s,r;return{c(){e=y("span"),l=W(t),s=W("%"),this.h()},l(i){e=I(i,"SPAN",{class:!0});var a=w(e);l=q(a,t),s=q(a,"%"),a.forEach(m),this.h()},h(){h(e,"class",r=`px-1 rounded-sm font-medium ${jl(n[13])}`)},m(i,a){V(i,e,a),p(e,l),p(e,s)},p(i,a){a&8&&t!==(t=i[13].toFixed(2)+"")&&K(l,t),a&8&&r!==(r=`px-1 rounded-sm font-medium ${jl(i[13])}`)&&h(e,"class",r)},d(i){i&&m(e)}}}function Pl(n){var i;let e,t,l=(((i=n[10])==null?void 0:i.distance)??0).toFixed(4)+"",s,r;return{c(){e=y("span"),t=W("("),s=W(l),r=W(")"),this.h()},l(a){e=I(a,"SPAN",{class:!0});var o=w(e);t=q(o,"("),s=q(o,l),r=q(o,")"),o.forEach(m),this.h()},h(){h(e,"class","text-gray-500 dark:text-gray-500")},m(a,o){V(a,e,o),p(e,t),p(e,s),p(e,r)},p(a,o){var f;o&8&&l!==(l=(((f=a[10])==null?void 0:f.distance)??0).toFixed(4)+"")&&K(s,l)},d(a){a&&m(e)}}}function Pi(n){let e;function t(i,a){var o;if(i[1])return Rl;if(typeof((o=i[10])==null?void 0:o.distance)=="number")return Li}function l(i,a){return a===Rl?Ci(i):i}let s=t(n),r=s&&s(l(n,s));return{c(){e=y("div"),r&&r.c(),this.h()},l(i){e=I(i,"DIV",{class:!0});var a=w(e);r&&r.l(a),a.forEach(m),this.h()},h(){h(e,"class","text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit")},m(i,a){V(i,e,a),r&&r.m(e,null)},p(i,a){s===(s=t(i))&&r?r.p(l(i,s),a):(r&&r.d(1),r=s&&s(l(i,s)),r&&(r.c(),r.m(e,null)))},d(i){i&&m(e),r&&r.d()}}}function Ai(n){let e,t,l=n[10].document+"",s,r;return{c(){e=y("pre"),t=W("                "),s=W(l),r=W(`
              `),this.h()},l(i){e=I(i,"PRE",{class:!0});var a=w(e);t=q(a,"                "),s=q(a,l),r=q(a,`
              `),a.forEach(m),this.h()},h(){h(e,"class","text-sm dark:text-gray-400 whitespace-pre-line")},m(i,a){V(i,e,a),p(e,t),p(e,s),p(e,r)},p(i,a){a&8&&l!==(l=i[10].document+"")&&K(s,l)},d(i){i&&m(e)}}}function Hi(n){let e,t,l;return{c(){e=y("iframe"),this.h()},l(s){e=I(s,"IFRAME",{class:!0,sandbox:!0,srcdoc:!0,title:!0}),w(e).forEach(m),this.h()},h(){h(e,"class","w-full border-0 h-auto rounded-none"),h(e,"sandbox","allow-scripts allow-forms allow-same-origin"),h(e,"srcdoc",t=n[10].document),h(e,"title",l=n[4].t("Content"))},m(s,r){V(s,e,r)},p(s,r){r&8&&t!==(t=s[10].document)&&h(e,"srcdoc",t),r&16&&l!==(l=s[4].t("Content"))&&h(e,"title",l)},d(s){s&&m(e)}}}function Al(n){let e;return{c(){e=y("hr"),this.h()},l(t){e=I(t,"HR",{class:!0}),this.h()},h(){h(e,"class","border-gray-100 dark:border-gray-850 my-3")},m(t,l){V(t,e,l)},d(t){t&&m(e)}}}function Hl(n){let e,t,l=n[4].t("Source")+"",s,r,i,a,o,f,u,d=n[4].t("Content")+"",g,c,_,v,M;const E=[Bi,Ti],C=[];function R(S,B){var T;return(T=S[10].source)!=null&&T.name?0:1}i=R(n),a=C[i]=E[i](n);function L(S,B){var T;return(T=S[10].metadata)!=null&&T.html?Hi:Ai}let O=L(n),k=O(n),N=n[12]!==n[3].length-1&&Al();return{c(){e=y("div"),t=y("div"),s=W(l),r=H(),a.c(),o=H(),f=y("div"),u=y("div"),g=W(d),c=H(),k.c(),_=H(),N&&N.c(),v=fe(),this.h()},l(S){e=I(S,"DIV",{class:!0});var B=w(e);t=I(B,"DIV",{class:!0});var T=w(t);s=q(T,l),T.forEach(m),r=j(B),a.l(B),B.forEach(m),o=j(S),f=I(S,"DIV",{class:!0});var P=w(f);u=I(P,"DIV",{class:!0});var Q=w(u);g=q(Q,d),Q.forEach(m),c=j(P),k.l(P),P.forEach(m),_=j(S),N&&N.l(S),v=fe(),this.h()},h(){h(t,"class","text-sm font-medium dark:text-gray-300"),h(e,"class","flex flex-col w-full"),h(u,"class","text-sm font-medium dark:text-gray-300 mt-2"),h(f,"class","flex flex-col w-full")},m(S,B){V(S,e,B),p(e,t),p(t,s),p(e,r),C[i].m(e,null),V(S,o,B),V(S,f,B),p(f,u),p(u,g),p(f,c),k.m(f,null),V(S,_,B),N&&N.m(S,B),V(S,v,B),M=!0},p(S,B){(!M||B&16)&&l!==(l=S[4].t("Source")+"")&&K(s,l);let T=i;i=R(S),i===T?C[i].p(S,B):(se(),D(C[T],1,1,()=>{C[T]=null}),ne(),a=C[i],a?a.p(S,B):(a=C[i]=E[i](S),a.c()),b(a,1),a.m(e,null)),(!M||B&16)&&d!==(d=S[4].t("Content")+"")&&K(g,d),O===(O=L(S))&&k?k.p(S,B):(k.d(1),k=O(S),k&&(k.c(),k.m(f,null))),S[12]!==S[3].length-1?N||(N=Al(),N.c(),N.m(v.parentNode,v)):N&&(N.d(1),N=null)},i(S){M||(b(a),M=!0)},o(S){D(a),M=!1},d(S){S&&(m(e),m(o),m(f),m(_),m(v)),C[i].d(),k.d(),N&&N.d(S)}}}function ji(n){let e,t,l,s=n[4].t("Citation")+"",r,i,a,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',f,u,d,g,c,_,v=De(n[3]),M=[];for(let C=0;C<v.length;C+=1)M[C]=Hl(Bl(n,v,C));const E=C=>D(M[C],1,1,()=>{M[C]=null});return{c(){e=y("div"),t=y("div"),l=y("div"),r=W(s),i=H(),a=y("button"),a.innerHTML=o,f=H(),u=y("div"),d=y("div");for(let C=0;C<M.length;C+=1)M[C].c();this.h()},l(C){e=I(C,"DIV",{});var R=w(e);t=I(R,"DIV",{class:!0});var L=w(t);l=I(L,"DIV",{class:!0});var O=w(l);r=q(O,s),O.forEach(m),i=j(L),a=I(L,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(a)!=="svelte-745w2y"&&(a.innerHTML=o),L.forEach(m),f=j(R),u=I(R,"DIV",{class:!0});var k=w(u);d=I(k,"DIV",{class:!0});var N=w(d);for(let S=0;S<M.length;S+=1)M[S].l(N);N.forEach(m),k.forEach(m),R.forEach(m),this.h()},h(){h(l,"class","text-lg font-medium self-center capitalize"),h(a,"class","self-center"),h(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),h(d,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),h(u,"class","flex flex-col md:flex-row w-full px-6 pb-5 md:space-x-4")},m(C,R){V(C,e,R),p(e,t),p(t,l),p(l,r),p(t,i),p(t,a),p(e,f),p(e,u),p(u,d);for(let L=0;L<M.length;L+=1)M[L]&&M[L].m(d,null);g=!0,c||(_=de(a,"click",n[8]),c=!0)},p(C,R){if((!g||R&16)&&s!==(s=C[4].t("Citation")+"")&&K(r,s),R&94){v=De(C[3]);let L;for(L=0;L<v.length;L+=1){const O=Bl(C,v,L);M[L]?(M[L].p(O,R),b(M[L],1)):(M[L]=Hl(O),M[L].c(),b(M[L],1),M[L].m(d,null))}for(se(),L=v.length;L<M.length;L+=1)E(L);ne()}},i(C){if(!g){for(let R=0;R<v.length;R+=1)b(M[R]);g=!0}},o(C){M=M.filter(Boolean);for(let R=0;R<M.length;R+=1)D(M[R]);g=!1},d(C){C&&m(e),Ge(M,C),c=!1,_()}}}function zi(n){let e,t,l;function s(i){n[9](i)}let r={size:"lg",$$slots:{default:[ji]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new Un({props:r}),je.push(()=>Xe(e,"show",s)),{c(){x(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,a){te(e,i,a),l=!0},p(i,[a]){const o={};a&16415&&(o.$$scope={dirty:a,ctx:i}),!t&&a&1&&(t=!0,o.show=i[0],Ye(()=>t=!1)),e.$set(o)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){le(e,i)}}}function Ui(n){return typeof n!="number"?null:n<0?0:n>1?100:Math.round(n*1e4)/100}function jl(n){return n>=80?"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200":n>=60?"bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200":n>=40?"bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200":"bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200"}function Wi(n,e,t){let l;const s=Ke("i18n");Ee(n,s,c=>t(4,l=c));let{show:r=!1}=e,{citation:i}=e,{showPercentage:a=!1}=e,{showRelevance:o=!0}=e,f=[];const u=c=>{try{return decodeURIComponent(c)}catch{return c}},d=()=>{t(0,r=!1)};function g(c){r=c,t(0,r)}return n.$$set=c=>{"show"in c&&t(0,r=c.show),"citation"in c&&t(7,i=c.citation),"showPercentage"in c&&t(1,a=c.showPercentage),"showRelevance"in c&&t(2,o=c.showRelevance)},n.$$.update=()=>{var c;n.$$.dirty&136&&i&&(t(3,f=(c=i.document)==null?void 0:c.map((_,v)=>{var M,E;return{source:i.source,document:_,metadata:(M=i.metadata)==null?void 0:M[v],distance:(E=i.distances)==null?void 0:E[v]}})),f.every(_=>_.distance!==void 0)&&t(3,f=f.sort((_,v)=>(v.distance??1/0)-(_.distance??1/0))))},[r,a,o,f,l,s,u,i,d,g]}class qi extends Le{constructor(e){super(),Pe(this,e,Wi,zi,Be,{show:0,citation:7,showPercentage:1,showRelevance:2})}}function zl(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Ul(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Wl(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function ql(n){let e,t,l,s;const r=[Ji,Fi],i=[];function a(o,f){return o[1].length<=3?0:1}return t=a(n),l=i[t]=r[t](n),{c(){e=y("div"),l.c(),this.h()},l(o){e=I(o,"DIV",{class:!0});var f=w(e);l.l(f),f.forEach(m),this.h()},h(){h(e,"class","py-0.5 -mx-0.5 w-full flex gap-1 items-center flex-wrap")},m(o,f){V(o,e,f),i[t].m(e,null),s=!0},p(o,f){let u=t;t=a(o),t===u?i[t].p(o,f):(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),l=i[t],l?l.p(o,f):(l=i[t]=r[t](o),l.c()),b(l,1),l.m(e,null))},i(o){s||(b(l),s=!0)},o(o){D(l),s=!1},d(o){o&&m(e),i[t].d()}}}function Fi(n){let e,t,l;function s(i){n[18](i)}let r={id:`collapsible-${n[0]}`,className:"w-full max-w-full ",buttonClassName:"w-fit max-w-full",$$slots:{content:[Qi],default:[Zi]},$$scope:{ctx:n}};return n[6]!==void 0&&(r.open=n[6]),e=new jn({props:r}),je.push(()=>Xe(e,"open",s)),{c(){x(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,a){te(e,i,a),l=!0},p(i,a){const o={};a&1&&(o.id=`collapsible-${i[0]}`),a&16777459&&(o.$$scope={dirty:a,ctx:i}),!t&&a&64&&(t=!0,o.open=i[6],Ye(()=>t=!1)),e.$set(o)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){le(e,i)}}}function Ji(n){let e,t=De(n[1]),l=[];for(let s=0;s<t.length;s+=1)l[s]=Ql(Wl(n,t,s));return{c(){e=y("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=I(s,"DIV",{class:!0});var r=w(e);for(let i=0;i<l.length;i+=1)l[i].l(r);r.forEach(m),this.h()},h(){h(e,"class","flex text-xs font-medium flex-wrap")},m(s,r){V(s,e,r);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null)},p(s,r){if(r&563){t=De(s[1]);let i;for(i=0;i<t.length;i+=1){const a=Wl(s,t,i);l[i]?l[i].p(a,r):(l[i]=Ql(a),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},i:Me,o:Me,d(s){s&&m(e),Ge(l,s)}}}function Fl(n){let e,t=n[21]+1+"",l;return{c(){e=y("div"),l=W(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var r=w(e);l=q(r,t),r.forEach(m),this.h()},h(){h(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){V(s,e,r),p(e,l)},d(s){s&&m(e)}}}function Jl(n){let e,t=n[1].every(n[13]),l,s,r=n[9](n[19].source.name)+"",i,a,o,f,u=t&&Fl(n);function d(){return n[17](n[19])}return{c(){e=y("button"),u&&u.c(),l=H(),s=y("div"),i=W(r),a=H(),this.h()},l(g){e=I(g,"BUTTON",{class:!0});var c=w(e);u&&u.l(c),l=j(c),s=I(c,"DIV",{class:!0});var _=w(s);i=q(_,r),_.forEach(m),a=j(c),c.forEach(m),this.h()},h(){h(s,"class","flex-1 mx-1 truncate"),h(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(g,c){V(g,e,c),u&&u.m(e,null),p(e,l),p(e,s),p(s,i),p(e,a),o||(f=[de(e,"click",d),de(e,"pointerup",xi)],o=!0)},p(g,c){n=g,c&2&&(t=n[1].every(n[13])),t?u||(u=Fl(n),u.c(),u.m(e,l)):u&&(u.d(1),u=null),c&2&&r!==(r=n[9](n[19].source.name)+"")&&K(i,r)},d(g){g&&m(e),u&&u.d(),o=!1,$e(f)}}}function Gi(n){let e,t;return e=new An({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Ki(n){let e,t;return e=new Hn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Zi(n){let e,t,l,s=n[7].t("References from")+"",r,i,a,o,f,u,d,g=n[7].t("and")+"",c,_,v=n[1].length-2+"",M,E,C,R=n[7].t("more")+"",L,O,k,N,S,B,T=De(n[1].slice(0,2)),P=[];for(let Y=0;Y<T.length;Y+=1)P[Y]=Jl(zl(n,T,Y));const Q=[Ki,Gi],F=[];function re(Y,oe){return Y[6]?0:1}return N=re(n),S=F[N]=Q[N](n),{c(){e=y("div"),t=y("div"),l=y("span"),r=W(s),i=H(),a=y("div"),o=y("div");for(let Y=0;Y<P.length;Y+=1)P[Y].c();f=H(),u=y("div"),d=y("span"),c=W(g),_=H(),M=W(v),E=H(),C=y("span"),L=W(R),O=H(),k=y("div"),S.c(),this.h()},l(Y){e=I(Y,"DIV",{class:!0});var oe=w(e);t=I(oe,"DIV",{class:!0});var he=w(t);l=I(he,"SPAN",{class:!0});var ue=w(l);r=q(ue,s),ue.forEach(m),i=j(he),a=I(he,"DIV",{class:!0});var ke=w(a);o=I(ke,"DIV",{class:!0});var U=w(o);for(let J=0;J<P.length;J+=1)P[J].l(U);U.forEach(m),ke.forEach(m),f=j(he),u=I(he,"DIV",{class:!0});var Z=w(u);d=I(Z,"SPAN",{class:!0});var ge=w(d);c=q(ge,g),ge.forEach(m),_=j(Z),M=q(Z,v),E=j(Z),C=I(Z,"SPAN",{});var pe=w(C);L=q(pe,R),pe.forEach(m),Z.forEach(m),he.forEach(m),O=j(oe),k=I(oe,"DIV",{class:!0});var _e=w(k);S.l(_e),_e.forEach(m),oe.forEach(m),this.h()},h(){h(l,"class","whitespace-nowrap hidden sm:inline shrink-0"),h(o,"class","flex text-xs font-medium items-center"),h(a,"class","flex items-center overflow-auto scrollbar-none w-full max-w-full flex-1"),h(d,"class","hidden sm:inline"),h(u,"class","flex items-center gap-1 whitespace-nowrap shrink-0"),h(t,"class","flex-1 flex items-center gap-1 overflow-auto scrollbar-none w-full max-w-full"),h(k,"class","shrink-0"),h(e,"class","flex w-full overflow-auto items-center gap-2 text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition cursor-pointer")},m(Y,oe){V(Y,e,oe),p(e,t),p(t,l),p(l,r),p(t,i),p(t,a),p(a,o);for(let he=0;he<P.length;he+=1)P[he]&&P[he].m(o,null);p(t,f),p(t,u),p(u,d),p(d,c),p(u,_),p(u,M),p(u,E),p(u,C),p(C,L),p(e,O),p(e,k),F[N].m(k,null),B=!0},p(Y,oe){if((!B||oe&128)&&s!==(s=Y[7].t("References from")+"")&&K(r,s),oe&562){T=De(Y[1].slice(0,2));let ue;for(ue=0;ue<T.length;ue+=1){const ke=zl(Y,T,ue);P[ue]?P[ue].p(ke,oe):(P[ue]=Jl(ke),P[ue].c(),P[ue].m(o,null))}for(;ue<P.length;ue+=1)P[ue].d(1);P.length=T.length}(!B||oe&128)&&g!==(g=Y[7].t("and")+"")&&K(c,g),(!B||oe&2)&&v!==(v=Y[1].length-2+"")&&K(M,v),(!B||oe&128)&&R!==(R=Y[7].t("more")+"")&&K(L,R);let he=N;N=re(Y),N!==he&&(se(),D(F[he],1,1,()=>{F[he]=null}),ne(),S=F[N],S||(S=F[N]=Q[N](Y),S.c()),b(S,1),S.m(k,null))},i(Y){B||(b(S),B=!0)},o(Y){D(S),B=!1},d(Y){Y&&m(e),Ge(P,Y),F[N].d()}}}function Gl(n){let e,t=n[21]+1+"",l;return{c(){e=y("div"),l=W(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var r=w(e);l=q(r,t),r.forEach(m),this.h()},h(){h(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){V(s,e,r),p(e,l)},d(s){s&&m(e)}}}function Kl(n){let e,t=n[1].every(n[12]),l,s,r=n[9](n[19].source.name)+"",i,a,o,f,u,d=t&&Gl(n);function g(){return n[16](n[19])}return{c(){e=y("button"),d&&d.c(),l=H(),s=y("div"),i=W(r),a=H(),this.h()},l(c){e=I(c,"BUTTON",{id:!0,class:!0});var _=w(e);d&&d.l(_),l=j(_),s=I(_,"DIV",{class:!0});var v=w(s);i=q(v,r),v.forEach(m),a=j(_),_.forEach(m),this.h()},h(){h(s,"class","flex-1 mx-1 truncate"),h(e,"id",o=`source-${n[0]}-${n[21]+1}`),h(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(c,_){V(c,e,_),d&&d.m(e,null),p(e,l),p(e,s),p(s,i),p(e,a),f||(u=de(e,"click",g),f=!0)},p(c,_){n=c,_&2&&(t=n[1].every(n[12])),t?d||(d=Gl(n),d.c(),d.m(e,l)):d&&(d.d(1),d=null),_&2&&r!==(r=n[9](n[19].source.name)+"")&&K(i,r),_&1&&o!==(o=`source-${n[0]}-${n[21]+1}`)&&h(e,"id",o)},d(c){c&&m(e),d&&d.d(),f=!1,u()}}}function Qi(n){let e,t,l=De(n[1]),s=[];for(let r=0;r<l.length;r+=1)s[r]=Kl(Ul(n,l,r));return{c(){e=y("div"),t=y("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=I(r,"DIV",{slot:!0});var i=w(e);t=I(i,"DIV",{class:!0});var a=w(t);for(let o=0;o<s.length;o+=1)s[o].l(a);a.forEach(m),i.forEach(m),this.h()},h(){h(t,"class","flex text-xs font-medium flex-wrap"),h(e,"slot","content")},m(r,i){V(r,e,i),p(e,t);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(t,null)},p(r,i){if(i&563){l=De(r[1]);let a;for(a=0;a<l.length;a+=1){const o=Ul(r,l,a);s[a]?s[a].p(o,i):(s[a]=Kl(o),s[a].c(),s[a].m(t,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=l.length}},d(r){r&&m(e),Ge(s,r)}}}function Zl(n){let e,t=n[21]+1+"",l;return{c(){e=y("div"),l=W(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var r=w(e);l=q(r,t),r.forEach(m),this.h()},h(){h(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){V(s,e,r),p(e,l)},d(s){s&&m(e)}}}function Ql(n){let e,t=n[1].every(n[11]),l,s,r=n[9](n[19].source.name)+"",i,a,o,f,u,d=t&&Zl(n);function g(){return n[15](n[19])}return{c(){e=y("button"),d&&d.c(),l=H(),s=y("div"),i=W(r),a=H(),this.h()},l(c){e=I(c,"BUTTON",{id:!0,class:!0});var _=w(e);d&&d.l(_),l=j(_),s=I(_,"DIV",{class:!0});var v=w(s);i=q(v,r),v.forEach(m),a=j(_),_.forEach(m),this.h()},h(){h(s,"class","flex-1 mx-1 truncate text-black/60 hover:text-black dark:text-white/60 dark:hover:text-white transition"),h(e,"id",o=`source-${n[0]}-${n[21]+1}`),h(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-white dark:bg-gray-900 rounded-xl max-w-96")},m(c,_){V(c,e,_),d&&d.m(e,null),p(e,l),p(e,s),p(s,i),p(e,a),f||(u=de(e,"click",g),f=!0)},p(c,_){n=c,_&2&&(t=n[1].every(n[11])),t?d||(d=Zl(n),d.c(),d.m(e,l)):d&&(d.d(1),d=null),_&2&&r!==(r=n[9](n[19].source.name)+"")&&K(i,r),_&1&&o!==(o=`source-${n[0]}-${n[21]+1}`)&&h(e,"id",o)},d(c){c&&m(e),d&&d.d(),f=!1,u()}}}function Yi(n){let e,t,l,s,r;function i(f){n[14](f)}let a={citation:n[5],showPercentage:n[2],showRelevance:n[3]};n[4]!==void 0&&(a.show=n[4]),e=new qi({props:a}),je.push(()=>Xe(e,"show",i));let o=n[1].length>0&&ql(n);return{c(){x(e.$$.fragment),l=H(),o&&o.c(),s=fe()},l(f){ee(e.$$.fragment,f),l=j(f),o&&o.l(f),s=fe()},m(f,u){te(e,f,u),V(f,l,u),o&&o.m(f,u),V(f,s,u),r=!0},p(f,[u]){const d={};u&32&&(d.citation=f[5]),u&4&&(d.showPercentage=f[2]),u&8&&(d.showRelevance=f[3]),!t&&u&16&&(t=!0,d.show=f[4],Ye(()=>t=!1)),e.$set(d),f[1].length>0?o?(o.p(f,u),u&2&&b(o,1)):(o=ql(f),o.c(),b(o,1),o.m(s.parentNode,s)):o&&(se(),D(o,1,1,()=>{o=null}),ne())},i(f){r||(b(e.$$.fragment,f),b(o),r=!0)},o(f){D(e.$$.fragment,f),D(o),r=!1},d(f){f&&(m(l),m(s)),le(e,f),o&&o.d(f)}}}function Xi(n){const e=n.flatMap(s=>s.distances??[]),t=e.filter(s=>s!==void 0&&s>=-1&&s<=1).length,l=e.filter(s=>s!==void 0&&(s<-1||s>1)).length;return!(e.length===0||t===e.length-1&&l===1||l===e.length-1&&t===1)}function $i(n){return n.flatMap(t=>t.distances??[]).every(t=>t!==void 0&&t>=-1&&t<=1)}const xi=n=>{n.stopPropagation()};function eo(n,e,t){let l;const s=Ke("i18n");Ee(n,s,k=>t(7,l=k));let{id:r=""}=e,{sources:i=[]}=e,a=[],o=!1,f=!0,u=!1,d=null,g=!1;const c=k=>{try{return decodeURIComponent(k)}catch{return k}},_=k=>k.distances!==void 0,v=k=>k.distances!==void 0,M=k=>k.distances!==void 0;function E(k){u=k,t(4,u)}const C=k=>{t(4,u=!0),t(5,d=k)},R=k=>{t(4,u=!0),t(5,d=k)},L=k=>{t(4,u=!0),t(5,d=k)};function O(k){g=k,t(6,g)}return n.$$set=k=>{"id"in k&&t(0,r=k.id),"sources"in k&&t(10,i=k.sources)},n.$$.update=()=>{n.$$.dirty&1026&&(console.log("sources",i),t(1,a=i.reduce((k,N)=>(Object.keys(N).length===0||N.document.forEach((S,B)=>{var Y,oe,he;const T=(Y=N.metadata)==null?void 0:Y[B],P=(oe=N.distances)==null?void 0:oe[B],Q=(T==null?void 0:T.source)??((he=N==null?void 0:N.source)==null?void 0:he.id)??"N/A";let F=N==null?void 0:N.source;T!=null&&T.name&&(F={...F,name:T.name}),(Q.startsWith("http://")||Q.startsWith("https://"))&&(F={...F,name:Q,url:Q});const re=k.find(ue=>ue.id===Q);re?(re.document.push(S),re.metadata.push(T),P!==void 0&&re.distances.push(P)):k.push({id:Q,source:F,document:[S],metadata:T?[T]:[],distances:P!==void 0?[P]:void 0})}),k),[])),console.log("citations",a),t(3,f=Xi(a)),t(2,o=$i(a)))},[r,a,o,f,u,d,g,l,s,c,i,_,v,M,E,C,R,L,O]}class to extends Le{constructor(e){super(),Pe(this,e,eo,Yi,Be,{id:0,sources:10})}}function Yl(n,e,t){const l=n.slice();return l[6]=e[t],l}function Xl(n){let e,t,l,s;const r=[no,so,lo],i=[];function a(o,f){var u,d;return(u=o[1].result)!=null&&u.error?0:(d=o[1].result)!=null&&d.output?1:2}return t=a(n),l=i[t]=r[t](n),{c(){e=y("div"),l.c()},l(o){e=I(o,"DIV",{});var f=w(e);l.l(f),f.forEach(m)},m(o,f){V(o,e,f),i[t].m(e,null),s=!0},p(o,f){let u=t;t=a(o),t!==u&&(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),l=i[t],l||(l=i[t]=r[t](o),l.c()),b(l,1),l.m(e,null))},i(o){s||(b(l),s=!0)},o(o){D(l),s=!1},d(o){o&&m(e),i[t].d()}}}function lo(n){let e,t;return e=new Yt({props:{type:"warning",content:"incomplete"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function so(n){let e,t;return e=new Yt({props:{type:"success",content:"success"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function no(n){let e,t;return e=new Yt({props:{type:"error",content:"error"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function $l(n){let e,t,l;return t=new Qt({props:{className:"size-4"}}),{c(){e=y("div"),x(t.$$.fragment)},l(s){e=I(s,"DIV",{});var r=w(e);ee(t.$$.fragment,r),r.forEach(m)},m(s,r){V(s,e,r),te(t,e,null),l=!0},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),le(t)}}}function ro(n){let e=n[2].t("Code execution")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&4&&e!==(e=l[2].t("Code execution")+"")&&K(t,e)},d(l){l&&m(t)}}}function io(n){var i;let e=n[2].t("Code execution")+"",t,l,s=((i=n[1])==null?void 0:i.name)+"",r;return{c(){t=W(e),l=W(": "),r=W(s)},l(a){t=q(a,e),l=q(a,": "),r=q(a,s)},m(a,o){V(a,t,o),V(a,l,o),V(a,r,o)},p(a,o){var f;o&4&&e!==(e=a[2].t("Code execution")+"")&&K(t,e),o&2&&s!==(s=((f=a[1])==null?void 0:f.name)+"")&&K(r,s)},d(a){a&&(m(t),m(l),m(r))}}}function xl(n){var r,i,a,o;let e,t,l=((i=(r=n[1])==null?void 0:r.result)==null?void 0:i.error)&&es(n),s=((o=(a=n[1])==null?void 0:a.result)==null?void 0:o.output)&&ts(n);return{c(){e=y("div"),l&&l.c(),t=H(),s&&s.c(),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=w(e);l&&l.l(u),t=j(u),s&&s.l(u),u.forEach(m),this.h()},h(){h(e,"class","dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3")},m(f,u){V(f,e,u),l&&l.m(e,null),p(e,t),s&&s.m(e,null)},p(f,u){var d,g,c,_;(g=(d=f[1])==null?void 0:d.result)!=null&&g.error?l?l.p(f,u):(l=es(f),l.c(),l.m(e,t)):l&&(l.d(1),l=null),(_=(c=f[1])==null?void 0:c.result)!=null&&_.output?s?s.p(f,u):(s=ts(f),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(f){f&&m(e),l&&l.d(),s&&s.d()}}}function es(n){var f,u;let e,t,l=n[2].t("ERROR")+"",s,r,i,a=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.error)+"",o;return{c(){e=y("div"),t=y("div"),s=W(l),r=H(),i=y("div"),o=W(a),this.h()},l(d){e=I(d,"DIV",{});var g=w(e);t=I(g,"DIV",{class:!0});var c=w(t);s=q(c,l),c.forEach(m),r=j(g),i=I(g,"DIV",{class:!0});var _=w(i);o=q(_,a),_.forEach(m),g.forEach(m),this.h()},h(){h(t,"class","text-gray-500 text-xs mb-1"),h(i,"class","text-sm")},m(d,g){V(d,e,g),p(e,t),p(t,s),p(e,r),p(e,i),p(i,o)},p(d,g){var c,_;g&4&&l!==(l=d[2].t("ERROR")+"")&&K(s,l),g&2&&a!==(a=((_=(c=d[1])==null?void 0:c.result)==null?void 0:_.error)+"")&&K(o,a)},d(d){d&&m(e)}}}function ts(n){var f,u;let e,t,l=n[2].t("OUTPUT")+"",s,r,i,a=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.output)+"",o;return{c(){e=y("div"),t=y("div"),s=W(l),r=H(),i=y("div"),o=W(a),this.h()},l(d){e=I(d,"DIV",{});var g=w(e);t=I(g,"DIV",{class:!0});var c=w(t);s=q(c,l),c.forEach(m),r=j(g),i=I(g,"DIV",{class:!0});var _=w(i);o=q(_,a),_.forEach(m),g.forEach(m),this.h()},h(){h(t,"class","text-gray-500 text-xs mb-1"),h(i,"class","text-sm")},m(d,g){V(d,e,g),p(e,t),p(t,s),p(e,r),p(e,i),p(i,o)},p(d,g){var c,_;g&4&&l!==(l=d[2].t("OUTPUT")+"")&&K(s,l),g&2&&a!==(a=((_=(c=d[1])==null?void 0:c.result)==null?void 0:_.output)+"")&&K(o,a)},d(d){d&&m(e)}}}function ls(n){var d,g;let e,t,l,s,r=n[2].t("Files")+"",i,a,o,f=De((g=(d=n[1])==null?void 0:d.result)==null?void 0:g.files),u=[];for(let c=0;c<f.length;c+=1)u[c]=ss(Yl(n,f,c));return{c(){e=y("div"),t=y("hr"),l=H(),s=y("div"),i=W(r),a=H(),o=y("ul");for(let c=0;c<u.length;c+=1)u[c].c();this.h()},l(c){e=I(c,"DIV",{class:!0});var _=w(e);t=I(_,"HR",{class:!0}),l=j(_),s=I(_,"DIV",{class:!0});var v=w(s);i=q(v,r),v.forEach(m),a=j(_),o=I(_,"UL",{class:!0});var M=w(o);for(let E=0;E<u.length;E+=1)u[E].l(M);M.forEach(m),_.forEach(m),this.h()},h(){h(t,"class","border-gray-100 dark:border-gray-850 my-2"),h(s,"class","text-sm font-medium dark:text-gray-300"),h(o,"class","mt-1 list-disc pl-4 text-xs"),h(e,"class","flex flex-col w-full")},m(c,_){V(c,e,_),p(e,t),p(e,l),p(e,s),p(s,i),p(e,a),p(e,o);for(let v=0;v<u.length;v+=1)u[v]&&u[v].m(o,null)},p(c,_){var v,M;if(_&4&&r!==(r=c[2].t("Files")+"")&&K(i,r),_&2){f=De((M=(v=c[1])==null?void 0:v.result)==null?void 0:M.files);let E;for(E=0;E<f.length;E+=1){const C=Yl(c,f,E);u[E]?u[E].p(C,_):(u[E]=ss(C),u[E].c(),u[E].m(o,null))}for(;E<u.length;E+=1)u[E].d(1);u.length=f.length}},d(c){c&&m(e),Ge(u,c)}}}function ss(n){let e,t,l=n[6].name+"",s,r,i;return{c(){e=y("li"),t=y("a"),s=W(l),i=H(),this.h()},l(a){e=I(a,"LI",{});var o=w(e);t=I(o,"A",{href:!0,target:!0});var f=w(t);s=q(f,l),f.forEach(m),i=j(o),o.forEach(m),this.h()},h(){h(t,"href",r=n[6].url),h(t,"target","_blank")},m(a,o){V(a,e,o),p(e,t),p(t,s),p(e,i)},p(a,o){o&2&&l!==(l=a[6].name+"")&&K(s,l),o&2&&r!==(r=a[6].url)&&h(t,"href",r)},d(a){a&&m(e)}}}function oo(n){var Q,F,re,Y,oe,he,ue,ke,U,Z,ge,pe,_e,J,me,ae,be,A,G;let e,t,l,s,r,i,a,o,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',d,g,c,_,v,M,E,C,R,L,O=((Q=n[1])==null?void 0:Q.result)&&Xl(n),k=!((F=n[1])!=null&&F.result)&&$l();function N($,X){var ce;return(ce=$[1])!=null&&ce.name?io:ro}let S=N(n),B=S(n);v=new Ur({props:{id:"code-exec-"+((re=n[1])==null?void 0:re.id)+"-code",lang:((Y=n[1])==null?void 0:Y.language)??"",code:((oe=n[1])==null?void 0:oe.code)??"",className:"",editorClassName:(he=n[1])!=null&&he.result&&((ke=(ue=n[1])==null?void 0:ue.result)!=null&&ke.error||(Z=(U=n[1])==null?void 0:U.result)!=null&&Z.output)?"rounded-b-none":"",stickyButtonsClassName:"top-0",run:!1}});let T=((ge=n[1])==null?void 0:ge.result)&&(((_e=(pe=n[1])==null?void 0:pe.result)==null?void 0:_e.error)||((me=(J=n[1])==null?void 0:J.result)==null?void 0:me.output))&&xl(n),P=((be=(ae=n[1])==null?void 0:ae.result)==null?void 0:be.files)&&((G=(A=n[1])==null?void 0:A.result)==null?void 0:G.files.length)>0&&ls(n);return{c(){e=y("div"),t=y("div"),l=y("div"),O&&O.c(),s=H(),r=y("div"),k&&k.c(),i=H(),a=y("div"),B.c(),o=H(),f=y("button"),f.innerHTML=u,d=H(),g=y("div"),c=y("div"),_=y("div"),x(v.$$.fragment),M=H(),T&&T.c(),E=H(),P&&P.c(),this.h()},l($){e=I($,"DIV",{});var X=w(e);t=I(X,"DIV",{class:!0});var ce=w(t);l=I(ce,"DIV",{class:!0});var ve=w(l);O&&O.l(ve),s=j(ve),r=I(ve,"DIV",{class:!0});var Te=w(r);k&&k.l(Te),i=j(Te),a=I(Te,"DIV",{});var Ne=w(a);B.l(Ne),Ne.forEach(m),Te.forEach(m),ve.forEach(m),o=j(ce),f=I(ce,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(f)!=="svelte-vnrwun"&&(f.innerHTML=u),ce.forEach(m),d=j(X),g=I(X,"DIV",{class:!0});var Ae=w(g);c=I(Ae,"DIV",{class:!0});var ze=w(c);_=I(ze,"DIV",{class:!0});var We=w(_);ee(v.$$.fragment,We),We.forEach(m),M=j(ze),T&&T.l(ze),E=j(ze),P&&P.l(ze),ze.forEach(m),Ae.forEach(m),X.forEach(m),this.h()},h(){h(r,"class","flex gap-2 items-center"),h(l,"class","text-lg font-medium self-center flex flex-col gap-0.5 capitalize"),h(f,"class","self-center"),h(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),h(_,"class","flex flex-col w-full"),h(c,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),h(g,"class","flex flex-col md:flex-row w-full px-4 pb-5")},m($,X){V($,e,X),p(e,t),p(t,l),O&&O.m(l,null),p(l,s),p(l,r),k&&k.m(r,null),p(r,i),p(r,a),B.m(a,null),p(t,o),p(t,f),p(e,d),p(e,g),p(g,c),p(c,_),te(v,_,null),p(c,M),T&&T.m(c,null),p(c,E),P&&P.m(c,null),C=!0,R||(L=de(f,"click",n[4]),R=!0)},p($,X){var ve,Te,Ne,Ae,ze,We,ie,Fe,tt,qe,Ze,ft,ut,rt,Mt,Et,Dt,Nt,Vt;(ve=$[1])!=null&&ve.result?O?(O.p($,X),X&2&&b(O,1)):(O=Xl($),O.c(),b(O,1),O.m(l,s)):O&&(se(),D(O,1,1,()=>{O=null}),ne()),(Te=$[1])!=null&&Te.result?k&&(se(),D(k,1,1,()=>{k=null}),ne()):k?X&2&&b(k,1):(k=$l(),k.c(),b(k,1),k.m(r,i)),S===(S=N($))&&B?B.p($,X):(B.d(1),B=S($),B&&(B.c(),B.m(a,null)));const ce={};X&2&&(ce.id="code-exec-"+((Ne=$[1])==null?void 0:Ne.id)+"-code"),X&2&&(ce.lang=((Ae=$[1])==null?void 0:Ae.language)??""),X&2&&(ce.code=((ze=$[1])==null?void 0:ze.code)??""),X&2&&(ce.editorClassName=(We=$[1])!=null&&We.result&&((Fe=(ie=$[1])==null?void 0:ie.result)!=null&&Fe.error||(qe=(tt=$[1])==null?void 0:tt.result)!=null&&qe.output)?"rounded-b-none":""),v.$set(ce),(Ze=$[1])!=null&&Ze.result&&((ut=(ft=$[1])==null?void 0:ft.result)!=null&&ut.error||(Mt=(rt=$[1])==null?void 0:rt.result)!=null&&Mt.output)?T?T.p($,X):(T=xl($),T.c(),T.m(c,E)):T&&(T.d(1),T=null),(Dt=(Et=$[1])==null?void 0:Et.result)!=null&&Dt.files&&((Vt=(Nt=$[1])==null?void 0:Nt.result)==null?void 0:Vt.files.length)>0?P?P.p($,X):(P=ls($),P.c(),P.m(c,null)):P&&(P.d(1),P=null)},i($){C||(b(O),b(k),b(v.$$.fragment,$),C=!0)},o($){D(O),D(k),D(v.$$.fragment,$),C=!1},d($){$&&m(e),O&&O.d(),k&&k.d(),B.d(),le(v),T&&T.d(),P&&P.d(),R=!1,L()}}}function ao(n){let e,t,l;function s(i){n[5](i)}let r={size:"lg",$$slots:{default:[oo]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new Un({props:r}),je.push(()=>Xe(e,"show",s)),{c(){x(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,a){te(e,i,a),l=!0},p(i,[a]){const o={};a&519&&(o.$$scope={dirty:a,ctx:i}),!t&&a&1&&(t=!0,o.show=i[0],Ye(()=>t=!1)),e.$set(o)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){le(e,i)}}}function fo(n,e,t){let l;const s=Ke("i18n");Ee(n,s,f=>t(2,l=f));let{show:r=!1}=e,{codeExecution:i=null}=e;const a=()=>{t(0,r=!1),t(1,i=null)};function o(f){r=f,t(0,r)}return n.$$set=f=>{"show"in f&&t(0,r=f.show),"codeExecution"in f&&t(1,i=f.codeExecution)},[r,i,l,s,a,o]}class uo extends Le{constructor(e){super(),Pe(this,e,fo,ao,Be,{show:0,codeExecution:1})}}function ns(n,e,t){const l=n.slice();return l[6]=e[t],l}function rs(n){let e,t=[],l=new Map,s,r=De(n[0]);const i=a=>a[6].id;for(let a=0;a<r.length;a+=1){let o=ns(n,r,a),f=i(o);l.set(f,t[a]=is(f,o))}return{c(){e=y("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=I(a,"DIV",{class:!0});var o=w(e);for(let f=0;f<t.length;f+=1)t[f].l(o);o.forEach(m),this.h()},h(){h(e,"class","mt-1 mb-2 w-full flex gap-1 items-center flex-wrap")},m(a,o){V(a,e,o);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);s=!0},p(a,o){o&7&&(r=De(a[0]),se(),t=Jt(t,o,i,1,a,r,l,e,Bn,is,null,ns),ne())},i(a){if(!s){for(let o=0;o<r.length;o+=1)b(t[o]);s=!0}},o(a){for(let o=0;o<t.length;o+=1)D(t[o]);s=!1},d(a){a&&m(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function co(n){let e,t;return e=new Qt({props:{className:"size-4"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p:Me,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ho(n){let e,t,l,s;const r=[_o,go,mo],i=[];function a(o,f){var u,d;return(u=o[6].result)!=null&&u.error?0:(d=o[6].result)!=null&&d.output?1:2}return e=a(n),t=i[e]=r[e](n),{c(){t.c(),l=fe()},l(o){t.l(o),l=fe()},m(o,f){i[e].m(o,f),V(o,l,f),s=!0},p(o,f){let u=e;e=a(o),e!==u&&(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),t=i[e],t||(t=i[e]=r[e](o),t.c()),b(t,1),t.m(l.parentNode,l))},i(o){s||(b(t),s=!0)},o(o){D(t),s=!1},d(o){o&&m(l),i[e].d(o)}}}function mo(n){let e,t;return e=new Zr({}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function go(n){let e,t;return e=new Gr({props:{strokeWidth:"3",className:"size-3"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function _o(n){let e,t;return e=new Kr({}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function is(n,e){let t,l,s,r,i,a,o,f=e[6].name+"",u,d,g,c,_,v;const M=[ho,co],E=[];function C(L,O){var k;return(k=L[6])!=null&&k.result?0:1}r=C(e),i=E[r]=M[r](e);function R(){return e[4](e[6])}return{key:n,first:null,c(){t=y("div"),l=y("button"),s=y("div"),i.c(),a=H(),o=y("div"),u=W(f),g=H(),this.h()},l(L){t=I(L,"DIV",{class:!0});var O=w(t);l=I(O,"BUTTON",{class:!0});var k=w(l);s=I(k,"DIV",{class:!0});var N=w(s);i.l(N),N.forEach(m),a=j(k),o=I(k,"DIV",{class:!0});var S=w(o);u=q(S,f),S.forEach(m),k.forEach(m),g=j(O),O.forEach(m),this.h()},h(){var L;h(s,"class","bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center"),h(o,"class",d="flex-1 mx-2 line-clamp-1 code-execution-name "+((L=e[6])!=null&&L.result?"":"pulse")+" svelte-1gvtig2"),h(l,"class","flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96"),h(t,"class","flex gap-1 text-xs font-semibold"),this.first=t},m(L,O){V(L,t,O),p(t,l),p(l,s),E[r].m(s,null),p(l,a),p(l,o),p(o,u),p(t,g),c=!0,_||(v=de(l,"click",R),_=!0)},p(L,O){var N;e=L;let k=r;r=C(e),r===k?E[r].p(e,O):(se(),D(E[k],1,1,()=>{E[k]=null}),ne(),i=E[r],i?i.p(e,O):(i=E[r]=M[r](e),i.c()),b(i,1),i.m(s,null)),(!c||O&1)&&f!==(f=e[6].name+"")&&K(u,f),(!c||O&1&&d!==(d="flex-1 mx-2 line-clamp-1 code-execution-name "+((N=e[6])!=null&&N.result?"":"pulse")+" svelte-1gvtig2"))&&h(o,"class",d)},i(L){c||(b(i),c=!0)},o(L){D(i),c=!1},d(L){L&&m(t),E[r].d(),_=!1,v()}}}function po(n){let e,t,l,s,r;function i(f){n[3](f)}let a={codeExecution:n[1]};n[2]!==void 0&&(a.show=n[2]),e=new uo({props:a}),je.push(()=>Xe(e,"show",i));let o=n[0].length>0&&rs(n);return{c(){x(e.$$.fragment),l=H(),o&&o.c(),s=fe()},l(f){ee(e.$$.fragment,f),l=j(f),o&&o.l(f),s=fe()},m(f,u){te(e,f,u),V(f,l,u),o&&o.m(f,u),V(f,s,u),r=!0},p(f,[u]){const d={};u&2&&(d.codeExecution=f[1]),!t&&u&4&&(t=!0,d.show=f[2],Ye(()=>t=!1)),e.$set(d),f[0].length>0?o?(o.p(f,u),u&1&&b(o,1)):(o=rs(f),o.c(),b(o,1),o.m(s.parentNode,s)):o&&(se(),D(o,1,1,()=>{o=null}),ne())},i(f){r||(b(e.$$.fragment,f),b(o),r=!0)},o(f){D(e.$$.fragment,f),D(o),r=!1},d(f){f&&(m(l),m(s)),le(e,f),o&&o.d(f)}}}function bo(n,e,t){let{codeExecutions:l=[]}=e,s=null,r=!1;const i=()=>{s&&t(1,s=l.find(f=>f.id===s.id))};function a(f){r=f,t(2,r)}const o=f=>{t(1,s=f),t(2,r=!0)};return n.$$set=f=>{"codeExecutions"in f&&t(0,l=f.codeExecutions)},n.$$.update=()=>{n.$$.dirty&1&&l&&i()},[l,s,r,a,o]}class vo extends Le{constructor(e){super(),Pe(this,e,bo,po,Be,{codeExecutions:0})}}function ko(n){let e,t;return{c(){e=ye("svg"),t=ye("path"),this.h()},l(l){e=Ie(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=Ie(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",n[1]),h(e,"stroke","currentColor"),h(e,"class",n[0])},m(l,s){V(l,e,s),p(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:Me,o:Me,d(l){l&&m(e)}}}function wo(n,e,t){let{className:l="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class yo extends Le{constructor(e){super(),Pe(this,e,wo,ko,Be,{className:0,strokeWidth:1})}}function Io(n){let e,t,l,s,r,i,a,o,f,u,d,g;s=new It({props:{id:`${n[0]}-float-prompt`,content:n[4]}});const c=[Do,Eo],_=[];function v(E,C){return C&32&&(o=null),o==null&&(o=E[5].trim()===""),o?0:1}f=v(n,-1),u=_[f]=c[f](n);let M=n[6]&&os(n);return{c(){e=y("div"),t=y("div"),l=y("div"),x(s.$$.fragment),r=H(),i=y("div"),a=y("div"),u.c(),d=H(),M&&M.c(),this.h()},l(E){e=I(E,"DIV",{class:!0});var C=w(e);t=I(C,"DIV",{class:!0});var R=w(t);l=I(R,"DIV",{class:!0});var L=w(l);ee(s.$$.fragment,L),L.forEach(m),R.forEach(m),r=j(C),i=I(C,"DIV",{class:!0});var O=w(i);a=I(O,"DIV",{class:!0,id:!0});var k=w(a);u.l(k),d=j(k),M&&M.l(k),k.forEach(m),O.forEach(m),C.forEach(m),this.h()},h(){h(l,"class","font-medium"),h(t,"class","bg-gray-50/50 dark:bg-gray-800 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),h(a,"class","max-h-80 overflow-y-auto w-full markdown-prose-xs"),h(a,"id","response-container"),h(i,"class","bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),h(e,"class","bg-white dark:bg-gray-850 dark:text-gray-100 rounded-xl shadow-xl w-80 max-w-full")},m(E,C){V(E,e,C),p(e,t),p(t,l),te(s,l,null),p(e,r),p(e,i),p(i,a),_[f].m(a,null),p(a,d),M&&M.m(a,null),g=!0},p(E,C){const R={};C&1&&(R.id=`${E[0]}-float-prompt`),C&16&&(R.content=E[4]),s.$set(R);let L=f;f=v(E,C),f===L?_[f].p(E,C):(se(),D(_[L],1,1,()=>{_[L]=null}),ne(),u=_[f],u?u.p(E,C):(u=_[f]=c[f](E),u.c()),b(u,1),u.m(a,d)),E[6]?M?M.p(E,C):(M=os(E),M.c(),M.m(a,null)):M&&(M.d(1),M=null)},i(E){g||(b(s.$$.fragment,E),b(u),g=!0)},o(E){D(s.$$.fragment,E),D(u),g=!1},d(E){E&&m(e),le(s),_[f].d(),M&&M.d()}}}function Mo(n){let e,t,l,s;const r=[Vo,No],i=[];function a(o,f){return o[1]?1:0}return e=a(n),t=i[e]=r[e](n),{c(){t.c(),l=fe()},l(o){t.l(o),l=fe()},m(o,f){i[e].m(o,f),V(o,l,f),s=!0},p(o,f){let u=e;e=a(o),e===u?i[e].p(o,f):(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),t=i[e],t?t.p(o,f):(t=i[e]=r[e](o),t.c()),b(t,1),t.m(l.parentNode,l))},i(o){s||(b(t),s=!0)},o(o){D(t),s=!1},d(o){o&&m(l),i[e].d(o)}}}function Eo(n){let e,t;return e=new It({props:{id:`${n[0]}-float-response`,content:n[5]}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s&1&&(r.id=`${l[0]}-float-response`),s&32&&(r.content=l[5]),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Do(n){let e,t;return e=new $t({props:{size:"sm"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p:Me,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function os(n){let e,t,l=n[7].t("Add")+"",s,r,i;return{c(){e=y("div"),t=y("button"),s=W(l),this.h()},l(a){e=I(a,"DIV",{class:!0});var o=w(e);t=I(o,"BUTTON",{class:!0});var f=w(t);s=q(f,l),f.forEach(m),o.forEach(m),this.h()},h(){h(t,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),h(e,"class","flex justify-end pt-3 text-sm font-medium")},m(a,o){V(a,e,o),p(e,t),p(t,s),r||(i=de(t,"click",n[11]),r=!0)},p(a,o){o&128&&l!==(l=a[7].t("Add")+"")&&K(s,l)},d(a){a&&m(e),r=!1,i()}}}function No(n){let e,t,l,s,r,i,a,o,f,u,d;return{c(){e=y("div"),t=y("input"),s=H(),r=y("div"),i=y("button"),a=ye("svg"),o=ye("path"),this.h()},l(g){e=I(g,"DIV",{class:!0});var c=w(e);t=I(c,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),s=j(c),r=I(c,"DIV",{class:!0});var _=w(r);i=I(_,"BUTTON",{class:!0});var v=w(i);a=Ie(v,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var M=w(a);o=Ie(M,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),w(o).forEach(m),M.forEach(m),v.forEach(m),_.forEach(m),c.forEach(m),this.h()},h(){h(t,"type","text"),h(t,"id","floating-message-input"),h(t,"class","ml-5 bg-transparent outline-hidden w-full flex-1 text-sm"),h(t,"placeholder",l=n[7].t("Ask a question")),h(o,"fill-rule","evenodd"),h(o,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),h(o,"clip-rule","evenodd"),h(a,"xmlns","http://www.w3.org/2000/svg"),h(a,"viewBox","0 0 16 16"),h(a,"fill","currentColor"),h(a,"class","size-4"),h(i,"class",f=(n[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center"),h(r,"class","ml-1 mr-2"),h(e,"class","py-1 flex dark:text-gray-100 bg-gray-50 dark:bg-gray-800 border border-gray-100 dark:border-gray-850 w-72 rounded-full shadow-xl")},m(g,c){V(g,e,c),p(e,t),ot(t,n[3]),p(e,s),p(e,r),p(r,i),p(i,a),p(a,o),u||(d=[de(t,"input",n[18]),de(t,"keydown",n[19]),de(i,"click",n[20])],u=!0)},p(g,c){c&128&&l!==(l=g[7].t("Ask a question"))&&h(t,"placeholder",l),c&8&&t.value!==g[3]&&ot(t,g[3]),c&8&&f!==(f=(g[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center")&&h(i,"class",f)},i:Me,o:Me,d(g){g&&m(e),u=!1,$e(d)}}}function Vo(n){let e,t,l,s,r,i=n[7].t("Ask")+"",a,o,f,u,d,g,c=n[7].t("Explain")+"",_,v,M,E;return l=new yo({props:{className:"size-3 shrink-0"}}),u=new Wr({props:{className:"size-3 shrink-0"}}),{c(){e=y("div"),t=y("button"),x(l.$$.fragment),s=H(),r=y("div"),a=W(i),o=H(),f=y("button"),x(u.$$.fragment),d=H(),g=y("div"),_=W(c),this.h()},l(C){e=I(C,"DIV",{class:!0});var R=w(e);t=I(R,"BUTTON",{class:!0});var L=w(t);ee(l.$$.fragment,L),s=j(L),r=I(L,"DIV",{class:!0});var O=w(r);a=q(O,i),O.forEach(m),L.forEach(m),o=j(R),f=I(R,"BUTTON",{class:!0});var k=w(f);ee(u.$$.fragment,k),d=j(k),g=I(k,"DIV",{class:!0});var N=w(g);_=q(N,c),N.forEach(m),k.forEach(m),R.forEach(m),this.h()},h(){h(r,"class","shrink-0"),h(t,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),h(g,"class","shrink-0"),h(f,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),h(e,"class","flex flex-row gap-0.5 shrink-0 p-1 bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-lg shadow-xl")},m(C,R){V(C,e,R),p(e,t),te(l,t,null),p(t,s),p(t,r),p(r,a),p(e,o),p(e,f),te(u,f,null),p(f,d),p(f,g),p(g,_),v=!0,M||(E=[de(t,"click",n[16]),de(f,"click",n[17])],M=!0)},p(C,R){(!v||R&128)&&i!==(i=C[7].t("Ask")+"")&&K(a,i),(!v||R&128)&&c!==(c=C[7].t("Explain")+"")&&K(_,c)},i(C){v||(b(l.$$.fragment,C),b(u.$$.fragment,C),v=!0)},o(C){D(l.$$.fragment,C),D(u.$$.fragment,C),v=!1},d(C){C&&m(e),le(l),le(u),M=!1,$e(E)}}}function Co(n){let e,t,l,s,r;const i=[Mo,Io],a=[];function o(f,u){return f[5]===null?0:1}return t=o(n),l=a[t]=i[t](n),{c(){e=y("div"),l.c(),this.h()},l(f){e=I(f,"DIV",{id:!0,class:!0,style:!0});var u=w(e);l.l(u),u.forEach(m),this.h()},h(){h(e,"id",s=`floating-buttons-${n[0]}`),h(e,"class","absolute rounded-lg mt-1 text-xs z-9999"),Rt(e,"display","none")},m(f,u){V(f,e,u),a[t].m(e,null),r=!0},p(f,[u]){let d=t;t=o(f),t===d?a[t].p(f,u):(se(),D(a[d],1,1,()=>{a[d]=null}),ne(),l=a[t],l?l.p(f,u):(l=a[t]=i[t](f),l.c()),b(l,1),l.m(e,null)),(!r||u&1&&s!==(s=`floating-buttons-${f[0]}`))&&h(e,"id",s)},i(f){r||(b(l),r=!0)},o(f){D(l),r=!1},d(f){f&&m(e),a[t].d()}}}function To(n,e,t){let l;const s=Ke("i18n");Ee(n,s,B=>t(7,l=B));let{id:r=""}=e,{model:i=null}=e,{messages:a=[]}=e,{onAdd:o=()=>{}}=e,f=!1,u="",d="",g="",c=null,_=!1;const v=async()=>{const B=document.getElementById("response-container");B.scrollHeight-B.clientHeight<=B.scrollTop+50&&(B.scrollTop=B.scrollHeight)},M=async()=>{if(!i){He.error("Model not selected");return}t(4,g=`${d}
\`\`\`
${u}
\`\`\``),t(3,d=""),t(5,c="");const[B,T]=await kl(localStorage.token,{model:i,messages:[...a,{role:"user",content:g}].map(P=>({role:P.role,content:P.content})),stream:!0});if(B&&B.ok){const P=B.body.getReader(),Q=new TextDecoder;await(async()=>{var re,Y;for(;;){const{done:oe,value:he}=await P.read();if(oe)break;const ke=Q.decode(he,{stream:!0}).split(`
`).filter(U=>U.trim()!=="");for(const U of ke)if(U.startsWith("data: "))if(U.startsWith("data: [DONE]")){t(6,_=!0),await Ve(),v();continue}else try{const Z=JSON.parse(U.slice(6));Z.choices&&((Y=(re=Z.choices[0])==null?void 0:re.delta)!=null&&Y.content)&&(t(5,c+=Z.choices[0].delta.content),v())}catch(Z){console.error(Z)}}})()}else He.error("An error occurred while fetching the explanation")},E=async()=>{if(!i){He.error("Model not selected");return}const B=l.t("Explain this section to me in more detail");t(4,g=`${B}

\`\`\`
${u}
\`\`\``),t(5,c="");const[T,P]=await kl(localStorage.token,{model:i,messages:[...a,{role:"user",content:g}].map(Q=>({role:Q.role,content:Q.content})),stream:!0});if(T&&T.ok){const Q=T.body.getReader(),F=new TextDecoder;await(async()=>{var Y,oe;for(;;){const{done:he,value:ue}=await Q.read();if(he)break;const U=F.decode(ue,{stream:!0}).split(`
`).filter(Z=>Z.trim()!=="");for(const Z of U)if(Z.startsWith("data: "))if(Z.startsWith("data: [DONE]")){t(6,_=!0),await Ve(),v();continue}else try{const ge=JSON.parse(Z.slice(6));ge.choices&&((oe=(Y=ge.choices[0])==null?void 0:Y.delta)!=null&&oe.content)&&(t(5,c+=ge.choices[0].delta.content),v())}catch(ge){console.error(ge)}}})()}else He.error("An error occurred while fetching the explanation")},C=async()=>{o({modelId:i,parentId:r,messages:[{role:"user",content:g},{role:"assistant",content:c}]})},R=()=>{t(5,c=null),t(6,_=!1),t(1,f=!1),t(3,d="")},L=async()=>{t(2,u=window.getSelection().toString()),t(1,f=!0),await Ve(),setTimeout(()=>{const B=document.getElementById("floating-message-input");B&&B.focus()},0)},O=()=>{t(2,u=window.getSelection().toString()),E()};function k(){d=this.value,t(3,d)}const N=B=>{B.key==="Enter"&&M()},S=()=>{M()};return n.$$set=B=>{"id"in B&&t(0,r=B.id),"model"in B&&t(12,i=B.model),"messages"in B&&t(13,a=B.messages),"onAdd"in B&&t(14,o=B.onAdd)},[r,f,u,d,g,c,_,l,s,M,E,C,i,a,o,R,L,O,k,N,S]}class Bo extends Le{constructor(e){super(),Pe(this,e,To,Co,Be,{id:0,model:12,messages:13,onAdd:14,closeHandler:15})}get closeHandler(){return this.$$.ctx[15]}}function as(n){var s;let e,t,l={id:n[0],model:(s=n[3])==null?void 0:s.id,messages:Ft(n[2],n[0]),onAdd:n[22]};return e=new Bo({props:l}),n[23](e),{c(){x(e.$$.fragment)},l(r){ee(e.$$.fragment,r)},m(r,i){te(e,r,i),t=!0},p(r,i){var o;const a={};i&1&&(a.id=r[0]),i&8&&(a.model=(o=r[3])==null?void 0:o.id),i&5&&(a.messages=Ft(r[2],r[0])),i&2048&&(a.onAdd=r[22]),e.$set(a)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){n[23](null),le(e,r)}}}function So(n){let e,t,l,s,r;t=new It({props:{id:n[0],content:n[1],model:n[3],save:n[5],preview:n[6],sourceIds:(n[4]??[]).reduce(n[18],[]),onSourceClick:n[9],onTaskClick:n[10],onSave:n[8],onUpdate:n[19],onPreview:n[20]}});let i=n[7]&&n[3]&&as(n);return{c(){e=y("div"),x(t.$$.fragment),l=H(),i&&i.c(),s=fe()},l(a){e=I(a,"DIV",{});var o=w(e);ee(t.$$.fragment,o),o.forEach(m),l=j(a),i&&i.l(a),s=fe()},m(a,o){V(a,e,o),te(t,e,null),n[21](e),V(a,l,o),i&&i.m(a,o),V(a,s,o),r=!0},p(a,[o]){const f={};o&1&&(f.id=a[0]),o&2&&(f.content=a[1]),o&8&&(f.model=a[3]),o&32&&(f.save=a[5]),o&64&&(f.preview=a[6]),o&24&&(f.sourceIds=(a[4]??[]).reduce(a[18],[])),o&512&&(f.onSourceClick=a[9]),o&1024&&(f.onTaskClick=a[10]),o&256&&(f.onSave=a[8]),o&114688&&(f.onUpdate=a[19]),t.$set(f),a[7]&&a[3]?i?(i.p(a,o),o&136&&b(i,1)):(i=as(a),i.c(),b(i,1),i.m(s.parentNode,s)):i&&(se(),D(i,1,1,()=>{i=null}),ne())},i(a){r||(b(t.$$.fragment,a),b(i),r=!0)},o(a){D(t.$$.fragment,a),D(i),r=!1},d(a){a&&(m(e),m(l),m(s)),le(t),n[21](null),i&&i.d(a)}}}function Oo(n,e,t){let l,s,r;Ee(n,Sn,F=>t(14,l=F)),Ee(n,gt,F=>t(15,s=F)),Ee(n,Mr,F=>t(16,r=F)),Ke("i18n");let{id:i}=e,{content:a}=e,{history:o}=e,{model:f=null}=e,{sources:u=null}=e,{save:d=!1}=e,{preview:g=!1}=e,{floatingButtons:c=!0}=e,{onSave:_=()=>{}}=e,{onSourceClick:v=()=>{}}=e,{onTaskClick:M=()=>{}}=e,{onAddMessages:E=()=>{}}=e,C,R;const L=F=>{const re=document.getElementById(`floating-buttons-${i}`);if(!(C!=null&&C.contains(F.target))&&!(re!=null&&re.contains(F.target))){O();return}setTimeout(async()=>{if(await Ve(),!(C!=null&&C.contains(F.target)))return;let Y=window.getSelection();if(Y.toString().trim().length>0){const he=Y.getRangeAt(0).getBoundingClientRect(),ue=C.getBoundingClientRect(),ke=he.bottom-ue.top,U=he.left-ue.left;if(re){re.style.display="block";const Z=ue.width-U;let ge=l?window.innerWidth/2:window.innerWidth/3;if(Z<ge){const pe=ue.right-he.right;re.style.right=`${pe}px`,re.style.left="auto"}else re.style.left=`${U}px`,re.style.right="auto";re.style.top=`${ke+5}px`}}else O()},0)},O=()=>{const F=document.getElementById(`floating-buttons-${i}`);F&&(F.style.display="none"),R&&typeof(R==null?void 0:R.closeHandler)=="function"&&(R==null||R.closeHandler())},k=F=>{F.key==="Escape"&&O()};kt(()=>{c&&(C==null||C.addEventListener("mouseup",L),document.addEventListener("mouseup",L),document.addEventListener("keydown",k))}),vr(()=>{c&&(C==null||C.removeEventListener("mouseup",L),document.removeEventListener("mouseup",L),document.removeEventListener("keydown",k))});const N=(F,re)=>{let Y=[];return re.document.forEach((oe,he)=>{var U,Z,ge,pe,_e;if(((ge=(Z=(U=f==null?void 0:f.info)==null?void 0:U.meta)==null?void 0:Z.capabilities)==null?void 0:ge.citations)==!1)return Y.push("N/A"),Y;const ue=(pe=re.metadata)==null?void 0:pe[he],ke=(ue==null?void 0:ue.source)??"N/A";return ue!=null&&ue.name?(Y.push(ue.name),Y):(ke.startsWith("http://")||ke.startsWith("https://")?Y.push(ke):Y.push(((_e=re==null?void 0:re.source)==null?void 0:_e.name)??ke),Y)}),F=[...F,...Y],F.filter((oe,he)=>F.indexOf(oe)===he)},S=F=>{const{lang:re,text:Y}=F;((s==null?void 0:s.detectArtifacts)??!0)&&(["html","svg"].includes(re)||re==="xml"&&Y.includes("svg"))&&!l&&r&&(hl.set(!0),ml.set(!0))},B=async F=>{console.log("Preview",F),await Er.set(F),await ml.set(!0),await hl.set(!0),await Dr.set(!1)};function T(F){je[F?"unshift":"push"](()=>{C=F,t(12,C)})}const P=({modelId:F,parentId:re,messages:Y})=>{console.log(F,re,Y),E({modelId:F,parentId:re,messages:Y}),O()};function Q(F){je[F?"unshift":"push"](()=>{R=F,t(13,R)})}return n.$$set=F=>{"id"in F&&t(0,i=F.id),"content"in F&&t(1,a=F.content),"history"in F&&t(2,o=F.history),"model"in F&&t(3,f=F.model),"sources"in F&&t(4,u=F.sources),"save"in F&&t(5,d=F.save),"preview"in F&&t(6,g=F.preview),"floatingButtons"in F&&t(7,c=F.floatingButtons),"onSave"in F&&t(8,_=F.onSave),"onSourceClick"in F&&t(9,v=F.onSourceClick),"onTaskClick"in F&&t(10,M=F.onTaskClick),"onAddMessages"in F&&t(11,E=F.onAddMessages)},[i,a,o,f,u,d,g,c,_,v,M,E,C,R,l,s,r,O,N,S,B,T,P,Q]}class Ro extends Le{constructor(e){super(),Pe(this,e,Oo,So,Be,{id:0,content:1,history:2,model:3,sources:4,save:5,preview:6,floatingButtons:7,onSave:8,onSourceClick:9,onTaskClick:10,onAddMessages:11})}}function fs(n,e,t){const l=n.slice();return l[90]=e[t],l}function us(n,e,t){const l=n.slice();return l[93]=e[t],l}function Ut(n){var l,s,r;const e=n.slice(),t=(((l=e[12])==null?void 0:l.statusHistory)??[...(s=e[12])!=null&&s.status?[(r=e[12])==null?void 0:r.status]:[]]).at(-1);return e[96]=t,e}function Lo(n){var s;let e,t=(((s=n[17])==null?void 0:s.name)??n[12].model)+"",l;return{c(){e=y("span"),l=W(t),this.h()},l(r){e=I(r,"SPAN",{class:!0});var i=w(e);l=q(i,t),i.forEach(m),this.h()},h(){h(e,"class","line-clamp-1 text-black dark:text-white")},m(r,i){V(r,e,i),p(e,l)},p(r,i){var a;i[0]&135168&&t!==(t=(((a=r[17])==null?void 0:a.name)??r[12].model)+"")&&K(l,t)},d(r){r&&m(e)}}}function cs(n){let e,t,l;return t=new Oe({props:{content:at(n[12].timestamp*1e3).format("LLLL"),$$slots:{default:[Po]},$$scope:{ctx:n}}}),{c(){e=y("div"),x(t.$$.fragment),this.h()},l(s){e=I(s,"DIV",{class:!0});var r=w(e);ee(t.$$.fragment,r),r.forEach(m),this.h()},h(){h(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){V(s,e,r),te(t,e,null),l=!0},p(s,r){const i={};r[0]&4096&&(i.content=at(s[12].timestamp*1e3).format("LLLL")),r[0]&4096|r[3]&16&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),le(t)}}}function Po(n){let e,t=At(n[12].timestamp*1e3)+"",l;return{c(){e=y("span"),l=W(t),this.h()},l(s){e=I(s,"SPAN",{class:!0});var r=w(e);l=q(r,t),r.forEach(m),this.h()},h(){h(e,"class","line-clamp-1")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r[0]&4096&&t!==(t=At(s[12].timestamp*1e3)+"")&&K(l,t)},d(s){s&&m(e)}}}function Ao(n){var i;let e,t,l,s;e=new Oe({props:{content:((i=n[17])==null?void 0:i.name)??n[12].model,placement:"top-start",$$slots:{default:[Lo]},$$scope:{ctx:n}}});let r=n[12].timestamp&&cs(n);return{c(){x(e.$$.fragment),t=H(),r&&r.c(),l=fe()},l(a){ee(e.$$.fragment,a),t=j(a),r&&r.l(a),l=fe()},m(a,o){te(e,a,o),V(a,t,o),r&&r.m(a,o),V(a,l,o),s=!0},p(a,o){var u;const f={};o[0]&135168&&(f.content=((u=a[17])==null?void 0:u.name)??a[12].model),o[0]&135168|o[3]&16&&(f.$$scope={dirty:o,ctx:a}),e.$set(f),a[12].timestamp?r?(r.p(a,o),o[0]&4096&&b(r,1)):(r=cs(a),r.c(),b(r,1),r.m(l.parentNode,l)):r&&(se(),D(r,1,1,()=>{r=null}),ne())},i(a){s||(b(e.$$.fragment,a),b(r),s=!0)},o(a){D(e.$$.fragment,a),D(r),s=!1},d(a){a&&(m(t),m(l)),le(e,a),r&&r.d(a)}}}function ds(n){var s;let e,t,l=!((s=n[96])!=null&&s.hidden)&&hs(n);return{c(){l&&l.c(),e=fe()},l(r){l&&l.l(r),e=fe()},m(r,i){l&&l.m(r,i),V(r,e,i),t=!0},p(r,i){var a;(a=r[96])!=null&&a.hidden?l&&(se(),D(l,1,1,()=>{l=null}),ne()):l?(l.p(r,i),i[0]&4096&&b(l,1)):(l=hs(r),l.c(),b(l,1),l.m(e.parentNode,e))},i(r){t||(b(l),t=!0)},o(r){D(l),t=!1},d(r){r&&m(e),l&&l.d(r)}}}function hs(n){let e,t,l,s;const r=[zo,jo,Ho],i=[];function a(o,f){var u,d,g;return((u=o[96])==null?void 0:u.action)==="web_search"&&((d=o[96])!=null&&d.urls)?0:((g=o[96])==null?void 0:g.action)==="knowledge_search"?1:2}return t=a(n),l=i[t]=r[t](n),{c(){e=y("div"),l.c(),this.h()},l(o){e=I(o,"DIV",{class:!0});var f=w(e);l.l(f),f.forEach(m),this.h()},h(){h(e,"class","status-description flex items-center gap-2 py-0.5")},m(o,f){V(o,e,f),i[t].m(e,null),s=!0},p(o,f){let u=t;t=a(o),t===u?i[t].p(o,f):(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),l=i[t],l?l.p(o,f):(l=i[t]=r[t](o),l.c()),b(l,1),l.m(e,null))},i(o){s||(b(l),s=!0)},o(o){D(l),s=!1},d(o){o&&m(e),i[t].d()}}}function Ho(n){let e,t,l,s;function r(o,f){var u,d,g,c;return f[0]&4096&&(l=null),l==null&&(l=!!((u=o[96])!=null&&u.description.includes("{{searchQuery}}"))),l?Jo:((d=o[96])==null?void 0:d.description)==="No search query generated"?Fo:((g=o[96])==null?void 0:g.description)==="Generating search query"?qo:((c=o[96])==null?void 0:c.description)==="Searching the web"?Wo:Uo}let i=r(n,[-1,-1,-1,-1]),a=i(n);return{c(){e=y("div"),t=y("div"),a.c(),this.h()},l(o){e=I(o,"DIV",{class:!0});var f=w(e);t=I(f,"DIV",{class:!0});var u=w(t);a.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var o;h(t,"class",s=(((o=n[96])==null?void 0:o.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),h(e,"class","flex flex-col justify-center -space-y-0.5")},m(o,f){V(o,e,f),p(e,t),a.m(t,null)},p(o,f){var u;i===(i=r(o,f))&&a?a.p(o,f):(a.d(1),a=i(o),a&&(a.c(),a.m(t,null))),f[0]&4096&&s!==(s=(((u=o[96])==null?void 0:u.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&h(t,"class",s)},i:Me,o:Me,d(o){o&&m(e),a.d()}}}function jo(n){let e,t,l=n[28].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:n[96].query})+"",s,r;return{c(){e=y("div"),t=y("div"),s=W(l),this.h()},l(i){e=I(i,"DIV",{class:!0});var a=w(e);t=I(a,"DIV",{class:!0});var o=w(t);s=q(o,l),o.forEach(m),a.forEach(m),this.h()},h(){var i;h(t,"class",r=(((i=n[96])==null?void 0:i.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),h(e,"class","flex flex-col justify-center -space-y-0.5")},m(i,a){V(i,e,a),p(e,t),p(t,s)},p(i,a){var o;a[0]&268439552&&l!==(l=i[28].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:i[96].query})+"")&&K(s,l),a[0]&4096&&r!==(r=(((o=i[96])==null?void 0:o.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&h(t,"class",r)},i:Me,o:Me,d(i){i&&m(e)}}}function zo(n){let e,t;return e=new Ei({props:{status:n[96],$$slots:{default:[Yo]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&4096&&(r.status=l[96]),s[0]&268439552|s[3]&16&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Uo(n){var l;let e=((l=n[96])==null?void 0:l.description)+"",t;return{c(){t=W(e)},l(s){t=q(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r[0]&4096&&e!==(e=((i=s[96])==null?void 0:i.description)+"")&&K(t,e)},d(s){s&&m(t)}}}function Wo(n){let e=n[28].t("Searching the web...")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("Searching the web...")+"")&&K(t,e)},d(l){l&&m(t)}}}function qo(n){let e=n[28].t("Generating search query")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("Generating search query")+"")&&K(t,e)},d(l){l&&m(t)}}}function Fo(n){let e=n[28].t("No search query generated")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("No search query generated")+"")&&K(t,e)},d(l){l&&m(t)}}}function Jo(n){var l,s;let e=n[28].t((l=n[96])==null?void 0:l.description,{searchQuery:(s=n[96])==null?void 0:s.query})+"",t;return{c(){t=W(e)},l(r){t=q(r,e)},m(r,i){V(r,t,i)},p(r,i){var a,o;i[0]&268439552&&e!==(e=r[28].t((a=r[96])==null?void 0:a.description,{searchQuery:(o=r[96])==null?void 0:o.query})+"")&&K(t,e)},d(r){r&&m(t)}}}function Go(n){var l;let e=((l=n[96])==null?void 0:l.description)+"",t;return{c(){t=W(e)},l(s){t=q(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r[0]&4096&&e!==(e=((i=s[96])==null?void 0:i.description)+"")&&K(t,e)},d(s){s&&m(t)}}}function Ko(n){let e=n[28].t("Generating search query")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("Generating search query")+"")&&K(t,e)},d(l){l&&m(t)}}}function Zo(n){let e=n[28].t("No search query generated")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("No search query generated")+"")&&K(t,e)},d(l){l&&m(t)}}}function Qo(n){var l,s;let e=n[28].t((l=n[96])==null?void 0:l.description,{count:(s=n[96])==null?void 0:s.urls.length})+"",t;return{c(){t=W(e)},l(r){t=q(r,e)},m(r,i){V(r,t,i)},p(r,i){var a,o;i[0]&268439552&&e!==(e=r[28].t((a=r[96])==null?void 0:a.description,{count:(o=r[96])==null?void 0:o.urls.length})+"")&&K(t,e)},d(r){r&&m(t)}}}function Yo(n){let e,t,l,s;function r(o,f){var u,d,g;return f[0]&4096&&(l=null),l==null&&(l=!!((u=o[96])!=null&&u.description.includes("{{count}}"))),l?Qo:((d=o[96])==null?void 0:d.description)==="No search query generated"?Zo:((g=o[96])==null?void 0:g.description)==="Generating search query"?Ko:Go}let i=r(n,[-1,-1,-1,-1]),a=i(n);return{c(){e=y("div"),t=y("div"),a.c(),this.h()},l(o){e=I(o,"DIV",{class:!0});var f=w(e);t=I(f,"DIV",{class:!0});var u=w(t);a.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var o;h(t,"class",s=(((o=n[96])==null?void 0:o.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap"),h(e,"class","flex flex-col justify-center -space-y-0.5")},m(o,f){V(o,e,f),p(e,t),a.m(t,null)},p(o,f){var u;i===(i=r(o,f))&&a?a.p(o,f):(a.d(1),a=i(o),a&&(a.c(),a.m(t,null))),f[0]&4096&&s!==(s=(((u=o[96])==null?void 0:u.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap")&&h(t,"class",s)},d(o){o&&m(e),a.d()}}}function ms(n){let e,t,l=De(n[12].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=gs(us(n,l,i));const r=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=y("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=I(i,"DIV",{class:!0});var a=w(e);for(let o=0;o<s.length;o+=1)s[o].l(a);a.forEach(m),this.h()},h(){h(e,"class","my-1 w-full flex overflow-x-auto gap-2 flex-wrap")},m(i,a){V(i,e,a);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(e,null);t=!0},p(i,a){if(a[0]&4096){l=De(i[12].files);let o;for(o=0;o<l.length;o+=1){const f=us(i,l,o);s[o]?(s[o].p(f,a),b(s[o],1)):(s[o]=gs(f),s[o].c(),b(s[o],1),s[o].m(e,null))}for(se(),o=l.length;o<s.length;o+=1)r(o);ne()}},i(i){if(!t){for(let a=0;a<l.length;a+=1)b(s[a]);t=!0}},o(i){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)D(s[a]);t=!1},d(i){i&&m(e),Ge(s,i)}}}function Xo(n){var l;let e,t;return e=new Xt({props:{item:n[93],url:n[93].url,name:n[93].name,type:n[93].type,size:(l=n[93])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){x(e.$$.fragment)},l(s){ee(e.$$.fragment,s)},m(s,r){te(e,s,r),t=!0},p(s,r){var a;const i={};r[0]&4096&&(i.item=s[93]),r[0]&4096&&(i.url=s[93].url),r[0]&4096&&(i.name=s[93].name),r[0]&4096&&(i.type=s[93].type),r[0]&4096&&(i.size=(a=s[93])==null?void 0:a.size),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function $o(n){let e,t;return e=new Zt({props:{src:n[93].url,alt:n[12].content}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&4096&&(r.src=l[93].url),s[0]&4096&&(r.alt=l[12].content),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function gs(n){let e,t,l,s,r;const i=[$o,Xo],a=[];function o(f,u){return f[93].type==="image"?0:1}return t=o(n),l=a[t]=i[t](n),{c(){e=y("div"),l.c(),s=H()},l(f){e=I(f,"DIV",{});var u=w(e);l.l(u),s=j(u),u.forEach(m)},m(f,u){V(f,e,u),a[t].m(e,null),p(e,s),r=!0},p(f,u){let d=t;t=o(f),t===d?a[t].p(f,u):(se(),D(a[d],1,1,()=>{a[d]=null}),ne(),l=a[t],l?l.p(f,u):(l=a[t]=i[t](f),l.c()),b(l,1),l.m(e,s))},i(f){r||(b(l),r=!0)},o(f){D(l),r=!1},d(f){f&&m(e),a[t].d()}}}function xo(n){var _,v,M,E,C,R,L;let e,t,l,s,r,i,a;const o=[la,ta],f=[];function u(O,k){var N,S,B;return O[12].content===""&&!O[12].error&&(((N=O[12])==null?void 0:N.statusHistory)??[...(S=O[12])!=null&&S.status?[(B=O[12])==null?void 0:B.status]:[]]).length===0?0:O[12].content&&O[12].error!==!0?1:-1}~(t=u(n))&&(l=f[t]=o[t](n));let d=((_=n[12])==null?void 0:_.error)&&_s(n),g=(((v=n[12])==null?void 0:v.sources)||((M=n[12])==null?void 0:M.citations))&&(((L=(R=(C=(E=n[17])==null?void 0:E.info)==null?void 0:C.meta)==null?void 0:R.capabilities)==null?void 0:L.citations)??!0)&&ps(n),c=n[12].code_executions&&bs(n);return{c(){e=y("div"),l&&l.c(),s=H(),d&&d.c(),r=H(),g&&g.c(),i=H(),c&&c.c(),this.h()},l(O){e=I(O,"DIV",{class:!0,id:!0});var k=w(e);l&&l.l(k),s=j(k),d&&d.l(k),r=j(k),g&&g.l(k),i=j(k),c&&c.l(k),k.forEach(m),this.h()},h(){h(e,"class","w-full flex flex-col relative"),h(e,"id","response-content-container")},m(O,k){V(O,e,k),~t&&f[t].m(e,null),p(e,s),d&&d.m(e,null),p(e,r),g&&g.m(e,null),p(e,i),c&&c.m(e,null),a=!0},p(O,k){var S,B,T,P,Q,F,re;let N=t;t=u(O),t===N?~t&&f[t].p(O,k):(l&&(se(),D(f[N],1,1,()=>{f[N]=null}),ne()),~t?(l=f[t],l?l.p(O,k):(l=f[t]=o[t](O),l.c()),b(l,1),l.m(e,s)):l=null),(S=O[12])!=null&&S.error?d?(d.p(O,k),k[0]&4096&&b(d,1)):(d=_s(O),d.c(),b(d,1),d.m(e,r)):d&&(se(),D(d,1,1,()=>{d=null}),ne()),((B=O[12])!=null&&B.sources||(T=O[12])!=null&&T.citations)&&(((re=(F=(Q=(P=O[17])==null?void 0:P.info)==null?void 0:Q.meta)==null?void 0:F.capabilities)==null?void 0:re.citations)??!0)?g?(g.p(O,k),k[0]&135168&&b(g,1)):(g=ps(O),g.c(),b(g,1),g.m(e,i)):g&&(se(),D(g,1,1,()=>{g=null}),ne()),O[12].code_executions?c?(c.p(O,k),k[0]&4096&&b(c,1)):(c=bs(O),c.c(),b(c,1),c.m(e,null)):c&&(se(),D(c,1,1,()=>{c=null}),ne())},i(O){a||(b(l),b(d),b(g),b(c),a=!0)},o(O){D(l),D(d),D(g),D(c),a=!1},d(O){O&&m(e),~t&&f[t].d(),d&&d.d(),g&&g.d(),c&&c.d()}}}function ea(n){let e,t,l,s,r,i,a,o=n[28].t("Save As Copy")+"",f,u,d,g,c=n[28].t("Cancel")+"",_,v,M,E=n[28].t("Save")+"",C,R,L;return{c(){e=y("div"),t=y("textarea"),s=H(),r=y("div"),i=y("div"),a=y("button"),f=W(o),u=H(),d=y("div"),g=y("button"),_=W(c),v=H(),M=y("button"),C=W(E),this.h()},l(O){e=I(O,"DIV",{class:!0});var k=w(e);t=I(k,"TEXTAREA",{id:!0,class:!0}),w(t).forEach(m),s=j(k),r=I(k,"DIV",{class:!0});var N=w(r);i=I(N,"DIV",{});var S=w(i);a=I(S,"BUTTON",{id:!0,class:!0});var B=w(a);f=q(B,o),B.forEach(m),S.forEach(m),u=j(N),d=I(N,"DIV",{class:!0});var T=w(d);g=I(T,"BUTTON",{id:!0,class:!0});var P=w(g);_=q(P,c),P.forEach(m),v=j(T),M=I(T,"BUTTON",{id:!0,class:!0});var Q=w(M);C=q(Q,E),Q.forEach(m),T.forEach(m),N.forEach(m),k.forEach(m),this.h()},h(){h(t,"id",l="message-edit-"+n[12].id),h(t,"class","bg-transparent outline-hidden w-full resize-none"),h(a,"id","save-new-message-button"),h(a,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),h(g,"id","close-edit-message-button"),h(g,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),h(M,"id","confirm-edit-message-button"),h(M,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),h(d,"class","flex space-x-1.5"),h(r,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),h(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2")},m(O,k){V(O,e,k),p(e,t),n[53](t),ot(t,n[18]),p(e,s),p(e,r),p(r,i),p(i,a),p(a,f),p(r,u),p(r,d),p(d,g),p(g,_),p(d,v),p(d,M),p(M,C),R||(L=[de(t,"input",n[54]),de(t,"input",Ma),de(t,"keydown",n[55]),de(a,"click",n[56]),de(g,"click",n[57]),de(M,"click",n[58])],R=!0)},p(O,k){k[0]&4096&&l!==(l="message-edit-"+O[12].id)&&h(t,"id",l),k[0]&262144&&ot(t,O[18]),k[0]&268435456&&o!==(o=O[28].t("Save As Copy")+"")&&K(f,o),k[0]&268435456&&c!==(c=O[28].t("Cancel")+"")&&K(_,c),k[0]&268435456&&E!==(E=O[28].t("Save")+"")&&K(C,E)},i:Me,o:Me,d(O){O&&m(e),n[53](null),R=!1,$e(L)}}}function ta(n){var l;let e,t;return e=new Ro({props:{id:n[12].id,history:n[0],content:n[12].content,sources:n[12].sources,floatingButtons:((l=n[12])==null?void 0:l.done)&&!n[11],save:!n[11],preview:!n[11],model:n[17],onTaskClick:n[59],onSourceClick:n[60],onAddMessages:n[61],onSave:n[62]}}),{c(){x(e.$$.fragment)},l(s){ee(e.$$.fragment,s)},m(s,r){te(e,s,r),t=!0},p(s,r){var a;const i={};r[0]&4096&&(i.id=s[12].id),r[0]&1&&(i.history=s[0]),r[0]&4096&&(i.content=s[12].content),r[0]&4096&&(i.sources=s[12].sources),r[0]&6144&&(i.floatingButtons=((a=s[12])==null?void 0:a.done)&&!s[11]),r[0]&2048&&(i.save=!s[11]),r[0]&2048&&(i.preview=!s[11]),r[0]&131072&&(i.model=s[17]),r[0]&4096&&(i.onSourceClick=s[60]),r[0]&512&&(i.onAddMessages=s[61]),r[0]&4129&&(i.onSave=s[62]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function la(n){let e,t;return e=new $t({}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p:Me,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function _s(n){var l,s;let e,t;return e=new Vi({props:{content:((s=(l=n[12])==null?void 0:l.error)==null?void 0:s.content)??n[12].content}}),{c(){x(e.$$.fragment)},l(r){ee(e.$$.fragment,r)},m(r,i){te(e,r,i),t=!0},p(r,i){var o,f;const a={};i[0]&4096&&(a.content=((f=(o=r[12])==null?void 0:o.error)==null?void 0:f.content)??r[12].content),e.$set(a)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){le(e,r)}}}function ps(n){var l,s,r;let e,t;return e=new to({props:{id:(l=n[12])==null?void 0:l.id,sources:((s=n[12])==null?void 0:s.sources)??((r=n[12])==null?void 0:r.citations)}}),{c(){x(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,a){te(e,i,a),t=!0},p(i,a){var f,u,d;const o={};a[0]&4096&&(o.id=(f=i[12])==null?void 0:f.id),a[0]&4096&&(o.sources=((u=i[12])==null?void 0:u.sources)??((d=i[12])==null?void 0:d.citations)),e.$set(o)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){D(e.$$.fragment,i),t=!1},d(i){le(e,i)}}}function bs(n){let e,t;return e=new vo({props:{codeExecutions:n[12].code_executions}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&4096&&(r.codeExecutions=l[12].code_executions),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function vs(n){let e,t,l,s,r=(n[12].done||n[1].length>1)&&ks(n),i=n[12].done&&n[24]&&Rs(n);return{c(){e=y("div"),r&&r.c(),t=H(),i&&i.c(),l=fe(),this.h()},l(a){e=I(a,"DIV",{class:!0});var o=w(e);r&&r.l(o),o.forEach(m),t=j(a),i&&i.l(a),l=fe(),this.h()},h(){h(e,"class","flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5 svelte-1u5gq5j")},m(a,o){V(a,e,o),r&&r.m(e,null),n[79](e),V(a,t,o),i&&i.m(a,o),V(a,l,o),s=!0},p(a,o){a[12].done||a[1].length>1?r?(r.p(a,o),o[0]&4098&&b(r,1)):(r=ks(a),r.c(),b(r,1),r.m(e,null)):r&&(se(),D(r,1,1,()=>{r=null}),ne()),a[12].done&&a[24]?i?(i.p(a,o),o[0]&16781312&&b(i,1)):(i=Rs(a),i.c(),b(i,1),i.m(l.parentNode,l)):i&&(se(),D(i,1,1,()=>{i=null}),ne())},i(a){s||(b(r),b(i),s=!0)},o(a){D(r),D(i),s=!1},d(a){a&&(m(e),m(t),m(l)),r&&r.d(),n[79](null),i&&i.d(a)}}}function ks(n){let e,t,l,s=n[1].length>1&&ws(n),r=n[12].done&&ys(n);return{c(){s&&s.c(),e=H(),r&&r.c(),t=fe()},l(i){s&&s.l(i),e=j(i),r&&r.l(i),t=fe()},m(i,a){s&&s.m(i,a),V(i,e,a),r&&r.m(i,a),V(i,t,a),l=!0},p(i,a){i[1].length>1?s?s.p(i,a):(s=ws(i),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),i[12].done?r?(r.p(i,a),a[0]&4096&&b(r,1)):(r=ys(i),r.c(),b(r,1),r.m(t.parentNode,t)):r&&(se(),D(r,1,1,()=>{r=null}),ne())},i(i){l||(b(r),l=!0)},o(i){D(r),l=!1},d(i){i&&(m(e),m(t)),s&&s.d(i),r&&r.d(i)}}}function ws(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,a='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',o,f;function u(c,_){return c[20]?na:sa}let d=u(n),g=d(n);return{c(){e=y("div"),t=y("button"),t.innerHTML=l,s=H(),g.c(),r=H(),i=y("button"),i.innerHTML=a,this.h()},l(c){e=I(c,"DIV",{class:!0,dir:!0});var _=w(e);t=I(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(t)!=="svelte-1e0chv1"&&(t.innerHTML=l),s=j(_),g.l(_),r=j(_),i=I(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(i)!=="svelte-107ksnk"&&(i.innerHTML=a),_.forEach(m),this.h()},h(){h(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(e,"class","flex self-center min-w-fit"),h(e,"dir","ltr")},m(c,_){V(c,e,_),p(e,t),p(e,s),g.m(e,null),p(e,r),p(e,i),o||(f=[de(t,"click",n[63]),de(i,"click",n[67])],o=!0)},p(c,_){d===(d=u(c))&&g?g.p(c,_):(g.d(1),g=d(c),g&&(g.c(),g.m(e,r)))},d(c){c&&m(e),g.d(),o=!1,$e(f)}}}function sa(n){let e,t=n[1].indexOf(n[12].id)+1+"",l,s,r=n[1].length+"",i,a,o;return{c(){e=y("div"),l=W(t),s=W("/"),i=W(r),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=w(e);l=q(u,t),s=q(u,"/"),i=q(u,r),u.forEach(m),this.h()},h(){h(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){V(f,e,u),p(e,l),p(e,s),p(e,i),a||(o=de(e,"dblclick",n[66]),a=!0)},p(f,u){u[0]&4098&&t!==(t=f[1].indexOf(f[12].id)+1+"")&&K(l,t),u[0]&2&&r!==(r=f[1].length+"")&&K(i,r)},d(f){f&&m(e),a=!1,o()}}}function na(n){let e,t,l,s,r,i,a=n[1].length+"",o,f,u;return{c(){e=y("div"),t=y("input"),i=W("/"),o=W(a),this.h()},l(d){e=I(d,"DIV",{class:!0});var g=w(e);t=I(g,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=q(g,"/"),o=q(g,a),g.forEach(m),this.h()},h(){h(t,"id",l="message-index-input-"+n[12].id),h(t,"type","number"),t.value=s=n[1].indexOf(n[12].id)+1,h(t,"min","1"),h(t,"max",r=n[1].length),h(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),h(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(d,g){V(d,e,g),p(e,t),p(e,i),p(e,o),f||(u=[de(t,"focus",Ea),de(t,"blur",n[64]),de(t,"keydown",n[65])],f=!0)},p(d,g){g[0]&4096&&l!==(l="message-index-input-"+d[12].id)&&h(t,"id",l),g[0]&4098&&s!==(s=d[1].indexOf(d[12].id)+1)&&t.value!==s&&(t.value=s),g[0]&2&&r!==(r=d[1].length)&&h(t,"max",r),g[0]&2&&a!==(a=d[1].length+"")&&K(o,a)},d(d){d&&m(e),f=!1,$e(u)}}}function ys(n){var _,v,M,E,C,R,L,O,k;let e,t,l,s,r,i,a,o,f=!n[11]&&Is(n);t=new Oe({props:{content:n[28].t("Copy"),placement:"bottom",$$slots:{default:[ia]},$$scope:{ctx:n}}});let u=(((_=n[29])==null?void 0:_.role)==="admin"||(((E=(M=(v=n[29])==null?void 0:v.permissions)==null?void 0:M.chat)==null?void 0:E.tts)??!0))&&Es(n),d=((C=n[27])==null?void 0:C.features.enable_image_generation)&&(((R=n[29])==null?void 0:R.role)==="admin"||((k=(O=(L=n[29])==null?void 0:L.permissions)==null?void 0:O.features)==null?void 0:k.image_generation))&&!n[11]&&Ds(n),g=n[12].usage&&Ns(n),c=!n[11]&&Vs(n);return{c(){f&&f.c(),e=H(),x(t.$$.fragment),l=H(),u&&u.c(),s=H(),d&&d.c(),r=H(),g&&g.c(),i=H(),c&&c.c(),a=fe()},l(N){f&&f.l(N),e=j(N),ee(t.$$.fragment,N),l=j(N),u&&u.l(N),s=j(N),d&&d.l(N),r=j(N),g&&g.l(N),i=j(N),c&&c.l(N),a=fe()},m(N,S){f&&f.m(N,S),V(N,e,S),te(t,N,S),V(N,l,S),u&&u.m(N,S),V(N,s,S),d&&d.m(N,S),V(N,r,S),g&&g.m(N,S),V(N,i,S),c&&c.m(N,S),V(N,a,S),o=!0},p(N,S){var T,P,Q,F,re,Y,oe,he,ue;N[11]?f&&(se(),D(f,1,1,()=>{f=null}),ne()):f?(f.p(N,S),S[0]&2048&&b(f,1)):(f=Is(N),f.c(),b(f,1),f.m(e.parentNode,e));const B={};S[0]&268435456&&(B.content=N[28].t("Copy")),S[0]&5120|S[3]&16&&(B.$$scope={dirty:S,ctx:N}),t.$set(B),((T=N[29])==null?void 0:T.role)==="admin"||(((F=(Q=(P=N[29])==null?void 0:P.permissions)==null?void 0:Q.chat)==null?void 0:F.tts)??!0)?u?(u.p(N,S),S[0]&536870912&&b(u,1)):(u=Es(N),u.c(),b(u,1),u.m(s.parentNode,s)):u&&(se(),D(u,1,1,()=>{u=null}),ne()),(re=N[27])!=null&&re.features.enable_image_generation&&(((Y=N[29])==null?void 0:Y.role)==="admin"||(ue=(he=(oe=N[29])==null?void 0:oe.permissions)==null?void 0:he.features)!=null&&ue.image_generation)&&!N[11]?d?(d.p(N,S),S[0]&671090688&&b(d,1)):(d=Ds(N),d.c(),b(d,1),d.m(r.parentNode,r)):d&&(se(),D(d,1,1,()=>{d=null}),ne()),N[12].usage?g?(g.p(N,S),S[0]&4096&&b(g,1)):(g=Ns(N),g.c(),b(g,1),g.m(i.parentNode,i)):g&&(se(),D(g,1,1,()=>{g=null}),ne()),N[11]?c&&(se(),D(c,1,1,()=>{c=null}),ne()):c?(c.p(N,S),S[0]&2048&&b(c,1)):(c=Vs(N),c.c(),b(c,1),c.m(a.parentNode,a))},i(N){o||(b(f),b(t.$$.fragment,N),b(u),b(d),b(g),b(c),o=!0)},o(N){D(f),D(t.$$.fragment,N),D(u),D(d),D(g),D(c),o=!1},d(N){N&&(m(e),m(l),m(s),m(r),m(i),m(a)),f&&f.d(N),le(t,N),u&&u.d(N),d&&d.d(N),g&&g.d(N),c&&c.d(N)}}}function Is(n){var s,r,i,a;let e,t,l=(((s=n[29])==null?void 0:s.role)==="user"?((a=(i=(r=n[29])==null?void 0:r.permissions)==null?void 0:i.chat)==null?void 0:a.edit)??!0:!0)&&Ms(n);return{c(){l&&l.c(),e=fe()},l(o){l&&l.l(o),e=fe()},m(o,f){l&&l.m(o,f),V(o,e,f),t=!0},p(o,f){var u,d,g,c;((u=o[29])==null?void 0:u.role)!=="user"||(((c=(g=(d=o[29])==null?void 0:d.permissions)==null?void 0:g.chat)==null?void 0:c.edit)??!0)?l?(l.p(o,f),f[0]&536870912&&b(l,1)):(l=Ms(o),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(se(),D(l,1,1,()=>{l=null}),ne())},i(o){t||(b(l),t=!0)},o(o){D(l),t=!1},d(o){o&&m(e),l&&l.d(o)}}}function Ms(n){let e,t;return e=new Oe({props:{content:n[28].t("Edit"),placement:"bottom",$$slots:{default:[ra]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Edit")),s[0]&1024|s[3]&16&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ra(n){let e,t,l,s,r,i;return{c(){e=y("button"),t=ye("svg"),l=ye("path"),this.h()},l(a){e=I(a,"BUTTON",{class:!0});var o=w(e);t=Ie(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=w(t);l=Ie(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(a,o){V(a,e,o),p(e,t),p(t,l),r||(i=de(e,"click",n[68]),r=!0)},p(a,o){o[0]&1024&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&h(e,"class",s)},d(a){a&&m(e),r=!1,i()}}}function ia(n){let e,t,l,s,r,i;return{c(){e=y("button"),t=ye("svg"),l=ye("path"),this.h()},l(a){e=I(a,"BUTTON",{class:!0});var o=w(e);t=Ie(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=w(t);l=Ie(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")},m(a,o){V(a,e,o),p(e,t),p(t,l),r||(i=de(e,"click",n[69]),r=!0)},p(a,o){o[0]&1024&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")&&h(e,"class",s)},d(a){a&&m(e),r=!1,i()}}}function Es(n){let e,t;return e=new Oe({props:{content:n[28].t("Read Aloud"),placement:"bottom",$$slots:{default:[ua]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Read Aloud")),s[0]&6296576|s[3]&16&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function oa(n){let e,t;return{c(){e=ye("svg"),t=ye("path"),this.h()},l(l){e=Ie(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=Ie(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","2.3"),h(e,"stroke","currentColor"),h(e,"class","w-4 h-4")},m(l,s){V(l,e,s),p(e,t)},d(l){l&&m(e)}}}function aa(n){let e,t;return{c(){e=ye("svg"),t=ye("path"),this.h()},l(l){e=Ie(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=Ie(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","2.3"),h(e,"stroke","currentColor"),h(e,"class","w-4 h-4")},m(l,s){V(l,e,s),p(e,t)},d(l){l&&m(e)}}}function fa(n){let e,t,l,s,r,i;return{c(){e=ye("svg"),t=ye("style"),l=W(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=ye("circle"),r=ye("circle"),i=ye("circle"),this.h()},l(a){e=Ie(a,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var o=w(e);t=Ie(o,"style",{});var f=w(t);l=q(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(m),s=Ie(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(s).forEach(m),r=Ie(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(r).forEach(m),i=Ie(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(i).forEach(m),o.forEach(m),this.h()},h(){h(s,"class","spinner_S1WN"),h(s,"cx","4"),h(s,"cy","12"),h(s,"r","3"),h(r,"class","spinner_S1WN spinner_Km9P"),h(r,"cx","12"),h(r,"cy","12"),h(r,"r","3"),h(i,"class","spinner_S1WN spinner_JApP"),h(i,"cx","20"),h(i,"cy","12"),h(i,"r","3"),h(e,"class","w-4 h-4"),h(e,"fill","currentColor"),h(e,"viewBox","0 0 24 24"),h(e,"xmlns","http://www.w3.org/2000/svg")},m(a,o){V(a,e,o),p(e,t),p(t,l),p(e,s),p(e,r),p(e,i)},d(a){a&&m(e)}}}function ua(n){let e,t,l,s,r;function i(f,u){return f[22]?fa:f[21]?aa:oa}let a=i(n),o=a(n);return{c(){e=y("button"),o.c(),this.h()},l(f){e=I(f,"BUTTON",{id:!0,class:!0});var u=w(e);o.l(u),u.forEach(m),this.h()},h(){h(e,"id",t="speak-button-"+n[12].id),h(e,"class",l=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(f,u){V(f,e,u),o.m(e,null),s||(r=de(e,"click",n[70]),s=!0)},p(f,u){a!==(a=i(f))&&(o.d(1),o=a(f),o&&(o.c(),o.m(e,null))),u[0]&4096&&t!==(t="speak-button-"+f[12].id)&&h(e,"id",t),u[0]&1024&&l!==(l=(f[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&h(e,"class",l)},d(f){f&&m(e),o.d(),s=!1,r()}}}function Ds(n){let e,t;return e=new Oe({props:{content:n[28].t("Generate Image"),placement:"bottom",$$slots:{default:[ha]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Generate Image")),s[0]&8393728|s[3]&16&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ca(n){let e,t;return{c(){e=ye("svg"),t=ye("path"),this.h()},l(l){e=Ie(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=Ie(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","2.3"),h(e,"stroke","currentColor"),h(e,"class","w-4 h-4")},m(l,s){V(l,e,s),p(e,t)},d(l){l&&m(e)}}}function da(n){let e,t,l,s,r,i;return{c(){e=ye("svg"),t=ye("style"),l=W(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=ye("circle"),r=ye("circle"),i=ye("circle"),this.h()},l(a){e=Ie(a,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var o=w(e);t=Ie(o,"style",{});var f=w(t);l=q(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(m),s=Ie(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(s).forEach(m),r=Ie(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(r).forEach(m),i=Ie(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(i).forEach(m),o.forEach(m),this.h()},h(){h(s,"class","spinner_S1WN"),h(s,"cx","4"),h(s,"cy","12"),h(s,"r","3"),h(r,"class","spinner_S1WN spinner_Km9P"),h(r,"cx","12"),h(r,"cy","12"),h(r,"r","3"),h(i,"class","spinner_S1WN spinner_JApP"),h(i,"cx","20"),h(i,"cy","12"),h(i,"r","3"),h(e,"class","w-4 h-4"),h(e,"fill","currentColor"),h(e,"viewBox","0 0 24 24"),h(e,"xmlns","http://www.w3.org/2000/svg")},m(a,o){V(a,e,o),p(e,t),p(t,l),p(e,s),p(e,r),p(e,i)},d(a){a&&m(e)}}}function ha(n){let e,t,l,s;function r(o,f){return o[23]?da:ca}let i=r(n),a=i(n);return{c(){e=y("button"),a.c(),this.h()},l(o){e=I(o,"BUTTON",{class:!0});var f=w(e);a.l(f),f.forEach(m),this.h()},h(){h(e,"class",t=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(o,f){V(o,e,f),a.m(e,null),l||(s=de(e,"click",n[71]),l=!0)},p(o,f){i!==(i=r(o))&&(a.d(1),a=i(o),a&&(a.c(),a.m(e,null))),f[0]&1024&&t!==(t=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&h(e,"class",t)},d(o){o&&m(e),a.d(),l=!1,s()}}}function Ns(n){let e,t;return e=new Oe({props:{content:n[12].usage?`<pre>${bt(JSON.stringify(n[12].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(As).map(Hs).join(`
`))}</pre>`:"",placement:"bottom",$$slots:{default:[ma]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&4096&&(r.content=l[12].usage?`<pre>${bt(JSON.stringify(l[12].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(As).map(Hs).join(`
`))}</pre>`:""),s[0]&5120|s[3]&16&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ma(n){let e,t,l,s,r,i,a;return{c(){e=y("button"),t=ye("svg"),l=ye("path"),this.h()},l(o){e=I(o,"BUTTON",{class:!0,id:!0});var f=w(e);t=Ie(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=w(t);l=Ie(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap"),h(e,"id",r="info-"+n[12].id)},m(o,f){V(o,e,f),p(e,t),p(t,l),i||(a=de(e,"click",n[72]),i=!0)},p(o,f){f[0]&1024&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap")&&h(e,"class",s),f[0]&4096&&r!==(r="info-"+o[12].id)&&h(e,"id",r)},d(o){o&&m(e),i=!1,a()}}}function Vs(n){var g;let e,t,l,s,r,i,a,o=!n[30]&&(((g=n[27])==null?void 0:g.features.enable_message_rating)??!0)&&Cs(n),f=n[10]&&Ts(n);l=new Oe({props:{content:n[28].t("Regenerate"),placement:"bottom",$$slots:{default:[ba]},$$scope:{ctx:n}}});let u=n[1].length>1&&Bs(n),d=n[10]&&Ss(n);return{c(){o&&o.c(),e=H(),f&&f.c(),t=H(),x(l.$$.fragment),s=H(),u&&u.c(),r=H(),d&&d.c(),i=fe()},l(c){o&&o.l(c),e=j(c),f&&f.l(c),t=j(c),ee(l.$$.fragment,c),s=j(c),u&&u.l(c),r=j(c),d&&d.l(c),i=fe()},m(c,_){o&&o.m(c,_),V(c,e,_),f&&f.m(c,_),V(c,t,_),te(l,c,_),V(c,s,_),u&&u.m(c,_),V(c,r,_),d&&d.m(c,_),V(c,i,_),a=!0},p(c,_){var M;!c[30]&&(((M=c[27])==null?void 0:M.features.enable_message_rating)??!0)?o?(o.p(c,_),_[0]&1207959552&&b(o,1)):(o=Cs(c),o.c(),b(o,1),o.m(e.parentNode,e)):o&&(se(),D(o,1,1,()=>{o=null}),ne()),c[10]?f?(f.p(c,_),_[0]&1024&&b(f,1)):(f=Ts(c),f.c(),b(f,1),f.m(t.parentNode,t)):f&&(se(),D(f,1,1,()=>{f=null}),ne());const v={};_[0]&268435456&&(v.content=c[28].t("Regenerate")),_[0]&16913664|_[3]&16&&(v.$$scope={dirty:_,ctx:c}),l.$set(v),c[1].length>1?u?(u.p(c,_),_[0]&2&&b(u,1)):(u=Bs(c),u.c(),b(u,1),u.m(r.parentNode,r)):u&&(se(),D(u,1,1,()=>{u=null}),ne()),c[10]?d?(d.p(c,_),_[0]&1024&&b(d,1)):(d=Ss(c),d.c(),b(d,1),d.m(i.parentNode,i)):d&&(se(),D(d,1,1,()=>{d=null}),ne())},i(c){a||(b(o),b(f),b(l.$$.fragment,c),b(u),b(d),a=!0)},o(c){D(o),D(f),D(l.$$.fragment,c),D(u),D(d),a=!1},d(c){c&&(m(e),m(t),m(s),m(r),m(i)),o&&o.d(c),f&&f.d(c),le(l,c),u&&u.d(c),d&&d.d(c)}}}function Cs(n){let e,t,l,s;return e=new Oe({props:{content:n[28].t("Good Response"),placement:"bottom",$$slots:{default:[ga]},$$scope:{ctx:n}}}),l=new Oe({props:{content:n[28].t("Bad Response"),placement:"bottom",$$slots:{default:[_a]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment),t=H(),x(l.$$.fragment)},l(r){ee(e.$$.fragment,r),t=j(r),ee(l.$$.fragment,r)},m(r,i){te(e,r,i),V(r,t,i),te(l,r,i),s=!0},p(r,i){const a={};i[0]&268435456&&(a.content=r[28].t("Good Response")),i[0]&33559552|i[3]&16&&(a.$$scope={dirty:i,ctx:r}),e.$set(a);const o={};i[0]&268435456&&(o.content=r[28].t("Bad Response")),i[0]&33559552|i[3]&16&&(o.$$scope={dirty:i,ctx:r}),l.$set(o)},i(r){s||(b(e.$$.fragment,r),b(l.$$.fragment,r),s=!0)},o(r){D(e.$$.fragment,r),D(l.$$.fragment,r),s=!1},d(r){r&&m(t),le(e,r),le(l,r)}}}function ga(n){let e,t,l,s,r,i;return{c(){e=y("button"),t=ye("svg"),l=ye("path"),this.h()},l(a){e=I(a,"BUTTON",{class:!0});var o=w(e);t=Ie(o,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=w(t);l=Ie(f,"path",{d:!0}),w(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){var a,o;h(l,"d","M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"),h(t,"stroke","currentColor"),h(t,"fill","none"),h(t,"stroke-width","2.3"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"class","w-4 h-4"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((o=(a=n[12])==null?void 0:a.annotation)==null?void 0:o.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[25]},m(a,o){V(a,e,o),p(e,t),p(t,l),r||(i=de(e,"click",n[73]),r=!0)},p(a,o){var f,u;o[0]&5120&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=a[12])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&h(e,"class",s),o[0]&33554432&&(e.disabled=a[25])},d(a){a&&m(e),r=!1,i()}}}function _a(n){let e,t,l,s,r,i;return{c(){e=y("button"),t=ye("svg"),l=ye("path"),this.h()},l(a){e=I(a,"BUTTON",{class:!0});var o=w(e);t=Ie(o,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=w(t);l=Ie(f,"path",{d:!0}),w(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){var a,o;h(l,"d","M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"),h(t,"stroke","currentColor"),h(t,"fill","none"),h(t,"stroke-width","2.3"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"class","w-4 h-4"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((o=(a=n[12])==null?void 0:a.annotation)==null?void 0:o.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[25]},m(a,o){V(a,e,o),p(e,t),p(t,l),r||(i=de(e,"click",n[74]),r=!0)},p(a,o){var f,u;o[0]&5120&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=a[12])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&h(e,"class",s),o[0]&33554432&&(e.disabled=a[25])},d(a){a&&m(e),r=!1,i()}}}function Ts(n){let e,t;return e=new Oe({props:{content:n[28].t("Continue Response"),placement:"bottom",$$slots:{default:[pa]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Continue Response")),s[0]&1152|s[3]&16&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function pa(n){let e,t,l,s,r,i,a;return{c(){e=y("button"),t=ye("svg"),l=ye("path"),s=ye("path"),this.h()},l(o){e=I(o,"BUTTON",{type:!0,id:!0,class:!0});var f=w(e);t=Ie(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=w(t);l=Ie(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(m),s=Ie(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(s).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),h(s,"stroke-linecap","round"),h(s,"stroke-linejoin","round"),h(s,"d","M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"type","button"),h(e,"id","continue-response-button"),h(e,"class",r=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(o,f){V(o,e,f),p(e,t),p(t,l),p(t,s),i||(a=de(e,"click",n[75]),i=!0)},p(o,f){f[0]&1024&&r!==(r=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&h(e,"class",r)},d(o){o&&m(e),i=!1,a()}}}function ba(n){let e,t,l,s,r,i;return{c(){e=y("button"),t=ye("svg"),l=ye("path"),this.h()},l(a){e=I(a,"BUTTON",{type:!0,class:!0});var o=w(e);t=Ie(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=w(t);l=Ie(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"type","button"),h(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,o){V(a,e,o),p(e,t),p(t,l),r||(i=de(e,"click",n[76]),r=!0)},p(a,o){o[0]&1024&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&h(e,"class",s)},d(a){a&&m(e),r=!1,i()}}}function Bs(n){let e,t;return e=new Oe({props:{content:n[28].t("Delete"),placement:"bottom",$$slots:{default:[va]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Delete")),s[0]&66560|s[3]&16&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function va(n){let e,t,l,s,r,i;return{c(){e=y("button"),t=ye("svg"),l=ye("path"),this.h()},l(a){e=I(a,"BUTTON",{type:!0,id:!0,class:!0});var o=w(e);t=Ie(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=w(t);l=Ie(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"type","button"),h(e,"id","delete-response-button"),h(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,o){V(a,e,o),p(e,t),p(t,l),r||(i=de(e,"click",n[77]),r=!0)},p(a,o){o[0]&1024&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&h(e,"class",s)},d(a){a&&m(e),r=!1,i()}}}function Ss(n){var i;let e,t,l=De(((i=n[17])==null?void 0:i.actions)??[]),s=[];for(let a=0;a<l.length;a+=1)s[a]=Os(fs(n,l,a));const r=a=>D(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=fe()},l(a){for(let o=0;o<s.length;o+=1)s[o].l(a);e=fe()},m(a,o){for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(a,o);V(a,e,o),t=!0},p(a,o){var f;if(o[0]&136256){l=De(((f=a[17])==null?void 0:f.actions)??[]);let u;for(u=0;u<l.length;u+=1){const d=fs(a,l,u);s[u]?(s[u].p(d,o),b(s[u],1)):(s[u]=Os(d),s[u].c(),b(s[u],1),s[u].m(e.parentNode,e))}for(se(),u=l.length;u<s.length;u+=1)r(u);ne()}},i(a){if(!t){for(let o=0;o<l.length;o+=1)b(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)D(s[o]);t=!1},d(a){a&&m(e),Ge(s,a)}}}function ka(n){let e,t;return e=new Fr({props:{strokeWidth:"2.1",className:"size-4"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p:Me,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function wa(n){let e,t,l,s,r;return{c(){e=y("div"),t=y("img"),this.h()},l(i){e=I(i,"DIV",{class:!0});var a=w(e);t=I(a,"IMG",{src:!0,class:!0,style:!0,alt:!0}),a.forEach(m),this.h()},h(){Lt(t.src,l=n[90].icon)||h(t,"src",l),h(t,"class",s="w-4 h-4 "+(n[90].icon.includes("svg")?"dark:invert-[80%]":"")),Rt(t,"fill","currentColor"),h(t,"alt",r=n[90].name),h(e,"class","size-4")},m(i,a){V(i,e,a),p(e,t)},p(i,a){a[0]&131072&&!Lt(t.src,l=i[90].icon)&&h(t,"src",l),a[0]&131072&&s!==(s="w-4 h-4 "+(i[90].icon.includes("svg")?"dark:invert-[80%]":""))&&h(t,"class",s),a[0]&131072&&r!==(r=i[90].name)&&h(t,"alt",r)},i:Me,o:Me,d(i){i&&m(e)}}}function ya(n){let e,t,l,s,r,i,a,o;const f=[wa,ka],u=[];function d(c,_){var v;return(v=c[90])!=null&&v.icon?0:1}t=d(n),l=u[t]=f[t](n);function g(){return n[78](n[90])}return{c(){e=y("button"),l.c(),r=H(),this.h()},l(c){e=I(c,"BUTTON",{type:!0,class:!0});var _=w(e);l.l(_),_.forEach(m),r=j(c),this.h()},h(){h(e,"type","button"),h(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(c,_){V(c,e,_),u[t].m(e,null),V(c,r,_),i=!0,a||(o=de(e,"click",g),a=!0)},p(c,_){n=c;let v=t;t=d(n),t===v?u[t].p(n,_):(se(),D(u[v],1,1,()=>{u[v]=null}),ne(),l=u[t],l?l.p(n,_):(l=u[t]=f[t](n),l.c()),b(l,1),l.m(e,null)),(!i||_[0]&1024&&s!==(s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition"))&&h(e,"class",s)},i(c){i||(b(l),i=!0)},o(c){D(l),i=!1},d(c){c&&(m(e),m(r)),u[t].d(),a=!1,o()}}}function Os(n){let e,t;return e=new Oe({props:{content:n[90].name,placement:"bottom",$$slots:{default:[ya]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&131072&&(r.content=l[90].name),s[0]&136256|s[3]&16&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Rs(n){let e,t,l,s;function r(o){n[80](o)}function i(o){n[81](o)}let a={};return n[12]!==void 0&&(a.message=n[12]),n[24]!==void 0&&(a.show=n[24]),e=new bi({props:a}),je.push(()=>Xe(e,"message",r)),je.push(()=>Xe(e,"show",i)),e.$on("save",n[82]),{c(){x(e.$$.fragment)},l(o){ee(e.$$.fragment,o)},m(o,f){te(e,o,f),s=!0},p(o,f){const u={};!t&&f[0]&4096&&(t=!0,u.message=o[12],Ye(()=>t=!1)),!l&&f[0]&16777216&&(l=!0,u.show=o[24],Ye(()=>l=!1)),e.$set(u)},i(o){s||(b(e.$$.fragment,o),s=!0)},o(o){D(e.$$.fragment,o),s=!1},d(o){le(e,o)}}}function Ls(n){var Q,F,re,Y,oe,he,ue,ke;let e,t,l,s,r,i,a,o,f,u,d,g=((Q=n[12])==null?void 0:Q.files)&&((F=n[12].files)==null?void 0:F.filter(Ps).length)>0,c,_,v,M,E,C,R,L,O;l=new Pn({props:{src:((oe=(Y=(re=n[17])==null?void 0:re.info)==null?void 0:Y.meta)==null?void 0:oe.profile_image_url)??(n[28].language==="dg-DG"?"/doge.png":`${Pt}/static/favicon.png`),className:"size-8"}}),i=new Kt({props:{$$slots:{default:[Ao]},$$scope:{ctx:n}}});let k=(((he=n[12])==null?void 0:he.statusHistory)??[...(ue=n[12])!=null&&ue.status?[(ke=n[12])==null?void 0:ke.status]:[]]).length>0&&ds(Ut(n)),N=g&&ms(n);const S=[ea,xo],B=[];function T(U,Z){return U[13]===!0?0:1}_=T(n),v=B[_]=S[_](n);let P=!n[13]&&vs(n);return{c(){e=y("div"),t=y("div"),x(l.$$.fragment),s=H(),r=y("div"),x(i.$$.fragment),a=H(),o=y("div"),f=y("div"),u=y("div"),k&&k.c(),d=H(),N&&N.c(),c=H(),v.c(),E=H(),P&&P.c(),this.h()},l(U){e=I(U,"DIV",{class:!0,id:!0,dir:!0});var Z=w(e);t=I(Z,"DIV",{class:!0});var ge=w(t);ee(l.$$.fragment,ge),ge.forEach(m),s=j(Z),r=I(Z,"DIV",{class:!0});var pe=w(r);ee(i.$$.fragment,pe),a=j(pe),o=I(pe,"DIV",{});var _e=w(o);f=I(_e,"DIV",{class:!0});var J=w(f);u=I(J,"DIV",{});var me=w(u);k&&k.l(me),d=j(me),N&&N.l(me),c=j(me),v.l(me),me.forEach(m),J.forEach(m),E=j(_e),P&&P.l(_e),_e.forEach(m),pe.forEach(m),Z.forEach(m),this.h()},h(){h(t,"class",kr("shrink-0 ltr:mr-3 rtl:ml-3")+" svelte-1u5gq5j"),h(f,"class",M="chat-"+n[12].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"),h(r,"class","flex-auto w-0 pl-1"),h(e,"class",C="flex w-full message-"+n[12].id+" svelte-1u5gq5j"),h(e,"id",R="message-"+n[12].id),h(e,"dir",L=n[26].chatDirection)},m(U,Z){V(U,e,Z),p(e,t),te(l,t,null),p(e,s),p(e,r),te(i,r,null),p(r,a),p(r,o),p(o,f),p(f,u),k&&k.m(u,null),p(u,d),N&&N.m(u,null),p(u,c),B[_].m(u,null),p(o,E),P&&P.m(o,null),O=!0},p(U,Z){var J,me,ae,be,A,G,$,X;const ge={};Z[0]&268566528&&(ge.src=((ae=(me=(J=U[17])==null?void 0:J.info)==null?void 0:me.meta)==null?void 0:ae.profile_image_url)??(U[28].language==="dg-DG"?"/doge.png":`${Pt}/static/favicon.png`)),l.$set(ge);const pe={};Z[0]&135168|Z[3]&16&&(pe.$$scope={dirty:Z,ctx:U}),i.$set(pe),(((be=U[12])==null?void 0:be.statusHistory)??[...(A=U[12])!=null&&A.status?[(G=U[12])==null?void 0:G.status]:[]]).length>0?k?(k.p(Ut(U),Z),Z[0]&4096&&b(k,1)):(k=ds(Ut(U)),k.c(),b(k,1),k.m(u,d)):k&&(se(),D(k,1,1,()=>{k=null}),ne()),Z[0]&4096&&(g=(($=U[12])==null?void 0:$.files)&&((X=U[12].files)==null?void 0:X.filter(Ps).length)>0),g?N?(N.p(U,Z),Z[0]&4096&&b(N,1)):(N=ms(U),N.c(),b(N,1),N.m(u,c)):N&&(se(),D(N,1,1,()=>{N=null}),ne());let _e=_;_=T(U),_===_e?B[_].p(U,Z):(se(),D(B[_e],1,1,()=>{B[_e]=null}),ne(),v=B[_],v?v.p(U,Z):(v=B[_]=S[_](U),v.c()),b(v,1),v.m(u,null)),(!O||Z[0]&4096&&M!==(M="chat-"+U[12].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"))&&h(f,"class",M),U[13]?P&&(se(),D(P,1,1,()=>{P=null}),ne()):P?(P.p(U,Z),Z[0]&8192&&b(P,1)):(P=vs(U),P.c(),b(P,1),P.m(o,null)),(!O||Z[0]&4096&&C!==(C="flex w-full message-"+U[12].id+" svelte-1u5gq5j"))&&h(e,"class",C),(!O||Z[0]&4096&&R!==(R="message-"+U[12].id))&&h(e,"id",R),(!O||Z[0]&67108864&&L!==(L=U[26].chatDirection))&&h(e,"dir",L)},i(U){O||(b(l.$$.fragment,U),b(i.$$.fragment,U),b(k),b(N),b(v),b(P),O=!0)},o(U){D(l.$$.fragment,U),D(i.$$.fragment,U),D(k),D(N),D(v),D(P),O=!1},d(U){U&&m(e),le(l),le(i),k&&k.d(),N&&N.d(),B[_].d(),P&&P.d()}}}function Ia(n){let e,t,l,s,r=(n[12].done?n[12].content:"")+"",i,a,o=n[12].id,f,u;function d(_){n[50](_)}let g={title:n[28].t("Delete message?")};n[16]!==void 0&&(g.show=n[16]),e=new zn({props:g}),je.push(()=>Xe(e,"show",d)),e.$on("confirm",n[51]);let c=Ls(n);return{c(){x(e.$$.fragment),l=H(),s=y("div"),i=W(r),a=H(),c.c(),f=fe(),this.h()},l(_){ee(e.$$.fragment,_),l=j(_),s=I(_,"DIV",{"aria-live":!0,class:!0});var v=w(s);i=q(v,r),v.forEach(m),a=j(_),c.l(_),f=fe(),this.h()},h(){h(s,"aria-live","polite"),h(s,"class","sr-only")},m(_,v){te(e,_,v),V(_,l,v),V(_,s,v),p(s,i),n[52](s),V(_,a,v),c.m(_,v),V(_,f,v),u=!0},p(_,v){const M={};v[0]&268435456&&(M.title=_[28].t("Delete message?")),!t&&v[0]&65536&&(t=!0,M.show=_[16],Ye(()=>t=!1)),e.$set(M),(!u||v[0]&4096)&&r!==(r=(_[12].done?_[12].content:"")+"")&&K(i,r),v[0]&4096&&Be(o,o=_[12].id)?(se(),D(c,1,1,Me),ne(),c=Ls(_),c.c(),b(c,1),c.m(f.parentNode,f)):c.p(_,v)},i(_){u||(b(e.$$.fragment,_),b(c),u=!0)},o(_){D(e.$$.fragment,_),D(c),u=!1},d(_){_&&(m(l),m(s),m(a),m(f)),le(e,_),n[52](null),c.d(_)}}}const Ps=n=>n.type==="image",Ma=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},Ea=n=>{n.target.select()},As=n=>n.slice(2),Hs=n=>n.endsWith(",")?n.slice(0,-1):n;function Da(n,e,t){let l,s,r,i,a,o,f;Ee(n,jt,z=>t(49,l=z)),Ee(n,gt,z=>t(26,s=z)),Ee(n,On,z=>t(27,r=z)),Ee(n,gl,z=>t(86,i=z)),Ee(n,zt,z=>t(29,o=z)),Ee(n,Gt,z=>t(30,f=z));const u=Ke("i18n");Ee(n,u,z=>t(28,a=z));const d=vt();let{chatId:g=""}=e,{history:c}=e,{messageId:_}=e,v=JSON.parse(JSON.stringify(c.messages[_])),{siblings:M}=e,{gotoMessage:E=()=>{}}=e,{showPreviousMessage:C}=e,{showNextMessage:R}=e,{updateChat:L}=e,{editMessage:O}=e,{saveMessage:k}=e,{rateMessage:N}=e,{actionMessage:S}=e,{deleteMessage:B}=e,{submitMessage:T}=e,{continueResponse:P}=e,{regenerateResponse:Q}=e,{addMessages:F}=e,{isLastMessage:re=!0}=e,{readOnly:Y=!1}=e,oe,he=!1,ue=null,ke=!1,U="",Z,ge=!1,pe={},_e=!1,J,me=!1,ae=!1,be=!1;const A=async z=>{var we,Se;z=Sr(z),(((we=r==null?void 0:r.ui)==null?void 0:we.response_watermark)??"").trim()!==""&&(z=`${z}

${(Se=r==null?void 0:r.ui)==null?void 0:Se.response_watermark}`),await Rn(z,(s==null?void 0:s.copyFormatted)??!1)&&He.success(a.t("Copying to clipboard was successful!"))},G=z=>new Promise(Ce=>{J=z;const we=pe[z];if(!we)return Ce();we.play(),we.onended=async()=>{await new Promise(Se=>setTimeout(Se,300)),Object.keys(pe).length-1===z&&t(21,_e=!1),Ce()}}),$=async()=>{var z,Ce,we,Se,lt,st,Ct,ct,wt,Re,Qe,it,yt,Tt,xt,el,tl,ll,sl,nl,rl,il,ol;if(_e){try{speechSynthesis.cancel(),J!==void 0&&pe[J]&&(pe[J].pause(),pe[J].currentTime=0)}catch{}t(21,_e=!1),J=void 0;return}if(!((v==null?void 0:v.content)??"").trim().length){He.info(a.t("No content to speak"));return}if(t(21,_e=!0),r.audio.tts.engine===""){let xe=[];const _t=setInterval(()=>{var et,dt,nt;if(xe=speechSynthesis.getVoices(),xe.length>0){clearInterval(_t);const Je=((et=xe==null?void 0:xe.filter(mt=>{var al,fl,ul,cl;return mt.voiceURI===(((fl=(al=s==null?void 0:s.audio)==null?void 0:al.tts)==null?void 0:fl.voice)??((cl=(ul=r==null?void 0:r.audio)==null?void 0:ul.tts)==null?void 0:cl.voice))}))==null?void 0:et.at(0))??void 0;console.log(Je);const ht=new SpeechSynthesisUtterance(v.content);ht.rate=((nt=(dt=s.audio)==null?void 0:dt.tts)==null?void 0:nt.playbackRate)??1,console.log(ht),ht.onend=()=>{var mt;t(21,_e=!1),s.conversationMode&&((mt=document.getElementById("voice-input-button"))==null||mt.click())},Je&&(ht.voice=Je),speechSynthesis.speak(ht)}},100)}else{t(22,me=!0);const xe=Or(v.content,((Ce=(z=r==null?void 0:r.audio)==null?void 0:z.tts)==null?void 0:Ce.split_on)??"punctuation");if(!xe.length){console.log("No content to speak"),He.info(a.t("No content to speak")),t(21,_e=!1),t(22,me=!1);return}console.debug("Prepared message content for TTS",xe),pe=xe.reduce((et,dt,nt)=>(et[nt]=null,et),{});let _t=Promise.resolve();if(((Se=(we=s.audio)==null?void 0:we.tts)==null?void 0:Se.engine)==="browser-kokoro"){i||(await gl.set(new $r({dtype:((Ct=(st=(lt=s.audio)==null?void 0:lt.tts)==null?void 0:st.engineConfig)==null?void 0:Ct.dtype)??"fp32"})),await i.init());for(const[et,dt]of xe.entries()){const nt=await i.generate({text:dt,voice:((wt=(ct=s==null?void 0:s.audio)==null?void 0:ct.tts)==null?void 0:wt.voice)??((Qe=(Re=r==null?void 0:r.audio)==null?void 0:Re.tts)==null?void 0:Qe.voice)}).catch(Je=>{console.error(Je),He.error(`${Je}`),t(21,_e=!1),t(22,me=!1)});if(nt){const Je=new Audio(nt);Je.playbackRate=((yt=(it=s.audio)==null?void 0:it.tts)==null?void 0:yt.playbackRate)??1,pe[et]=Je,t(22,me=!1),_t=_t.then(()=>G(et))}}}else for(const[et,dt]of xe.entries()){const nt=await Pr(localStorage.token,((xt=(Tt=s==null?void 0:s.audio)==null?void 0:Tt.tts)==null?void 0:xt.defaultVoice)===r.audio.tts.voice?((tl=(el=s==null?void 0:s.audio)==null?void 0:el.tts)==null?void 0:tl.voice)??((sl=(ll=r==null?void 0:r.audio)==null?void 0:ll.tts)==null?void 0:sl.voice):(rl=(nl=r==null?void 0:r.audio)==null?void 0:nl.tts)==null?void 0:rl.voice,dt).catch(Je=>{console.error(Je),He.error(`${Je}`),t(21,_e=!1),t(22,me=!1)});if(nt){const Je=await nt.blob(),ht=URL.createObjectURL(Je),mt=new Audio(ht);mt.playbackRate=((ol=(il=s.audio)==null?void 0:il.tts)==null?void 0:ol.playbackRate)??1,pe[et]=mt,t(22,me=!1),_t=_t.then(()=>G(et))}}}};let X=[];function ce(z){const Ce=[];let we=0;return z=z.replace(/<details[\s\S]*?<\/details>/gi,Se=>(Ce.push(Se),`<details id="__DETAIL_${we++}__"/>`)),X=Ce,z}function ve(z){return z.replace(/<details id="__DETAIL_(\d+)__"\/>/g,(we,Se)=>X[parseInt(Se)]||"")}const Te=async()=>{t(13,ke=!0),t(18,U=ce(v.content)),await Ve(),t(19,Z.style.height="",Z),t(19,Z.style.height=`${Z.scrollHeight}px`,Z)},Ne=async()=>{const z=ve(U||"");O(v.id,{content:z},!1),t(13,ke=!1),t(18,U=""),await Ve()},Ae=async()=>{const z=ve(U||"");O(v.id,{content:z}),t(13,ke=!1),t(18,U=""),await Ve()},ze=async()=>{t(13,ke=!1),t(18,U=""),await Ve()},We=async z=>{t(23,ae=!0);const Ce=await Ar(localStorage.token,z.content).catch(we=>{He.error(`${we}`)});if(console.log(Ce),Ce){const we=Ce.map(Se=>({type:"image",url:`${Se.url}`}));k(z.id,{...z,files:we})}t(23,ae=!1)};let ie=!1;const Fe=async(z=null,Ce=null)=>{var wt;t(25,ie=!0),console.log("Feedback",z,Ce);const we={...v,annotation:{...(v==null?void 0:v.annotation)??{},...z!==null?{rating:z}:{},...Ce||{}}},Se=await Cr(localStorage.token,g).catch(Re=>{He.error(`${Re}`)});if(!Se)return;const lt=Ft(c,v.id);let st={type:"rating",data:{...we!=null&&we.annotation?we.annotation:{},model_id:(v==null?void 0:v.selectedModelId)??v.model,...c.messages[v.parentId].childrenIds.length>1?{sibling_model_ids:c.messages[v.parentId].childrenIds.filter(Re=>Re!==v.id).map(Re=>{var Qe;return((Qe=c.messages[Re])==null?void 0:Qe.selectedModelId)??c.messages[Re].model})}:{}},meta:{arena:v?v.arena:!1,model_id:v.model,message_id:v.id,message_index:lt.length,chat_id:g},snapshot:{chat:Se}};const Ct=[st.data.model_id,...st.data.sibling_model_ids??[]].reduce((Re,Qe)=>{var yt;const it=l.find(Tt=>Tt.id===Qe);return it?Re[it.id]=((yt=it==null?void 0:it.info)==null?void 0:yt.base_model_id)??null:console.warn(`Model with ID ${Qe} not found`),Re},{});st.meta.base_models=Ct;let ct=null;if(v!=null&&v.feedbackId?ct=await vl(localStorage.token,v.feedbackId,st).catch(Re=>{He.error(`${Re}`)}):(ct=await Rr(localStorage.token,st).catch(Re=>{He.error(`${Re}`)}),ct&&(we.feedbackId=ct.id)),console.log(we),k(v.id,we),await Ve(),!Ce&&(t(24,be=!0),!((wt=we.annotation)!=null&&wt.tags))){const Re=await Lr(localStorage.token,v.model,lt,g).catch(Qe=>(console.error(Qe),[]));console.log(Re),Re&&(we.annotation.tags=Re,st.data.tags=Re,k(v.id,we),await vl(localStorage.token,we.feedbackId,st).catch(Qe=>{He.error(`${Qe}`)}))}t(25,ie=!1)},tt=async()=>{B(v.id)};kt(async()=>{await Ve(),oe&&(console.log(oe),oe.addEventListener("wheel",function(z){oe.scrollWidth<=oe.clientWidth||(z.preventDefault(),z.deltaY!==0&&t(15,oe.scrollLeft+=z.deltaY,oe))}))});let qe;function Ze(z){he=z,t(16,he)}const ft=()=>{tt()};function ut(z){je[z?"unshift":"push"](()=>{qe=z,t(14,qe),t(12,v),t(0,c),t(43,_)})}function rt(z){je[z?"unshift":"push"](()=>{Z=z,t(19,Z)})}function Mt(){U=this.value,t(18,U)}const Et=z=>{var Se,lt;z.key==="Escape"&&((Se=document.getElementById("close-edit-message-button"))==null||Se.click());const Ce=z.metaKey||z.ctrlKey,we=z.key==="Enter";Ce&&we&&((lt=document.getElementById("confirm-edit-message-button"))==null||lt.click())},Dt=()=>{Ae()},Nt=()=>{ze()},Vt=()=>{Ne()},qn=async z=>{console.log(z)},Fn=async(z,Ce)=>{console.log(z,Ce);let we=document.getElementById(`source-${v.id}-${Ce}`);const Se=document.getElementById(`collapsible-${v.id}`);we?we.click():Se&&(Se.querySelector("div:first-child").dispatchEvent(new PointerEvent("pointerup",{})),await new Promise(lt=>{requestAnimationFrame(()=>{requestAnimationFrame(lt)})}),we=document.getElementById(`source-${v.id}-${Ce}`),we&&we.click())},Jn=({modelId:z,parentId:Ce,messages:we})=>{F({modelId:z,parentId:Ce,messages:we})},Gn=({raw:z,oldContent:Ce,newContent:we})=>{t(0,c.messages[v.id].content=c.messages[v.id].content.replace(z,z.replace(Ce,we)),c),L()},Kn=()=>{C(v)},Zn=z=>{E(v,z.target.value-1),t(20,ge=!1)},Qn=z=>{z.key==="Enter"&&(E(v,z.target.value-1),t(20,ge=!1))},Yn=async()=>{t(20,ge=!0),await Ve();const z=document.getElementById(`message-index-input-${v.id}`);z&&(z.focus(),z.select())},Xn=()=>{R(v)},$n=()=>{Te()},xn=()=>{A(v.content)},er=()=>{me||$()},tr=()=>{ae||We(v)},lr=()=>{console.log(v)},sr=async()=>{await Fe(1),window.setTimeout(()=>{var z;(z=document.getElementById(`message-feedback-${v.id}`))==null||z.scrollIntoView()},0)},nr=async()=>{await Fe(-1),window.setTimeout(()=>{var z;(z=document.getElementById(`message-feedback-${v.id}`))==null||z.scrollIntoView()},0)},rr=()=>{P()},ir=()=>{t(24,be=!1),Q(v),((ue==null?void 0:ue.actions)??[]).forEach(z=>{d("action",{id:z.id,event:{id:"regenerate-response",data:{messageId:v.id}}})})},or=()=>{t(16,he=!0)},ar=z=>{S(z.id,v)};function fr(z){je[z?"unshift":"push"](()=>{oe=z,t(15,oe)})}function ur(z){v=z,t(12,v),t(0,c),t(43,_)}function cr(z){be=z,t(24,be)}const dr=async z=>{await Fe(null,{...z.detail})};return n.$$set=z=>{"chatId"in z&&t(42,g=z.chatId),"history"in z&&t(0,c=z.history),"messageId"in z&&t(43,_=z.messageId),"siblings"in z&&t(1,M=z.siblings),"gotoMessage"in z&&t(2,E=z.gotoMessage),"showPreviousMessage"in z&&t(3,C=z.showPreviousMessage),"showNextMessage"in z&&t(4,R=z.showNextMessage),"updateChat"in z&&t(5,L=z.updateChat),"editMessage"in z&&t(44,O=z.editMessage),"saveMessage"in z&&t(45,k=z.saveMessage),"rateMessage"in z&&t(46,N=z.rateMessage),"actionMessage"in z&&t(6,S=z.actionMessage),"deleteMessage"in z&&t(47,B=z.deleteMessage),"submitMessage"in z&&t(48,T=z.submitMessage),"continueResponse"in z&&t(7,P=z.continueResponse),"regenerateResponse"in z&&t(8,Q=z.regenerateResponse),"addMessages"in z&&t(9,F=z.addMessages),"isLastMessage"in z&&t(10,re=z.isLastMessage),"readOnly"in z&&t(11,Y=z.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&4097|n.$$.dirty[1]&4096&&c.messages&&JSON.stringify(v)!==JSON.stringify(c.messages[_])&&t(12,v=JSON.parse(JSON.stringify(c.messages[_]))),n.$$.dirty[0]&4096|n.$$.dirty[1]&262144&&t(17,ue=l.find(z=>z.id===v.model)),n.$$.dirty[0]&8192&&(ke||(async()=>await Ve())()),n.$$.dirty[0]&20480&&v.done&&qe&&t(14,qe.textContent=v.content,qe)},[c,M,E,C,R,L,S,P,Q,F,re,Y,v,ke,qe,oe,he,ue,U,Z,ge,_e,me,ae,be,ie,s,r,a,o,f,u,d,A,$,Te,Ne,Ae,ze,We,Fe,tt,g,_,O,k,N,B,T,l,Ze,ft,ut,rt,Mt,Et,Dt,Nt,Vt,qn,Fn,Jn,Gn,Kn,Zn,Qn,Yn,Xn,$n,xn,er,tr,lr,sr,nr,rr,ir,or,ar,fr,ur,cr,dr]}class Wn extends Le{constructor(e){super(),Pe(this,e,Da,Ia,Be,{chatId:42,history:0,messageId:43,siblings:1,gotoMessage:2,showPreviousMessage:3,showNextMessage:4,updateChat:5,editMessage:44,saveMessage:45,rateMessage:46,actionMessage:6,deleteMessage:47,submitMessage:48,continueResponse:7,regenerateResponse:8,addMessages:9,isLastMessage:10,readOnly:11},null,[-1,-1,-1,-1])}}function Na(n){let e,t;return{c(){e=ye("svg"),t=ye("path"),this.h()},l(l){e=Ie(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=Ie(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",n[1]),h(e,"stroke","currentColor"),h(e,"class",n[0])},m(l,s){V(l,e,s),p(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:Me,o:Me,d(l){l&&m(e)}}}function Va(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class Ca extends Le{constructor(e){super(),Pe(this,e,Va,Na,Be,{className:0,strokeWidth:1})}}function Wt(n){var l;const e=n.slice(),t=(l=e[0].messages[e[2]])==null?void 0:l.merged;return e[15]=t,e}function js(n,e,t){const l=n.slice();return l[39]=e[t],l}function qt(n){const e=n.slice(),t=e[18][e[39]].messageIds[e[19][e[39]]];return e[42]=t,e}function zs(n){let e,t,l,s,r,i=De(Object.keys(n[18])),a=[];for(let u=0;u<i.length;u+=1)a[u]=Fs(js(n,i,u));const o=u=>D(a[u],1,1,()=>{a[u]=null});let f=!n[4]&&Js(n);return{c(){e=y("div"),t=y("div");for(let u=0;u<a.length;u+=1)a[u].c();s=H(),f&&f.c(),this.h()},l(u){e=I(u,"DIV",{});var d=w(e);t=I(d,"DIV",{class:!0,id:!0});var g=w(t);for(let c=0;c<a.length;c+=1)a[c].l(g);g.forEach(m),s=j(d),f&&f.l(d),d.forEach(m),this.h()},h(){h(t,"class","flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden"),h(t,"id",l="responses-container-"+n[1]+"-"+n[17].id)},m(u,d){V(u,e,d),p(e,t);for(let g=0;g<a.length;g+=1)a[g]&&a[g].m(t,null);p(e,s),f&&f.m(e,null),r=!0},p(u,d){if(d[0]&60620791){i=De(Object.keys(u[18]));let g;for(g=0;g<i.length;g+=1){const c=js(u,i,g);a[g]?(a[g].p(c,d),b(a[g],1)):(a[g]=Fs(c),a[g].c(),b(a[g],1),a[g].m(t,null))}for(se(),g=i.length;g<a.length;g+=1)o(g);ne()}(!r||d[0]&131074&&l!==(l="responses-container-"+u[1]+"-"+u[17].id))&&h(t,"id",l),u[4]?f&&(se(),D(f,1,1,()=>{f=null}),ne()):f?(f.p(u,d),d[0]&16&&b(f,1)):(f=Js(u),f.c(),b(f,1),f.m(e,null))},i(u){if(!r){for(let d=0;d<i.length;d+=1)b(a[d]);b(f),r=!0}},o(u){a=a.filter(Boolean);for(let d=0;d<a.length;d+=1)D(a[d]);D(f),r=!1},d(u){u&&m(e),Ge(a,u),f&&f.d()}}}function Us(n){let e,t=n[0].currentId,l,s,r,i,a,o=qs(n);function f(){return n[34](n[42])}return{c(){e=y("div"),o.c(),l=H(),this.h()},l(u){e=I(u,"DIV",{class:!0});var d=w(e);o.l(d),l=j(d),d.forEach(m),this.h()},h(){var u;h(e,"class",s="snap-center w-full max-w-full m-1 border "+(((u=n[0].messages[n[2]])==null?void 0:u.modelIdx)==n[39]?`border-gray-100 dark:border-gray-850 border-[1.5px] ${n[20]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[20]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl")},m(u,d){V(u,e,d),o.m(e,null),p(e,l),r=!0,i||(a=de(e,"click",f),i=!0)},p(u,d){var g;n=u,d[0]&1&&Be(t,t=n[0].currentId)?(se(),D(o,1,1,Me),ne(),o=qs(n),o.c(),b(o,1),o.m(e,l)):o.p(n,d),(!r||d[0]&1310725&&s!==(s="snap-center w-full max-w-full m-1 border "+(((g=n[0].messages[n[2]])==null?void 0:g.modelIdx)==n[39]?`border-gray-100 dark:border-gray-850 border-[1.5px] ${n[20]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[20]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl"))&&h(e,"class",s)},i(u){r||(b(o),r=!0)},o(u){D(o),r=!1},d(u){u&&m(e),o.d(u),i=!1,a()}}}function Ws(n){let e,t;function l(...a){return n[30](n[39],...a)}function s(){return n[31](n[39])}function r(){return n[32](n[39])}function i(...a){return n[33](n[39],...a)}return e=new Wn({props:{chatId:n[1],history:n[0],messageId:n[42],isLastMessage:!0,siblings:n[18][n[39]].messageIds,gotoMessage:l,showPreviousMessage:s,showNextMessage:r,updateChat:n[5],editMessage:n[6],saveMessage:n[7],rateMessage:n[8],deleteMessage:n[11],actionMessage:n[9],submitMessage:n[10],continueResponse:n[12],regenerateResponse:i,addMessages:n[14],readOnly:n[4]}}),{c(){x(e.$$.fragment)},l(a){ee(e.$$.fragment,a)},m(a,o){te(e,a,o),t=!0},p(a,o){n=a;const f={};o[0]&2&&(f.chatId=n[1]),o[0]&1&&(f.history=n[0]),o[0]&786432&&(f.messageId=n[42]),o[0]&262144&&(f.siblings=n[18][n[39]].messageIds),o[0]&262144&&(f.gotoMessage=l),o[0]&262144&&(f.showPreviousMessage=s),o[0]&262144&&(f.showNextMessage=r),o[0]&32&&(f.updateChat=n[5]),o[0]&64&&(f.editMessage=n[6]),o[0]&128&&(f.saveMessage=n[7]),o[0]&256&&(f.rateMessage=n[8]),o[0]&2048&&(f.deleteMessage=n[11]),o[0]&512&&(f.actionMessage=n[9]),o[0]&1024&&(f.submitMessage=n[10]),o[0]&4096&&(f.continueResponse=n[12]),o[0]&794624&&(f.regenerateResponse=i),o[0]&16384&&(f.addMessages=n[14]),o[0]&16&&(f.readOnly=n[4]),e.$set(f)},i(a){t||(b(e.$$.fragment,a),t=!0)},o(a){D(e.$$.fragment,a),t=!1},d(a){le(e,a)}}}function qs(n){let e,t,l=n[15]&&Ws(n);return{c(){l&&l.c(),e=fe()},l(s){l&&l.l(s),e=fe()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[15]?l?(l.p(s,r),r[0]&32768&&b(l,1)):(l=Ws(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(se(),D(l,1,1,()=>{l=null}),ne())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function Fs(n){let e,t,l=n[19][n[39]]!==void 0&&n[18][n[39]].messageIds.length>0&&Us(qt(n));return{c(){l&&l.c(),e=fe()},l(s){l&&l.l(s),e=fe()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[19][s[39]]!==void 0&&s[18][s[39]].messageIds.length>0?l?(l.p(qt(s),r),r[0]&786432&&b(l,1)):(l=Us(qt(s)),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(se(),D(l,1,1,()=>{l=null}),ne())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function Js(n){let e=!Object.keys(n[18]).find(n[29]),t,l,s=e&&Gs(n);return{c(){s&&s.c(),t=fe()},l(r){s&&s.l(r),t=fe()},m(r,i){s&&s.m(r,i),V(r,t,i),l=!0},p(r,i){i[0]&786433&&(e=!Object.keys(r[18]).find(r[29])),e?s?(s.p(r,i),i[0]&786433&&b(s,1)):(s=Gs(r),s.c(),b(s,1),s.m(t.parentNode,t)):s&&(se(),D(s,1,1,()=>{s=null}),ne())},i(r){l||(b(s),l=!0)},o(r){D(s),l=!1},d(r){r&&m(t),s&&s.d(r)}}}function Gs(n){var a,o;let e,t,l,s,r=((o=(a=n[0].messages[n[2]])==null?void 0:a.merged)==null?void 0:o.status)&&Ks(Wt(n)),i=n[3]&&Qs(n);return{c(){e=y("div"),t=y("div"),r&&r.c(),l=H(),i&&i.c(),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=w(e);t=I(u,"DIV",{class:!0});var d=w(t);r&&r.l(d),d.forEach(m),l=j(u),i&&i.l(u),u.forEach(m),this.h()},h(){h(t,"class","w-full"),h(e,"class","flex justify-end")},m(f,u){V(f,e,u),p(e,t),r&&r.m(t,null),p(e,l),i&&i.m(e,null),s=!0},p(f,u){var d,g;(g=(d=f[0].messages[f[2]])==null?void 0:d.merged)!=null&&g.status?r?(r.p(Wt(f),u),u[0]&5&&b(r,1)):(r=Ks(Wt(f)),r.c(),b(r,1),r.m(t,null)):r&&(se(),D(r,1,1,()=>{r=null}),ne()),f[3]?i?(i.p(f,u),u[0]&8&&b(i,1)):(i=Qs(f),i.c(),b(i,1),i.m(e,null)):i&&(se(),D(i,1,1,()=>{i=null}),ne())},i(f){s||(b(r),b(i),s=!0)},o(f){D(r),D(i),s=!1},d(f){f&&m(e),r&&r.d(),i&&i.d()}}}function Ks(n){let e,t,l,s,r,i,a;t=new Kt({props:{$$slots:{default:[Ta]},$$scope:{ctx:n}}});const o=[Sa,Ba],f=[];function u(d,g){var c;return(((c=d[15])==null?void 0:c.content)??"")===""?0:1}return r=u(n),i=f[r]=o[r](n),{c(){e=y("div"),x(t.$$.fragment),l=H(),s=y("div"),i.c(),this.h()},l(d){e=I(d,"DIV",{class:!0});var g=w(e);ee(t.$$.fragment,g),l=j(g),s=I(g,"DIV",{class:!0});var c=w(s);i.l(c),c.forEach(m),g.forEach(m),this.h()},h(){h(s,"class","mt-1 markdown-prose w-full min-w-full"),h(e,"class","w-full rounded-xl pl-5 pr-2 py-2")},m(d,g){V(d,e,g),te(t,e,null),p(e,l),p(e,s),f[r].m(s,null),a=!0},p(d,g){const c={};g[0]&2097157|g[1]&4096&&(c.$$scope={dirty:g,ctx:d}),t.$set(c);let _=r;r=u(d),r===_?f[r].p(d,g):(se(),D(f[_],1,1,()=>{f[_]=null}),ne(),i=f[r],i?i.p(d,g):(i=f[r]=o[r](d),i.c()),b(i,1),i.m(s,null))},i(d){a||(b(t.$$.fragment,d),b(i),a=!0)},o(d){D(t.$$.fragment,d),D(i),a=!1},d(d){d&&m(e),le(t),f[r].d()}}}function Zs(n){let e,t=at(n[15].timestamp*1e3).format("LT")+"",l;return{c(){e=y("span"),l=W(t),this.h()},l(s){e=I(s,"SPAN",{class:!0});var r=w(e);l=q(r,t),r.forEach(m),this.h()},h(){h(e,"class","self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r[0]&5&&t!==(t=at(s[15].timestamp*1e3).format("LT")+"")&&K(l,t)},d(s){s&&m(e)}}}function Ta(n){let e=n[21].t("Merged Response")+"",t,l,s,r=n[15].timestamp&&Zs(n);return{c(){t=W(e),l=H(),r&&r.c(),s=fe()},l(i){t=q(i,e),l=j(i),r&&r.l(i),s=fe()},m(i,a){V(i,t,a),V(i,l,a),r&&r.m(i,a),V(i,s,a)},p(i,a){a[0]&2097152&&e!==(e=i[21].t("Merged Response")+"")&&K(t,e),i[15].timestamp?r?r.p(i,a):(r=Zs(i),r.c(),r.m(s.parentNode,s)):r&&(r.d(1),r=null)},d(i){i&&(m(t),m(l),m(s)),r&&r.d(i)}}}function Ba(n){let e,t;return e=new It({props:{id:"merged",content:n[15].content??""}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&5&&(r.content=l[15].content??""),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Sa(n){let e,t;return e=new $t({}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p:Me,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Qs(n){let e,t,l;return t=new Oe({props:{content:n[21].t("Merge Responses"),placement:"bottom",$$slots:{default:[Oa]},$$scope:{ctx:n}}}),{c(){e=y("div"),x(t.$$.fragment),this.h()},l(s){e=I(s,"DIV",{class:!0});var r=w(e);ee(t.$$.fragment,r),r.forEach(m),this.h()},h(){h(e,"class","shrink-0 text-gray-600 dark:text-gray-500 mt-1")},m(s,r){V(s,e,r),te(t,e,null),l=!0},p(s,r){const i={};r[0]&2097152&&(i.content=s[21].t("Merge Responses")),r[1]&4096&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),le(t)}}}function Oa(n){let e,t,l,s,r;return t=new Ca({props:{className:" size-5 "}}),{c(){e=y("button"),x(t.$$.fragment),this.h()},l(i){e=I(i,"BUTTON",{type:!0,id:!0,class:!0});var a=w(e);ee(t.$$.fragment,a),a.forEach(m),this.h()},h(){h(e,"type","button"),h(e,"id","merge-response-button"),h(e,"class","visible p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(i,a){V(i,e,a),te(t,e,null),l=!0,s||(r=de(e,"click",n[35]),s=!0)},p:Me,i(i){l||(b(t.$$.fragment,i),l=!0)},o(i){D(t.$$.fragment,i),l=!1},d(i){i&&m(e),le(t),s=!1,r()}}}function Ra(n){let e,t,l=n[17]&&zs(n);return{c(){l&&l.c(),e=fe()},l(s){l&&l.l(s),e=fe()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[17]?l?(l.p(s,r),r[0]&131072&&b(l,1)):(l=zs(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(se(),D(l,1,1,()=>{l=null}),ne())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function La(n,e,t){let l,s,r;Ee(n,gt,J=>t(36,l=J)),Ee(n,Sn,J=>t(20,s=J));const i=Ke("i18n");Ee(n,i,J=>t(21,r=J)),at.extend(Ln);let{chatId:a}=e,{history:o}=e,{messageId:f}=e,{isLastMessage:u}=e,{readOnly:d=!1}=e,{updateChat:g}=e,{editMessage:c}=e,{saveMessage:_}=e,{rateMessage:v}=e,{actionMessage:M}=e,{submitMessage:E}=e,{deleteMessage:C}=e,{continueResponse:R}=e,{regenerateResponse:L}=e,{mergeResponses:O}=e,{addMessages:k}=e,{triggerScroll:N}=e;vt();let S,B,T={},P={},Q=JSON.parse(JSON.stringify(o.messages[f]));const F=async(J,me)=>{t(19,P[J]=Math.max(0,Math.min(me,T[J].messageIds.length-1)),P);let ae=T[J].messageIds[P[J]];console.log(ae);let be=o.messages[ae].childrenIds;for(;be.length!==0;)ae=be.at(-1),be=o.messages[ae].childrenIds;t(0,o.currentId=ae,o),await Ve(),await g(),N()},re=async J=>{t(19,P[J]=Math.max(0,P[J]-1),P);let me=T[J].messageIds[P[J]];console.log(me);let ae=o.messages[me].childrenIds;for(;ae.length!==0;)me=ae.at(-1),ae=o.messages[me].childrenIds;t(0,o.currentId=me,o),await Ve(),await g(),N()},Y=async J=>{t(19,P[J]=Math.min(T[J].messageIds.length-1,P[J]+1),P);let me=T[J].messageIds[P[J]];console.log(me);let ae=o.messages[me].childrenIds;for(;ae.length!==0;)me=ae.at(-1),ae=o.messages[me].childrenIds;t(0,o.currentId=me,o),await Ve(),await g(),N()},oe=async()=>{console.log("multiresponse:initHandler"),await Ve(),t(16,S=f),t(17,B=o.messages[f].parentId?o.messages[o.messages[f].parentId]:null),t(18,T=B==null?void 0:B.models.reduce((J,me,ae)=>{let be=B==null?void 0:B.childrenIds.map(A=>o.messages[A]).filter(A=>(A==null?void 0:A.modelIdx)===ae).map(A=>A.id);if(be.length===0){let A=B==null?void 0:B.childrenIds.map(G=>o.messages[G]).filter(G=>(G==null?void 0:G.model)===me);A.forEach(G=>{G.modelIdx=ae}),be=A.map(G=>G.id)}return{...J,[ae]:{messageIds:be}}},{})),t(19,P=B==null?void 0:B.models.reduce((J,me,ae)=>{const be=T[ae].messageIds.findIndex(A=>A===f);return be!==-1?{...J,[ae]:be}:{...J,[ae]:T[ae].messageIds.length-1}},{})),console.log(T,P),await Ve()},he=async()=>{const J=Object.keys(T).map(me=>{const{messageIds:ae}=T[me],be=ae[P[me]];return o.messages[be].content});O(f,J,a)};kt(async()=>{if(await oe(),await Ve(),(l==null?void 0:l.scrollOnBranchChange)??!0){const J=document.getElementById(`message-${f}`);J&&J.scrollIntoView({block:"start"})}});const ue=J=>{var be;const{messageIds:me}=T[J],ae=me[P[J]];return!((be=o.messages[ae])!=null&&be.done)},ke=(J,me,ae)=>F(J,ae),U=J=>re(J),Z=J=>Y(J),ge=async(J,me)=>{L(me),await Ve(),t(19,P[J]=T[J].messageIds.length-1,P)},pe=async J=>{if(f!=J){let me=J,ae=o.messages[me].childrenIds;for(;ae.length!==0;)me=ae.at(-1),ae=o.messages[me].childrenIds;t(0,o.currentId=me,o)}},_e=()=>{he()};return n.$$set=J=>{"chatId"in J&&t(1,a=J.chatId),"history"in J&&t(0,o=J.history),"messageId"in J&&t(2,f=J.messageId),"isLastMessage"in J&&t(3,u=J.isLastMessage),"readOnly"in J&&t(4,d=J.readOnly),"updateChat"in J&&t(5,g=J.updateChat),"editMessage"in J&&t(6,c=J.editMessage),"saveMessage"in J&&t(7,_=J.saveMessage),"rateMessage"in J&&t(8,v=J.rateMessage),"actionMessage"in J&&t(9,M=J.actionMessage),"submitMessage"in J&&t(10,E=J.submitMessage),"deleteMessage"in J&&t(11,C=J.deleteMessage),"continueResponse"in J&&t(12,R=J.continueResponse),"regenerateResponse"in J&&t(13,L=J.regenerateResponse),"mergeResponses"in J&&t(27,O=J.mergeResponses),"addMessages"in J&&t(14,k=J.addMessages),"triggerScroll"in J&&t(28,N=J.triggerScroll)},n.$$.update=()=>{n.$$.dirty[0]&32773&&o.messages&&JSON.stringify(Q)!==JSON.stringify(o.messages[f])&&t(15,Q=JSON.parse(JSON.stringify(o.messages[f])))},[o,a,f,u,d,g,c,_,v,M,E,C,R,L,k,Q,S,B,T,P,s,r,i,F,re,Y,he,O,N,ue,ke,U,Z,ge,pe,_e]}class Pa extends Le{constructor(e){super(),Pe(this,e,La,Ra,Be,{chatId:1,history:0,messageId:2,isLastMessage:3,readOnly:4,updateChat:5,editMessage:6,saveMessage:7,rateMessage:8,actionMessage:9,submitMessage:10,deleteMessage:11,continueResponse:12,regenerateResponse:13,mergeResponses:27,addMessages:14,triggerScroll:28},null,[-1,-1])}}function Ys(n,e,t){const l=n.slice();return l[53]=e[t],l[55]=t,l}function Xs(n,e,t){const l=n.slice();return l[53]=e[t],l}function $s(n){var s,r,i,a;let e,t,l;return t=new Pn({props:{src:n[7].user?((i=(r=(s=n[16].find(n[30]))==null?void 0:s.info)==null?void 0:r.meta)==null?void 0:i.profile_image_url)??"/user.png":((a=n[0])==null?void 0:a.profile_image_url)??"/user.png",className:"size-8"}}),{c(){e=y("div"),x(t.$$.fragment),this.h()},l(o){e=I(o,"DIV",{class:!0});var f=w(e);ee(t.$$.fragment,f),f.forEach(m),this.h()},h(){h(e,"class","shrink-0 ltr:mr-3 rtl:ml-3")},m(o,f){V(o,e,f),te(t,e,null),l=!0},p(o,f){var d,g,c,_;const u={};f[0]&65665&&(u.src=o[7].user?((c=(g=(d=o[16].find(o[30]))==null?void 0:d.info)==null?void 0:g.meta)==null?void 0:c.profile_image_url)??"/user.png":((_=o[0])==null?void 0:_.profile_image_url)??"/user.png"),t.$set(u)},i(o){l||(b(t.$$.fragment,o),l=!0)},o(o){D(t.$$.fragment,o),l=!1},d(o){o&&m(e),le(t)}}}function xs(n){let e,t,l;return t=new Kt({props:{$$slots:{default:[Ua]},$$scope:{ctx:n}}}),{c(){e=y("div"),x(t.$$.fragment)},l(s){e=I(s,"DIV",{});var r=w(e);ee(t.$$.fragment,r),r.forEach(m)},m(s,r){V(s,e,r),te(t,e,null),l=!0},p(s,r){const i={};r[0]&180353|r[1]&134217728&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),le(t)}}}function Aa(n){let e=n[14].t("You")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&16384&&e!==(e=l[14].t("You")+"")&&K(t,e)},d(l){l&&m(t)}}}function Ha(n){let e=n[0].name+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&1&&e!==(e=l[0].name+"")&&K(t,e)},d(l){l&&m(t)}}}function ja(n){var a;let e=n[14].t("You")+"",t,l,s,r=(((a=n[7])==null?void 0:a.user)??"")+"",i;return{c(){t=W(e),l=H(),s=y("span"),i=W(r),this.h()},l(o){t=q(o,e),l=j(o),s=I(o,"SPAN",{class:!0});var f=w(s);i=q(f,r),f.forEach(m),this.h()},h(){h(s,"class","text-gray-500 text-sm font-medium")},m(o,f){V(o,t,f),V(o,l,f),V(o,s,f),p(s,i)},p(o,f){var u;f[0]&16384&&e!==(e=o[14].t("You")+"")&&K(t,e),f[0]&128&&r!==(r=(((u=o[7])==null?void 0:u.user)??"")+"")&&K(i,r)},d(o){o&&(m(t),m(l),m(s))}}}function en(n){let e,t,l;return t=new Oe({props:{content:at(n[7].timestamp*1e3).format("LLLL"),$$slots:{default:[za]},$$scope:{ctx:n}}}),{c(){e=y("div"),x(t.$$.fragment),this.h()},l(s){e=I(s,"DIV",{class:!0});var r=w(e);ee(t.$$.fragment,r),r.forEach(m),this.h()},h(){h(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){V(s,e,r),te(t,e,null),l=!0},p(s,r){const i={};r[0]&128&&(i.content=at(s[7].timestamp*1e3).format("LLLL")),r[0]&128|r[1]&134217728&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),le(t)}}}function za(n){let e,t=At(n[7].timestamp*1e3)+"",l;return{c(){e=y("span"),l=W(t),this.h()},l(s){e=I(s,"SPAN",{class:!0});var r=w(e);l=q(r,t),r.forEach(m),this.h()},h(){h(e,"class","line-clamp-1")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r[0]&128&&t!==(t=At(s[7].timestamp*1e3)+"")&&K(l,t)},d(s){s&&m(e)}}}function Ua(n){let e,t,l;function s(o,f){return o[7].user?ja:o[15].showUsername||o[17].name!==o[0].name?Ha:Aa}let r=s(n),i=r(n),a=n[7].timestamp&&en(n);return{c(){i.c(),e=H(),a&&a.c(),t=fe()},l(o){i.l(o),e=j(o),a&&a.l(o),t=fe()},m(o,f){i.m(o,f),V(o,e,f),a&&a.m(o,f),V(o,t,f),l=!0},p(o,f){r===(r=s(o))&&i?i.p(o,f):(i.d(1),i=r(o),i&&(i.c(),i.m(e.parentNode,e))),o[7].timestamp?a?(a.p(o,f),f[0]&128&&b(a,1)):(a=en(o),a.c(),b(a,1),a.m(t.parentNode,t)):a&&(se(),D(a,1,1,()=>{a=null}),ne())},i(o){l||(b(a),l=!0)},o(o){D(a),l=!1},d(o){o&&(m(e),m(t)),i.d(o),a&&a.d(o)}}}function tn(n){let e,t,l=n[7].files&&ln(n);return{c(){l&&l.c(),e=fe()},l(s){l&&l.l(s),e=fe()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[7].files?l?(l.p(s,r),r[0]&128&&b(l,1)):(l=ln(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(se(),D(l,1,1,()=>{l=null}),ne())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function ln(n){let e,t,l=De(n[7].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=sn(Xs(n,l,i));const r=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=y("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=I(i,"DIV",{class:!0});var a=w(e);for(let o=0;o<s.length;o+=1)s[o].l(a);a.forEach(m),this.h()},h(){h(e,"class","mt-2.5 mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap")},m(i,a){V(i,e,a);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(e,null);t=!0},p(i,a){if(a[0]&32896){l=De(i[7].files);let o;for(o=0;o<l.length;o+=1){const f=Xs(i,l,o);s[o]?(s[o].p(f,a),b(s[o],1)):(s[o]=sn(f),s[o].c(),b(s[o],1),s[o].m(e,null))}for(se(),o=l.length;o<s.length;o+=1)r(o);ne()}},i(i){if(!t){for(let a=0;a<l.length;a+=1)b(s[a]);t=!0}},o(i){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)D(s[a]);t=!1},d(i){i&&m(e),Ge(s,i)}}}function Wa(n){var l;let e,t;return e=new Xt({props:{item:n[53],url:n[53].url,name:n[53].name,type:n[53].type,size:(l=n[53])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){x(e.$$.fragment)},l(s){ee(e.$$.fragment,s)},m(s,r){te(e,s,r),t=!0},p(s,r){var a;const i={};r[0]&128&&(i.item=s[53]),r[0]&128&&(i.url=s[53].url),r[0]&128&&(i.name=s[53].name),r[0]&128&&(i.type=s[53].type),r[0]&128&&(i.size=(a=s[53])==null?void 0:a.size),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function qa(n){let e,t;return e=new Zt({props:{src:n[53].url,imageClassName:" max-h-96 rounded-lg"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&128&&(r.src=l[53].url),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function sn(n){let e,t,l,s,r,i;const a=[qa,Wa],o=[];function f(u,d){return u[53].type==="image"?0:1}return t=f(n),l=o[t]=a[t](n),{c(){e=y("div"),l.c(),s=H(),this.h()},l(u){e=I(u,"DIV",{class:!0});var d=w(e);l.l(d),s=j(d),d.forEach(m),this.h()},h(){var u;h(e,"class",r=((u=n[15])==null?void 0:u.chatBubble)??!0?"self-end":"")},m(u,d){V(u,e,d),o[t].m(e,null),p(e,s),i=!0},p(u,d){var c;let g=t;t=f(u),t===g?o[t].p(u,d):(se(),D(o[g],1,1,()=>{o[g]=null}),ne(),l=o[t],l?l.p(u,d):(l=o[t]=a[t](u),l.c()),b(l,1),l.m(e,s)),(!i||d[0]&32768&&r!==(r=((c=u[15])==null?void 0:c.chatBubble)??!0?"self-end":""))&&h(e,"class",r)},i(u){i||(b(l),i=!0)},o(u){D(l),i=!1},d(u){u&&m(e),o[t].d()}}}function nn(n){let e,t,l,s;const r=[Ja,Fa],i=[];function a(o,f){return o[10]===!0?0:1}return e=a(n),t=i[e]=r[e](n),{c(){t.c(),l=fe()},l(o){t.l(o),l=fe()},m(o,f){i[e].m(o,f),V(o,l,f),s=!0},p(o,f){let u=e;e=a(o),e===u?i[e].p(o,f):(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),t=i[e],t?t.p(o,f):(t=i[e]=r[e](o),t.c()),b(t,1),t.m(l.parentNode,l))},i(o){s||(b(t),s=!0)},o(o){D(t),s=!1},d(o){o&&m(l),i[e].d(o)}}}function Fa(n){var L,O;let e,t,l,s,r,i,a,o,f,u,d,g,c,_,v=n[7].content&&rn(n),M=!(((L=n[15])==null?void 0:L.chatBubble)??!0)&&on(n),E=!n[6]&&fn(n);u=new Oe({props:{content:n[14].t("Copy"),placement:"bottom",$$slots:{default:[Qa]},$$scope:{ctx:n}}});let C=!n[6]&&(!n[5]||n[1].length>1)&&un(n),R=(((O=n[15])==null?void 0:O.chatBubble)??!0)&&cn(n);return{c(){e=y("div"),t=y("div"),l=y("div"),v&&v.c(),i=H(),a=y("div"),M&&M.c(),o=H(),E&&E.c(),f=H(),x(u.$$.fragment),d=H(),C&&C.c(),g=H(),R&&R.c(),this.h()},l(k){e=I(k,"DIV",{class:!0});var N=w(e);t=I(N,"DIV",{class:!0});var S=w(t);l=I(S,"DIV",{class:!0});var B=w(l);v&&v.l(B),B.forEach(m),S.forEach(m),i=j(N),a=I(N,"DIV",{class:!0});var T=w(a);M&&M.l(T),o=j(T),E&&E.l(T),f=j(T),ee(u.$$.fragment,T),d=j(T),C&&C.l(T),g=j(T),R&&R.l(T),T.forEach(m),N.forEach(m),this.h()},h(){var k,N,S;h(l,"class",s="rounded-3xl "+(((k=n[15])==null?void 0:k.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${n[7].files?"rounded-tr-lg":""}`:" w-full")),h(t,"class",r="flex "+(((N=n[15])==null?void 0:N.chatBubble)??!0?"justify-end pb-1":"w-full")),h(a,"class",c="flex "+(((S=n[15])==null?void 0:S.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"),h(e,"class","w-full")},m(k,N){V(k,e,N),p(e,t),p(t,l),v&&v.m(l,null),p(e,i),p(e,a),M&&M.m(a,null),p(a,o),E&&E.m(a,null),p(a,f),te(u,a,null),p(a,d),C&&C.m(a,null),p(a,g),R&&R.m(a,null),_=!0},p(k,N){var B,T,P,Q,F;k[7].content?v?(v.p(k,N),N[0]&128&&b(v,1)):(v=rn(k),v.c(),b(v,1),v.m(l,null)):v&&(se(),D(v,1,1,()=>{v=null}),ne()),(!_||N[0]&32896&&s!==(s="rounded-3xl "+(((B=k[15])==null?void 0:B.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${k[7].files?"rounded-tr-lg":""}`:" w-full")))&&h(l,"class",s),(!_||N[0]&32768&&r!==(r="flex "+(((T=k[15])==null?void 0:T.chatBubble)??!0?"justify-end pb-1":"w-full")))&&h(t,"class",r),((P=k[15])==null?void 0:P.chatBubble)??!0?M&&(M.d(1),M=null):M?M.p(k,N):(M=on(k),M.c(),M.m(a,o)),k[6]?E&&(se(),D(E,1,1,()=>{E=null}),ne()):E?(E.p(k,N),N[0]&64&&b(E,1)):(E=fn(k),E.c(),b(E,1),E.m(a,f));const S={};N[0]&16384&&(S.content=k[14].t("Copy")),N[0]&128|N[1]&134217728&&(S.$$scope={dirty:N,ctx:k}),u.$set(S),!k[6]&&(!k[5]||k[1].length>1)?C?(C.p(k,N),N[0]&98&&b(C,1)):(C=un(k),C.c(),b(C,1),C.m(a,g)):C&&(se(),D(C,1,1,()=>{C=null}),ne()),((Q=k[15])==null?void 0:Q.chatBubble)??!0?R?R.p(k,N):(R=cn(k),R.c(),R.m(a,null)):R&&(R.d(1),R=null),(!_||N[0]&32768&&c!==(c="flex "+(((F=k[15])==null?void 0:F.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"))&&h(a,"class",c)},i(k){_||(b(v),b(E),b(u.$$.fragment,k),b(C),_=!0)},o(k){D(v),D(E),D(u.$$.fragment,k),D(C),_=!1},d(k){k&&m(e),v&&v.d(),M&&M.d(),E&&E.d(),le(u),C&&C.d(),R&&R.d()}}}function Ja(n){let e,t,l,s,r,i,a,o,f,u=n[14].t("Save")+"",d,g,c,_,v=n[14].t("Cancel")+"",M,E,C,R=n[14].t("Send")+"",L,O,k,N,S=(n[12]??[]).length>0&&hn(n);return{c(){e=y("div"),S&&S.c(),t=H(),l=y("div"),s=y("textarea"),i=H(),a=y("div"),o=y("div"),f=y("button"),d=W(u),g=H(),c=y("div"),_=y("button"),M=W(v),E=H(),C=y("button"),L=W(R),this.h()},l(B){e=I(B,"DIV",{class:!0});var T=w(e);S&&S.l(T),t=j(T),l=I(T,"DIV",{class:!0});var P=w(l);s=I(P,"TEXTAREA",{id:!0,class:!0}),w(s).forEach(m),P.forEach(m),i=j(T),a=I(T,"DIV",{class:!0});var Q=w(a);o=I(Q,"DIV",{});var F=w(o);f=I(F,"BUTTON",{id:!0,class:!0});var re=w(f);d=q(re,u),re.forEach(m),F.forEach(m),g=j(Q),c=I(Q,"DIV",{class:!0});var Y=w(c);_=I(Y,"BUTTON",{id:!0,class:!0});var oe=w(_);M=q(oe,v),oe.forEach(m),E=j(Y),C=I(Y,"BUTTON",{id:!0,class:!0});var he=w(C);L=q(he,R),he.forEach(m),Y.forEach(m),Q.forEach(m),T.forEach(m),this.h()},h(){h(s,"id",r="message-edit-"+n[7].id),h(s,"class","bg-transparent outline-hidden w-full resize-none"),h(l,"class","max-h-96 overflow-auto"),h(f,"id","save-edit-message-button"),h(f,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),h(_,"id","close-edit-message-button"),h(_,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),h(C,"id","confirm-edit-message-button"),h(C,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),h(c,"class","flex space-x-1.5"),h(a,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),h(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2")},m(B,T){V(B,e,T),S&&S.m(e,null),p(e,t),p(e,l),p(l,s),n[34](s),ot(s,n[11]),p(e,i),p(e,a),p(a,o),p(o,f),p(f,d),p(a,g),p(a,c),p(c,_),p(_,M),p(c,E),p(c,C),p(C,L),O=!0,k||(N=[de(s,"input",n[35]),de(s,"input",lf),de(s,"keydown",n[36]),de(f,"click",n[37]),de(_,"click",n[38]),de(C,"click",n[39])],k=!0)},p(B,T){(B[12]??[]).length>0?S?(S.p(B,T),T[0]&4096&&b(S,1)):(S=hn(B),S.c(),b(S,1),S.m(e,t)):S&&(se(),D(S,1,1,()=>{S=null}),ne()),(!O||T[0]&128&&r!==(r="message-edit-"+B[7].id))&&h(s,"id",r),T[0]&2048&&ot(s,B[11]),(!O||T[0]&16384)&&u!==(u=B[14].t("Save")+"")&&K(d,u),(!O||T[0]&16384)&&v!==(v=B[14].t("Cancel")+"")&&K(M,v),(!O||T[0]&16384)&&R!==(R=B[14].t("Send")+"")&&K(L,R)},i(B){O||(b(S),O=!0)},o(B){D(S),O=!1},d(B){B&&m(e),S&&S.d(),n[34](null),k=!1,$e(N)}}}function rn(n){let e,t;return e=new It({props:{id:n[7].id,content:n[7].content}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&128&&(r.id=l[7].id),s[0]&128&&(r.content=l[7].content),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function on(n){let e,t=n[1].length>1&&an(n);return{c(){t&&t.c(),e=fe()},l(l){t&&t.l(l),e=fe()},m(l,s){t&&t.m(l,s),V(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=an(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function an(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,a='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',o,f;function u(c,_){return c[9]?Ka:Ga}let d=u(n),g=d(n);return{c(){e=y("div"),t=y("button"),t.innerHTML=l,s=H(),g.c(),r=H(),i=y("button"),i.innerHTML=a,this.h()},l(c){e=I(c,"DIV",{class:!0,dir:!0});var _=w(e);t=I(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(t)!=="svelte-buado9"&&(t.innerHTML=l),s=j(_),g.l(_),r=j(_),i=I(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(i)!=="svelte-4phel2"&&(i.innerHTML=a),_.forEach(m),this.h()},h(){h(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(e,"class","flex self-center"),h(e,"dir","ltr")},m(c,_){V(c,e,_),p(e,t),p(e,s),g.m(e,null),p(e,r),p(e,i),o||(f=[de(t,"click",n[40]),de(i,"click",n[44])],o=!0)},p(c,_){d===(d=u(c))&&g?g.p(c,_):(g.d(1),g=d(c),g&&(g.c(),g.m(e,r)))},d(c){c&&m(e),g.d(),o=!1,$e(f)}}}function Ga(n){let e,t=n[1].indexOf(n[7].id)+1+"",l,s,r=n[1].length+"",i,a,o;return{c(){e=y("div"),l=W(t),s=W("/"),i=W(r),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=w(e);l=q(u,t),s=q(u,"/"),i=q(u,r),u.forEach(m),this.h()},h(){h(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){V(f,e,u),p(e,l),p(e,s),p(e,i),a||(o=de(e,"dblclick",n[43]),a=!0)},p(f,u){u[0]&130&&t!==(t=f[1].indexOf(f[7].id)+1+"")&&K(l,t),u[0]&2&&r!==(r=f[1].length+"")&&K(i,r)},d(f){f&&m(e),a=!1,o()}}}function Ka(n){let e,t,l,s,r,i,a=n[1].length+"",o,f,u;return{c(){e=y("div"),t=y("input"),i=W("/"),o=W(a),this.h()},l(d){e=I(d,"DIV",{class:!0});var g=w(e);t=I(g,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=q(g,"/"),o=q(g,a),g.forEach(m),this.h()},h(){h(t,"id",l="message-index-input-"+n[7].id),h(t,"type","number"),t.value=s=n[1].indexOf(n[7].id)+1,h(t,"min","1"),h(t,"max",r=n[1].length),h(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),h(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(d,g){V(d,e,g),p(e,t),p(e,i),p(e,o),f||(u=[de(t,"focus",sf),de(t,"blur",n[41]),de(t,"keydown",n[42])],f=!0)},p(d,g){g[0]&128&&l!==(l="message-index-input-"+d[7].id)&&h(t,"id",l),g[0]&130&&s!==(s=d[1].indexOf(d[7].id)+1)&&t.value!==s&&(t.value=s),g[0]&2&&r!==(r=d[1].length)&&h(t,"max",r),g[0]&2&&a!==(a=d[1].length+"")&&K(o,a)},d(d){d&&m(e),f=!1,$e(u)}}}function fn(n){let e,t;return e=new Oe({props:{content:n[14].t("Edit"),placement:"bottom",$$slots:{default:[Za]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&16384&&(r.content=l[14].t("Edit")),s[1]&134217728&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Za(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg>',l,s;return{c(){e=y("button"),e.innerHTML=t,this.h()},l(r){e=I(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(e)!=="svelte-tlrz1q"&&(e.innerHTML=t),this.h()},h(){h(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition edit-user-message-button")},m(r,i){V(r,e,i),l||(s=de(e,"click",n[45]),l=!0)},p:Me,d(r){r&&m(e),l=!1,s()}}}function Qa(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg>',l,s;return{c(){e=y("button"),e.innerHTML=t,this.h()},l(r){e=I(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(e)!=="svelte-1ivgdx2"&&(e.innerHTML=t),this.h()},h(){h(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(r,i){V(r,e,i),l||(s=de(e,"click",n[46]),l=!0)},p:Me,d(r){r&&m(e),l=!1,s()}}}function un(n){let e,t;return e=new Oe({props:{content:n[14].t("Delete"),placement:"bottom",$$slots:{default:[Ya]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&16384&&(r.content=l[14].t("Delete")),s[0]&256|s[1]&134217728&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Ya(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',l,s;return{c(){e=y("button"),e.innerHTML=t,this.h()},l(r){e=I(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(e)!=="svelte-146x2zz"&&(e.innerHTML=t),this.h()},h(){h(e,"class","invisible group-hover:visible p-1 rounded-sm dark:hover:text-white hover:text-black transition")},m(r,i){V(r,e,i),l||(s=de(e,"click",n[47]),l=!0)},p:Me,d(r){r&&m(e),l=!1,s()}}}function cn(n){let e,t=n[1].length>1&&dn(n);return{c(){t&&t.c(),e=fe()},l(l){t&&t.l(l),e=fe()},m(l,s){t&&t.m(l,s),V(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=dn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function dn(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,a='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',o,f;function u(c,_){return c[9]?$a:Xa}let d=u(n),g=d(n);return{c(){e=y("div"),t=y("button"),t.innerHTML=l,s=H(),g.c(),r=H(),i=y("button"),i.innerHTML=a,this.h()},l(c){e=I(c,"DIV",{class:!0,dir:!0});var _=w(e);t=I(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(t)!=="svelte-buado9"&&(t.innerHTML=l),s=j(_),g.l(_),r=j(_),i=I(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(i)!=="svelte-4phel2"&&(i.innerHTML=a),_.forEach(m),this.h()},h(){h(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(e,"class","flex self-center"),h(e,"dir","ltr")},m(c,_){V(c,e,_),p(e,t),p(e,s),g.m(e,null),p(e,r),p(e,i),o||(f=[de(t,"click",n[48]),de(i,"click",n[52])],o=!0)},p(c,_){d===(d=u(c))&&g?g.p(c,_):(g.d(1),g=d(c),g&&(g.c(),g.m(e,r)))},d(c){c&&m(e),g.d(),o=!1,$e(f)}}}function Xa(n){let e,t=n[1].indexOf(n[7].id)+1+"",l,s,r=n[1].length+"",i,a,o;return{c(){e=y("div"),l=W(t),s=W("/"),i=W(r),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=w(e);l=q(u,t),s=q(u,"/"),i=q(u,r),u.forEach(m),this.h()},h(){h(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){V(f,e,u),p(e,l),p(e,s),p(e,i),a||(o=de(e,"dblclick",n[51]),a=!0)},p(f,u){u[0]&130&&t!==(t=f[1].indexOf(f[7].id)+1+"")&&K(l,t),u[0]&2&&r!==(r=f[1].length+"")&&K(i,r)},d(f){f&&m(e),a=!1,o()}}}function $a(n){let e,t,l,s,r,i,a=n[1].length+"",o,f,u;return{c(){e=y("div"),t=y("input"),i=W("/"),o=W(a),this.h()},l(d){e=I(d,"DIV",{class:!0});var g=w(e);t=I(g,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=q(g,"/"),o=q(g,a),g.forEach(m),this.h()},h(){h(t,"id",l="message-index-input-"+n[7].id),h(t,"type","number"),t.value=s=n[1].indexOf(n[7].id)+1,h(t,"min","1"),h(t,"max",r=n[1].length),h(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),h(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(d,g){V(d,e,g),p(e,t),p(e,i),p(e,o),f||(u=[de(t,"focus",nf),de(t,"blur",n[49]),de(t,"keydown",n[50])],f=!0)},p(d,g){g[0]&128&&l!==(l="message-index-input-"+d[7].id)&&h(t,"id",l),g[0]&130&&s!==(s=d[1].indexOf(d[7].id)+1)&&t.value!==s&&(t.value=s),g[0]&2&&r!==(r=d[1].length)&&h(t,"max",r),g[0]&2&&a!==(a=d[1].length+"")&&K(o,a)},d(d){d&&m(e),f=!1,$e(u)}}}function hn(n){let e,t,l=De(n[12]),s=[];for(let i=0;i<l.length;i+=1)s[i]=mn(Ys(n,l,i));const r=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=y("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=I(i,"DIV",{class:!0});var a=w(e);for(let o=0;o<s.length;o+=1)s[o].l(a);a.forEach(m),this.h()},h(){h(e,"class","flex items-center flex-wrap gap-2 -mx-2 mb-1")},m(i,a){V(i,e,a);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(e,null);t=!0},p(i,a){if(a[0]&4096){l=De(i[12]);let o;for(o=0;o<l.length;o+=1){const f=Ys(i,l,o);s[o]?(s[o].p(f,a),b(s[o],1)):(s[o]=mn(f),s[o].c(),b(s[o],1),s[o].m(e,null))}for(se(),o=l.length;o<s.length;o+=1)r(o);ne()}},i(i){if(!t){for(let a=0;a<l.length;a+=1)b(s[a]);t=!0}},o(i){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)D(s[a]);t=!1},d(i){i&&m(e),Ge(s,i)}}}function xa(n){var r;let e,t;function l(){return n[32](n[55])}function s(){return n[33](n[53])}return e=new Xt({props:{item:n[53],name:n[53].name,type:n[53].type,size:(r=n[53])==null?void 0:r.size,loading:n[53].status==="uploading",dismissible:!0,edit:!0}}),e.$on("dismiss",l),e.$on("click",s),{c(){x(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,a){te(e,i,a),t=!0},p(i,a){var f;n=i;const o={};a[0]&4096&&(o.item=n[53]),a[0]&4096&&(o.name=n[53].name),a[0]&4096&&(o.type=n[53].type),a[0]&4096&&(o.size=(f=n[53])==null?void 0:f.size),a[0]&4096&&(o.loading=n[53].status==="uploading"),e.$set(o)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){D(e.$$.fragment,i),t=!1},d(i){le(e,i)}}}function ef(n){let e,t,l,s,r,i,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-4"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',o,f,u,d;l=new Zt({props:{src:n[53].url,alt:"input",imageClassName:" size-14 rounded-xl object-cover"}});function g(){return n[31](n[55])}return{c(){e=y("div"),t=y("div"),x(l.$$.fragment),s=H(),r=y("div"),i=y("button"),i.innerHTML=a,o=H(),this.h()},l(c){e=I(c,"DIV",{class:!0});var _=w(e);t=I(_,"DIV",{class:!0});var v=w(t);ee(l.$$.fragment,v),v.forEach(m),s=j(_),r=I(_,"DIV",{class:!0});var M=w(r);i=I(M,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Ue(i)!=="svelte-1ki5d3w"&&(i.innerHTML=a),M.forEach(m),o=j(_),_.forEach(m),this.h()},h(){h(t,"class","relative flex items-center"),h(i,"class","bg-white text-black border border-white rounded-full group-hover:visible invisible transition"),h(i,"type","button"),h(r,"class","absolute -top-1 -right-1"),h(e,"class","relative group")},m(c,_){V(c,e,_),p(e,t),te(l,t,null),p(e,s),p(e,r),p(r,i),p(e,o),f=!0,u||(d=de(i,"click",g),u=!0)},p(c,_){n=c;const v={};_[0]&4096&&(v.src=n[53].url),l.$set(v)},i(c){f||(b(l.$$.fragment,c),f=!0)},o(c){D(l.$$.fragment,c),f=!1},d(c){c&&m(e),le(l),u=!1,d()}}}function mn(n){let e,t,l,s;const r=[ef,xa],i=[];function a(o,f){return o[53].type==="image"?0:1}return e=a(n),t=i[e]=r[e](n),{c(){t.c(),l=fe()},l(o){t.l(o),l=fe()},m(o,f){i[e].m(o,f),V(o,l,f),s=!0},p(o,f){let u=e;e=a(o),e===u?i[e].p(o,f):(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),t=i[e],t?t.p(o,f):(t=i[e]=r[e](o),t.c()),b(t,1),t.m(l.parentNode,l))},i(o){s||(b(t),s=!0)},o(o){D(t),s=!1},d(o){o&&m(l),i[e].d(o)}}}function tf(n){var L,O;let e,t,l,s,r,i,a,o,f,u,d,g,c;function _(k){n[28](k)}let v={title:n[14].t("Delete message?")};n[8]!==void 0&&(v.show=n[8]),e=new zn({props:v}),je.push(()=>Xe(e,"show",_)),e.$on("confirm",n[29]);let M=!(((L=n[15])==null?void 0:L.chatBubble)??!0)&&$s(n),E=!(((O=n[15])==null?void 0:O.chatBubble)??!0)&&xs(n),C=n[10]!==!0&&tn(n),R=n[7].content!==""&&nn(n);return{c(){x(e.$$.fragment),l=H(),s=y("div"),M&&M.c(),r=H(),i=y("div"),E&&E.c(),a=H(),o=y("div"),C&&C.c(),f=H(),R&&R.c(),this.h()},l(k){ee(e.$$.fragment,k),l=j(k),s=I(k,"DIV",{class:!0,dir:!0,id:!0});var N=w(s);M&&M.l(N),r=j(N),i=I(N,"DIV",{class:!0});var S=w(i);E&&E.l(S),a=j(S),o=I(S,"DIV",{class:!0});var B=w(o);C&&C.l(B),f=j(B),R&&R.l(B),B.forEach(m),S.forEach(m),N.forEach(m),this.h()},h(){h(o,"class",u="chat-"+n[7].role+" w-full min-w-full markdown-prose"),h(i,"class","flex-auto w-0 max-w-full pl-1"),h(s,"class","flex w-full user-message"),h(s,"dir",d=n[15].chatDirection),h(s,"id",g="message-"+n[7].id)},m(k,N){te(e,k,N),V(k,l,N),V(k,s,N),M&&M.m(s,null),p(s,r),p(s,i),E&&E.m(i,null),p(i,a),p(i,o),C&&C.m(o,null),p(o,f),R&&R.m(o,null),c=!0},p(k,N){var B,T;const S={};N[0]&16384&&(S.title=k[14].t("Delete message?")),!t&&N[0]&256&&(t=!0,S.show=k[8],Ye(()=>t=!1)),e.$set(S),((B=k[15])==null?void 0:B.chatBubble)??!0?M&&(se(),D(M,1,1,()=>{M=null}),ne()):M?(M.p(k,N),N[0]&32768&&b(M,1)):(M=$s(k),M.c(),b(M,1),M.m(s,r)),((T=k[15])==null?void 0:T.chatBubble)??!0?E&&(se(),D(E,1,1,()=>{E=null}),ne()):E?(E.p(k,N),N[0]&32768&&b(E,1)):(E=xs(k),E.c(),b(E,1),E.m(i,a)),k[10]!==!0?C?(C.p(k,N),N[0]&1024&&b(C,1)):(C=tn(k),C.c(),b(C,1),C.m(o,f)):C&&(se(),D(C,1,1,()=>{C=null}),ne()),k[7].content!==""?R?(R.p(k,N),N[0]&128&&b(R,1)):(R=nn(k),R.c(),b(R,1),R.m(o,null)):R&&(se(),D(R,1,1,()=>{R=null}),ne()),(!c||N[0]&128&&u!==(u="chat-"+k[7].role+" w-full min-w-full markdown-prose"))&&h(o,"class",u),(!c||N[0]&32768&&d!==(d=k[15].chatDirection))&&h(s,"dir",d),(!c||N[0]&128&&g!==(g="message-"+k[7].id))&&h(s,"id",g)},i(k){c||(b(e.$$.fragment,k),b(M),b(E),b(C),b(R),c=!0)},o(k){D(e.$$.fragment,k),D(M),D(E),D(C),D(R),c=!1},d(k){k&&(m(l),m(s)),le(e,k),M&&M.d(),E&&E.d(),C&&C.d(),R&&R.d()}}}const lf=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},sf=n=>{n.target.select()},nf=n=>{n.target.select()};function rf(n,e,t){let l,s,r,i;Ee(n,gt,ie=>t(15,s=ie)),Ee(n,jt,ie=>t(16,r=ie)),Ee(n,zt,ie=>t(17,i=ie));const a=Ke("i18n");Ee(n,a,ie=>t(14,l=ie)),at.extend(Ln);let{user:o}=e,{history:f}=e,{messageId:u}=e,{siblings:d}=e,{gotoMessage:g}=e,{showPreviousMessage:c}=e,{showNextMessage:_}=e,{editMessage:v}=e,{deleteMessage:M}=e,{isFirstMessage:E}=e,{readOnly:C}=e,R=!1,L=!1,O=!1,k="",N=[],S,B=JSON.parse(JSON.stringify(f.messages[u]));const T=async ie=>{await Rn(ie)&&He.success(l.t("Copying to clipboard was successful!"))},P=async()=>{t(10,O=!0),t(11,k=B.content),t(12,N=B.files),await Ve(),S&&(t(13,S.style.height="",S),t(13,S.style.height=`${S.scrollHeight}px`,S),S==null||S.focus())},Q=async(ie=!0)=>{v(B.id,{content:k,files:N},ie),t(10,O=!1),t(11,k=""),t(12,N=[])},F=()=>{t(10,O=!1),t(11,k=""),t(12,N=[])},re=async()=>{M(B.id)};kt(()=>{});function Y(ie){R=ie,t(8,R)}const oe=()=>{re()},he=ie=>ie.id===B.user,ue=ie=>{N.splice(ie,1),t(12,N)},ke=async ie=>{N.splice(ie,1),t(12,N)},U=ie=>{console.log(ie)};function Z(ie){je[ie?"unshift":"push"](()=>{S=ie,t(13,S)})}function ge(){k=this.value,t(11,k)}const pe=ie=>{var qe,Ze;ie.key==="Escape"&&((qe=document.getElementById("close-edit-message-button"))==null||qe.click());const Fe=ie.metaKey||ie.ctrlKey,tt=ie.key==="Enter";Fe&&tt&&((Ze=document.getElementById("confirm-edit-message-button"))==null||Ze.click())},_e=()=>{Q(!1)},J=()=>{F()},me=()=>{Q()},ae=()=>{c(B)},be=ie=>{g(B,ie.target.value-1),t(9,L=!1)},A=ie=>{ie.key==="Enter"&&(g(B,ie.target.value-1),t(9,L=!1))},G=async()=>{t(9,L=!0),await Ve();const ie=document.getElementById(`message-index-input-${B.id}`);ie&&(ie.focus(),ie.select())},$=()=>{_(B)},X=()=>{P()},ce=()=>{T(B.content)},ve=()=>{t(8,R=!0)},Te=()=>{c(B)},Ne=ie=>{g(B,ie.target.value-1),t(9,L=!1)},Ae=ie=>{ie.key==="Enter"&&(g(B,ie.target.value-1),t(9,L=!1))},ze=async()=>{t(9,L=!0),await Ve();const ie=document.getElementById(`message-index-input-${B.id}`);ie&&(ie.focus(),ie.select())},We=()=>{_(B)};return n.$$set=ie=>{"user"in ie&&t(0,o=ie.user),"history"in ie&&t(24,f=ie.history),"messageId"in ie&&t(25,u=ie.messageId),"siblings"in ie&&t(1,d=ie.siblings),"gotoMessage"in ie&&t(2,g=ie.gotoMessage),"showPreviousMessage"in ie&&t(3,c=ie.showPreviousMessage),"showNextMessage"in ie&&t(4,_=ie.showNextMessage),"editMessage"in ie&&t(26,v=ie.editMessage),"deleteMessage"in ie&&t(27,M=ie.deleteMessage),"isFirstMessage"in ie&&t(5,E=ie.isFirstMessage),"readOnly"in ie&&t(6,C=ie.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&50331776&&f.messages&&JSON.stringify(B)!==JSON.stringify(f.messages[u])&&t(7,B=JSON.parse(JSON.stringify(f.messages[u])))},[o,d,g,c,_,E,C,B,R,L,O,k,N,S,l,s,r,i,a,T,P,Q,F,re,f,u,v,M,Y,oe,he,ue,ke,U,Z,ge,pe,_e,J,me,ae,be,A,G,$,X,ce,ve,Te,Ne,Ae,ze,We]}class of extends Le{constructor(e){super(),Pe(this,e,rf,tf,Be,{user:0,history:24,messageId:25,siblings:1,gotoMessage:2,showPreviousMessage:3,showNextMessage:4,editMessage:26,deleteMessage:27,isFirstMessage:5,readOnly:6},null,[-1,-1])}}function gn(n){let e,t,l,s;const r=[uf,ff,af],i=[];function a(o,f){var u,d;return o[0].messages[o[3]].role==="user"?0:(((d=(u=o[0].messages[o[0].messages[o[3]].parentId])==null?void 0:u.models)==null?void 0:d.length)??1)===1?1:2}return e=a(n),t=i[e]=r[e](n),{c(){t.c(),l=fe()},l(o){t.l(o),l=fe()},m(o,f){i[e].m(o,f),V(o,l,f),s=!0},p(o,f){let u=e;e=a(o),e===u?i[e].p(o,f):(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),t=i[e],t?t.p(o,f):(t=i[e]=r[e](o),t.c()),b(t,1),t.m(l.parentNode,l))},i(o){s||(b(t),s=!0)},o(o){D(t),s=!1},d(o){o&&m(l),i[e].d(o)}}}function af(n){var i;let e,t,l;function s(a){n[22](a)}let r={chatId:n[1],messageId:n[3],isLastMessage:n[3]===((i=n[0])==null?void 0:i.currentId),updateChat:n[8],editMessage:n[9],saveMessage:n[10],rateMessage:n[12],actionMessage:n[13],submitMessage:n[14],deleteMessage:n[11],continueResponse:n[16],regenerateResponse:n[15],mergeResponses:n[17],triggerScroll:n[19],addMessages:n[18],readOnly:n[20]};return n[0]!==void 0&&(r.history=n[0]),e=new Pa({props:r}),je.push(()=>Xe(e,"history",s)),{c(){x(e.$$.fragment)},l(a){ee(e.$$.fragment,a)},m(a,o){te(e,a,o),l=!0},p(a,o){var u;const f={};o&2&&(f.chatId=a[1]),o&8&&(f.messageId=a[3]),o&9&&(f.isLastMessage=a[3]===((u=a[0])==null?void 0:u.currentId)),o&256&&(f.updateChat=a[8]),o&512&&(f.editMessage=a[9]),o&1024&&(f.saveMessage=a[10]),o&4096&&(f.rateMessage=a[12]),o&8192&&(f.actionMessage=a[13]),o&16384&&(f.submitMessage=a[14]),o&2048&&(f.deleteMessage=a[11]),o&65536&&(f.continueResponse=a[16]),o&32768&&(f.regenerateResponse=a[15]),o&131072&&(f.mergeResponses=a[17]),o&524288&&(f.triggerScroll=a[19]),o&262144&&(f.addMessages=a[18]),o&1048576&&(f.readOnly=a[20]),!t&&o&1&&(t=!0,f.history=a[0],Ye(()=>t=!1)),e.$set(f)},i(a){l||(b(e.$$.fragment,a),l=!0)},o(a){D(e.$$.fragment,a),l=!1},d(a){le(e,a)}}}function ff(n){var l;let e,t;return e=new Wn({props:{chatId:n[1],history:n[0],messageId:n[3],isLastMessage:n[3]===n[0].currentId,siblings:((l=n[0].messages[n[0].messages[n[3]].parentId])==null?void 0:l.childrenIds)??[],gotoMessage:n[5],showPreviousMessage:n[6],showNextMessage:n[7],updateChat:n[8],editMessage:n[9],saveMessage:n[10],rateMessage:n[12],actionMessage:n[13],submitMessage:n[14],deleteMessage:n[11],continueResponse:n[16],regenerateResponse:n[15],addMessages:n[18],readOnly:n[20]}}),{c(){x(e.$$.fragment)},l(s){ee(e.$$.fragment,s)},m(s,r){te(e,s,r),t=!0},p(s,r){var a;const i={};r&2&&(i.chatId=s[1]),r&1&&(i.history=s[0]),r&8&&(i.messageId=s[3]),r&9&&(i.isLastMessage=s[3]===s[0].currentId),r&9&&(i.siblings=((a=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:a.childrenIds)??[]),r&32&&(i.gotoMessage=s[5]),r&64&&(i.showPreviousMessage=s[6]),r&128&&(i.showNextMessage=s[7]),r&256&&(i.updateChat=s[8]),r&512&&(i.editMessage=s[9]),r&1024&&(i.saveMessage=s[10]),r&4096&&(i.rateMessage=s[12]),r&8192&&(i.actionMessage=s[13]),r&16384&&(i.submitMessage=s[14]),r&2048&&(i.deleteMessage=s[11]),r&65536&&(i.continueResponse=s[16]),r&32768&&(i.regenerateResponse=s[15]),r&262144&&(i.addMessages=s[18]),r&1048576&&(i.readOnly=s[20]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function uf(n){var l;let e,t;return e=new of({props:{user:n[4],history:n[0],messageId:n[3],isFirstMessage:n[2]===0,siblings:n[0].messages[n[3]].parentId!==null?((l=n[0].messages[n[0].messages[n[3]].parentId])==null?void 0:l.childrenIds)??[]:Object.values(n[0].messages).filter(_n).map(pn)??[],gotoMessage:n[5],showPreviousMessage:n[6],showNextMessage:n[7],editMessage:n[9],deleteMessage:n[11],readOnly:n[20]}}),{c(){x(e.$$.fragment)},l(s){ee(e.$$.fragment,s)},m(s,r){te(e,s,r),t=!0},p(s,r){var a;const i={};r&16&&(i.user=s[4]),r&1&&(i.history=s[0]),r&8&&(i.messageId=s[3]),r&4&&(i.isFirstMessage=s[2]===0),r&9&&(i.siblings=s[0].messages[s[3]].parentId!==null?((a=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:a.childrenIds)??[]:Object.values(s[0].messages).filter(_n).map(pn)??[]),r&32&&(i.gotoMessage=s[5]),r&64&&(i.showPreviousMessage=s[6]),r&128&&(i.showNextMessage=s[7]),r&512&&(i.editMessage=s[9]),r&2048&&(i.deleteMessage=s[11]),r&1048576&&(i.readOnly=s[20]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function cf(n){let e,t,l,s=n[0].messages[n[3]]&&gn(n);return{c(){e=y("div"),s&&s.c(),this.h()},l(r){e=I(r,"DIV",{class:!0});var i=w(e);s&&s.l(i),i.forEach(m),this.h()},h(){var r;h(e,"class",t="flex flex-col justify-between px-5 mb-3 w-full "+(((r=n[21])==null?void 0:r.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group")},m(r,i){V(r,e,i),s&&s.m(e,null),l=!0},p(r,[i]){var a;r[0].messages[r[3]]?s?(s.p(r,i),i&9&&b(s,1)):(s=gn(r),s.c(),b(s,1),s.m(e,null)):s&&(se(),D(s,1,1,()=>{s=null}),ne()),(!l||i&2097152&&t!==(t="flex flex-col justify-between px-5 mb-3 w-full "+(((a=r[21])==null?void 0:a.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group"))&&h(e,"class",t)},i(r){l||(b(s),l=!0)},o(r){D(s),l=!1},d(r){r&&m(e),s&&s.d()}}}const _n=n=>n.parentId===null,pn=n=>n.id;function df(n,e,t){let l;Ee(n,gt,T=>t(21,l=T)),vt(),Ke("i18n");let{chatId:s}=e,{idx:r=0}=e,{history:i}=e,{messageId:a}=e,{user:o}=e,{gotoMessage:f}=e,{showPreviousMessage:u}=e,{showNextMessage:d}=e,{updateChat:g}=e,{editMessage:c}=e,{saveMessage:_}=e,{deleteMessage:v}=e,{rateMessage:M}=e,{actionMessage:E}=e,{submitMessage:C}=e,{regenerateResponse:R}=e,{continueResponse:L}=e,{mergeResponses:O}=e,{addMessages:k}=e,{triggerScroll:N}=e,{readOnly:S=!1}=e;function B(T){i=T,t(0,i)}return n.$$set=T=>{"chatId"in T&&t(1,s=T.chatId),"idx"in T&&t(2,r=T.idx),"history"in T&&t(0,i=T.history),"messageId"in T&&t(3,a=T.messageId),"user"in T&&t(4,o=T.user),"gotoMessage"in T&&t(5,f=T.gotoMessage),"showPreviousMessage"in T&&t(6,u=T.showPreviousMessage),"showNextMessage"in T&&t(7,d=T.showNextMessage),"updateChat"in T&&t(8,g=T.updateChat),"editMessage"in T&&t(9,c=T.editMessage),"saveMessage"in T&&t(10,_=T.saveMessage),"deleteMessage"in T&&t(11,v=T.deleteMessage),"rateMessage"in T&&t(12,M=T.rateMessage),"actionMessage"in T&&t(13,E=T.actionMessage),"submitMessage"in T&&t(14,C=T.submitMessage),"regenerateResponse"in T&&t(15,R=T.regenerateResponse),"continueResponse"in T&&t(16,L=T.continueResponse),"mergeResponses"in T&&t(17,O=T.mergeResponses),"addMessages"in T&&t(18,k=T.addMessages),"triggerScroll"in T&&t(19,N=T.triggerScroll),"readOnly"in T&&t(20,S=T.readOnly)},[i,s,r,a,o,f,u,d,g,c,_,v,M,E,C,R,L,O,k,N,S,l,B]}class hf extends Le{constructor(e){super(),Pe(this,e,df,cf,Be,{chatId:1,idx:2,history:0,messageId:3,user:4,gotoMessage:5,showPreviousMessage:6,showNextMessage:7,updateChat:8,editMessage:9,saveMessage:10,deleteMessage:11,rateMessage:12,actionMessage:13,submitMessage:14,regenerateResponse:15,continueResponse:16,mergeResponses:17,addMessages:18,triggerScroll:19,readOnly:20})}}function bn(n,e,t){const l=n.slice();return l[14]=e[t],l[16]=t,l}function mf(n){let e,t,l,s,r;return{c(){e=y("div"),t=W(n[4]),l=W(" ‧ v"),s=W(_l),this.h()},l(i){e=I(i,"DIV",{class:!0});var a=w(e);t=q(a,n[4]),l=q(a," ‧ v"),s=q(a,_l),a.forEach(m),this.h()},h(){var i;h(e,"class",r="flex w-full "+(((i=n[3])==null?void 0:i.landingPageMode)==="chat"?" -mt-1":"text-center items-center justify-center")+" self-start text-gray-600 dark:text-gray-400")},m(i,a){V(i,e,a),p(e,t),p(e,l),p(e,s)},p(i,a){var o;a&16&&K(t,i[4]),a&8&&r!==(r="flex w-full "+(((o=i[3])==null?void 0:o.landingPageMode)==="chat"?" -mt-1":"text-center items-center justify-center")+" self-start text-gray-600 dark:text-gray-400")&&h(e,"class",r)},i:Me,o:Me,d(i){i&&m(e)}}}function gf(n){let e,t,l=n[2].t("Suggested")+"",s,r;return e=new qr({}),{c(){x(e.$$.fragment),t=H(),s=W(l)},l(i){ee(e.$$.fragment,i),t=j(i),s=q(i,l)},m(i,a){te(e,i,a),V(i,t,a),V(i,s,a),r=!0},p(i,a){(!r||a&4)&&l!==(l=i[2].t("Suggested")+"")&&K(s,l)},i(i){r||(b(e.$$.fragment,i),r=!0)},o(i){D(e.$$.fragment,i),r=!1},d(i){i&&(m(t),m(s)),le(e,i)}}}function vn(n){let e=[],t=new Map,l,s=De(n[1]);const r=i=>i[14].id||i[14].content;for(let i=0;i<s.length;i+=1){let a=bn(n,s,i),o=r(a);t.set(o,e[i]=kn(o,a))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();l=fe()},l(i){for(let a=0;a<e.length;a+=1)e[a].l(i);l=fe()},m(i,a){for(let o=0;o<e.length;o+=1)e[o]&&e[o].m(i,a);V(i,l,a)},p(i,a){a&70&&(s=De(i[1]),e=Jt(e,a,r,1,i,s,t,l.parentNode,Ir,kn,l,bn))},d(i){i&&m(l);for(let a=0;a<e.length;a+=1)e[a].d(i)}}}function _f(n){let e,t=n[14].content+"",l,s,r,i=n[2].t("Prompt")+"",a;return{c(){e=y("div"),l=W(t),s=H(),r=y("div"),a=W(i),this.h()},l(o){e=I(o,"DIV",{class:!0});var f=w(e);l=q(f,t),f.forEach(m),s=j(o),r=I(o,"DIV",{class:!0});var u=w(r);a=q(u,i),u.forEach(m),this.h()},h(){h(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),h(r,"class","text-xs text-gray-600 dark:text-gray-400 font-normal line-clamp-1")},m(o,f){V(o,e,f),p(e,l),V(o,s,f),V(o,r,f),p(r,a)},p(o,f){f&2&&t!==(t=o[14].content+"")&&K(l,t),f&4&&i!==(i=o[2].t("Prompt")+"")&&K(a,i)},d(o){o&&(m(e),m(s),m(r))}}}function pf(n){let e,t=n[14].title[0]+"",l,s,r,i=n[14].title[1]+"",a;return{c(){e=y("div"),l=W(t),s=H(),r=y("div"),a=W(i),this.h()},l(o){e=I(o,"DIV",{class:!0});var f=w(e);l=q(f,t),f.forEach(m),s=j(o),r=I(o,"DIV",{class:!0});var u=w(r);a=q(u,i),u.forEach(m),this.h()},h(){h(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),h(r,"class","text-xs text-gray-600 dark:text-gray-400 font-normal line-clamp-1")},m(o,f){V(o,e,f),p(e,l),V(o,s,f),V(o,r,f),p(r,a)},p(o,f){f&2&&t!==(t=o[14].title[0]+"")&&K(l,t),f&2&&i!==(i=o[14].title[1]+"")&&K(a,i)},d(o){o&&(m(e),m(s),m(r))}}}function kn(n,e){let t,l,s,r,i;function a(d,g){return d[14].title&&d[14].title[0]!==""?pf:_f}let o=a(e),f=o(e);function u(){return e[10](e[14])}return{key:n,first:null,c(){t=y("button"),l=y("div"),f.c(),s=H(),this.h()},l(d){t=I(d,"BUTTON",{class:!0,style:!0});var g=w(t);l=I(g,"DIV",{class:!0});var c=w(l);f.l(c),c.forEach(m),s=j(g),g.forEach(m),this.h()},h(){h(l,"class","flex flex-col text-left"),h(t,"class","waterfall flex flex-col flex-1 shrink-0 w-full justify-between px-3 py-2 rounded-xl bg-transparent hover:bg-black/5 dark:hover:bg-white/5 transition group svelte-1co34if"),Rt(t,"animation-delay",e[16]*60+"ms"),this.first=t},m(d,g){V(d,t,g),p(t,l),f.m(l,null),p(t,s),r||(i=de(t,"click",u),r=!0)},p(d,g){e=d,o===(o=a(e))&&f?f.p(e,g):(f.d(1),f=o(e),f&&(f.c(),f.m(l,null))),g&2&&Rt(t,"animation-delay",e[16]*60+"ms")},d(d){d&&m(t),f.d(),r=!1,i()}}}function bf(n){let e,t,l,s,r,i,a;const o=[gf,mf],f=[];function u(g,c){return g[1].length>0?0:1}t=u(n),l=f[t]=o[t](n);let d=n[1].length>0&&vn(n);return{c(){e=y("div"),l.c(),s=H(),r=y("div"),d&&d.c(),this.h()},l(g){e=I(g,"DIV",{class:!0});var c=w(e);l.l(c),c.forEach(m),s=j(g),r=I(g,"DIV",{class:!0});var _=w(r);d&&d.l(_),_.forEach(m),this.h()},h(){h(e,"class","mb-1 flex gap-1 text-xs font-medium items-center text-gray-600 dark:text-gray-400"),h(r,"class",i="h-40 overflow-auto scrollbar-none "+n[0]+" items-start svelte-1co34if")},m(g,c){V(g,e,c),f[t].m(e,null),V(g,s,c),V(g,r,c),d&&d.m(r,null),a=!0},p(g,[c]){let _=t;t=u(g),t===_?f[t].p(g,c):(se(),D(f[_],1,1,()=>{f[_]=null}),ne(),l=f[t],l?l.p(g,c):(l=f[t]=o[t](g),l.c()),b(l,1),l.m(e,null)),g[1].length>0?d?d.p(g,c):(d=vn(g),d.c(),d.m(r,null)):d&&(d.d(1),d=null),(!a||c&1&&i!==(i="h-40 overflow-auto scrollbar-none "+g[0]+" items-start svelte-1co34if"))&&h(r,"class",i)},i(g){a||(b(l),a=!0)},o(g){D(l),a=!1},d(g){g&&(m(e),m(s),m(r)),f[t].d(),d&&d.d()}}}function vf(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if((n[t].id??n[t].content)!==(e[t].id??e[t].content))return!1;return!0}function kf(n,e,t){let l,s,r;Ee(n,gt,E=>t(3,s=E)),Ee(n,Nr,E=>t(4,r=E));const i=Ke("i18n");Ee(n,i,E=>t(2,l=E));const a=vt();let{suggestionPrompts:o=[]}=e,{className:f=""}=e,{inputValue:u=""}=e,d=[];const g={keys:["content","title"],threshold:.5};let c,_=[];const v=E=>{if(E.length>500)t(1,_=[]);else{const C=E.trim()&&c?c.search(E.trim()).map(R=>R.item):d;vf(_,C)||t(1,_=C)}},M=E=>a("select",E.content);return n.$$set=E=>{"suggestionPrompts"in E&&t(7,o=E.suggestionPrompts),"className"in E&&t(0,f=E.className),"inputValue"in E&&t(8,u=E.inputValue)},n.$$.update=()=>{n.$$.dirty&384&&o&&(t(9,d=[...o??[]].sort(()=>Math.random()-.5)),v(u)),n.$$.dirty&512&&(c=new Yr(d,g)),n.$$.dirty&256&&v(u)},[f,_,l,s,r,i,a,o,u,d,M]}class wf extends Le{constructor(e){super(),Pe(this,e,kf,bf,Be,{suggestionPrompts:7,className:0,inputValue:8})}}function wn(n,e,t){const l=n.slice();return l[14]=e[t],l[16]=t,l}function yf(n){let e,t;return{c(){e=y("img"),this.h()},l(l){e=I(l,"IMG",{crossorigin:!0,src:!0,class:!0,alt:!0,draggable:!0}),this.h()},h(){var l,s,r;h(e,"crossorigin","anonymous"),Lt(e.src,t=((r=(s=(l=n[14])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.profile_image_url)??(n[5].language==="dg-DG"?"/doge.png":`${Pt}/static/favicon.png`))||h(e,"src",t),h(e,"class","size-[2.7rem] rounded-full border-[1px] border-gray-100 dark:border-none"),h(e,"alt","logo"),h(e,"draggable","false")},m(l,s){V(l,e,s)},p(l,s){var r,i,a;s&33&&!Lt(e.src,t=((a=(i=(r=l[14])==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:a.profile_image_url)??(l[5].language==="dg-DG"?"/doge.png":`${Pt}/static/favicon.png`))&&h(e,"src",t)},d(l){l&&m(e)}}}function yn(n){var o,f,u;let e,t,l,s,r,i;t=new Oe({props:{content:Ht.parse(bt(((u=(f=(o=n[0][n[4]])==null?void 0:o.info)==null?void 0:f.meta)==null?void 0:u.description)??"")),placement:"right",$$slots:{default:[yf]},$$scope:{ctx:n}}});function a(){return n[12](n[16])}return{c(){e=y("button"),x(t.$$.fragment),l=H()},l(d){e=I(d,"BUTTON",{});var g=w(e);ee(t.$$.fragment,g),l=j(g),g.forEach(m)},m(d,g){V(d,e,g),te(t,e,null),p(e,l),s=!0,r||(i=de(e,"click",a),r=!0)},p(d,g){var _,v,M;n=d;const c={};g&17&&(c.content=Ht.parse(bt(((M=(v=(_=n[0][n[4]])==null?void 0:_.info)==null?void 0:v.meta)==null?void 0:M.description)??""))),g&131105&&(c.$$scope={dirty:g,ctx:n}),t.$set(c)},i(d){s||(b(t.$$.fragment,d),s=!0)},o(d){D(t.$$.fragment,d),s=!1},d(d){d&&m(e),le(t),r=!1,i()}}}function In(n){let e,t;return e=new Oe({props:{content:n[5].t("This chat won’t appear in history and your messages will not be saved."),className:"w-full flex justify-center mb-0.5",placement:"top",$$slots:{default:[If]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s&32&&(r.content=l[5].t("This chat won’t appear in history and your messages will not be saved.")),s&131104&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function If(n){let e,t,l=n[5].t("Temporary Chat")+"",s,r;return t=new Hr({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=y("div"),x(t.$$.fragment),s=W(l),this.h()},l(i){e=I(i,"DIV",{class:!0});var a=w(e);ee(t.$$.fragment,a),s=q(a,l),a.forEach(m),this.h()},h(){h(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit")},m(i,a){V(i,e,a),te(t,e,null),p(e,s),r=!0},p(i,a){(!r||a&32)&&l!==(l=i[5].t("Temporary Chat")+"")&&K(s,l)},i(i){r||(b(t.$$.fragment,i),r=!0)},o(i){D(t.$$.fragment,i),r=!1},d(i){i&&m(e),le(t)}}}function Mf(n){var l;let e=n[5].t("Hello, {{name}}",{name:(l=n[7])==null?void 0:l.name})+"",t;return{c(){t=W(e)},l(s){t=q(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r&160&&e!==(e=s[5].t("Hello, {{name}}",{name:(i=s[7])==null?void 0:i.name})+"")&&K(t,e)},d(s){s&&m(t)}}}function Ef(n){var l;let e=((l=n[0][n[4]])==null?void 0:l.name)+"",t;return{c(){t=W(e)},l(s){t=q(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r&17&&e!==(e=((i=s[0][s[4]])==null?void 0:i.name)+"")&&K(t,e)},d(s){s&&m(t)}}}function Df(n){let e,t=n[5].t("How can I help you today?")+"",l;return{c(){e=y("div"),l=W(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var r=w(e);l=q(r,t),r.forEach(m),this.h()},h(){h(e,"class","font-medium text-gray-400 dark:text-gray-500 line-clamp-1 font-p")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r&32&&t!==(t=s[5].t("How can I help you today?")+"")&&K(l,t)},d(s){s&&m(e)}}}function Nf(n){var a,o,f,u,d,g;let e,t,l=Ht.parse(bt((f=(o=(a=n[0][n[4]])==null?void 0:a.info)==null?void 0:o.meta)==null?void 0:f.description))+"",s,r,i=((g=(d=(u=n[0][n[4]])==null?void 0:u.info)==null?void 0:d.meta)==null?void 0:g.user)&&Mn(n);return{c(){e=y("div"),t=new wr(!1),s=H(),i&&i.c(),r=fe(),this.h()},l(c){e=I(c,"DIV",{class:!0});var _=w(e);t=yr(_,!1),_.forEach(m),s=j(c),i&&i.l(c),r=fe(),this.h()},h(){t.a=null,h(e,"class","mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown")},m(c,_){V(c,e,_),t.m(l,e),V(c,s,_),i&&i.m(c,_),V(c,r,_)},p(c,_){var v,M,E,C,R,L;_&17&&l!==(l=Ht.parse(bt((E=(M=(v=c[0][c[4]])==null?void 0:v.info)==null?void 0:M.meta)==null?void 0:E.description))+"")&&t.p(l),(L=(R=(C=c[0][c[4]])==null?void 0:C.info)==null?void 0:R.meta)!=null&&L.user?i?i.p(c,_):(i=Mn(c),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},d(c){c&&(m(e),m(s),m(r)),i&&i.d(c)}}}function Mn(n){let e,t;function l(i,a){var o,f,u;return(u=(f=(o=i[0][i[4]])==null?void 0:o.info)==null?void 0:f.meta)!=null&&u.user.community?Cf:Vf}let s=l(n),r=s(n);return{c(){e=y("div"),t=W(`By
								`),r.c(),this.h()},l(i){e=I(i,"DIV",{class:!0});var a=w(e);t=q(a,`By
								`),r.l(a),a.forEach(m),this.h()},h(){h(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(i,a){V(i,e,a),p(e,t),r.m(e,null)},p(i,a){s===(s=l(i))&&r?r.p(i,a):(r.d(1),r=s(i),r&&(r.c(),r.m(e,null)))},d(i){i&&m(e),r.d()}}}function Vf(n){var l,s,r;let e=((r=(s=(l=n[0][n[4]])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.user.name)+"",t;return{c(){t=W(e)},l(i){t=q(i,e)},m(i,a){V(i,t,a)},p(i,a){var o,f,u;a&17&&e!==(e=((u=(f=(o=i[0][i[4]])==null?void 0:o.info)==null?void 0:f.meta)==null?void 0:u.user.name)+"")&&K(t,e)},d(i){i&&m(t)}}}function Cf(n){var r,i,a,o,f,u,d,g,c;let e,t=((a=(i=(r=n[0][n[4]])==null?void 0:r.info)==null?void 0:i.meta)!=null&&a.user.name?(u=(f=(o=n[0][n[4]])==null?void 0:o.info)==null?void 0:f.meta)==null?void 0:u.user.name:`@${(c=(g=(d=n[0][n[4]])==null?void 0:d.info)==null?void 0:g.meta)==null?void 0:c.user.username}`)+"",l,s;return{c(){e=y("a"),l=W(t),this.h()},l(_){e=I(_,"A",{href:!0});var v=w(e);l=q(v,t),v.forEach(m),this.h()},h(){var _,v,M;h(e,"href",s="https://openwebui.com/m/"+((M=(v=(_=n[0][n[4]])==null?void 0:_.info)==null?void 0:v.meta)==null?void 0:M.user.username))},m(_,v){V(_,e,v),p(e,l)},p(_,v){var M,E,C,R,L,O,k,N,S,B,T,P;v&17&&t!==(t=((C=(E=(M=_[0][_[4]])==null?void 0:M.info)==null?void 0:E.meta)!=null&&C.user.name?(O=(L=(R=_[0][_[4]])==null?void 0:R.info)==null?void 0:L.meta)==null?void 0:O.user.name:`@${(S=(N=(k=_[0][_[4]])==null?void 0:k.info)==null?void 0:N.meta)==null?void 0:S.user.username}`)+"")&&K(l,t),v&17&&s!==(s="https://openwebui.com/m/"+((P=(T=(B=_[0][_[4]])==null?void 0:B.info)==null?void 0:T.meta)==null?void 0:P.user.username))&&h(e,"href",s)},d(_){_&&m(e)}}}function En(n){var F,re,Y,oe,he,ue,ke;let e,t,l,s,r,i,a,o,f,u,d,g,c,_,v,M,E,C,R=De(n[0]),L=[];for(let U=0;U<R.length;U+=1)L[U]=yn(wn(n,R,U));const O=U=>D(L[U],1,1,()=>{L[U]=null});let k=n[6]&&In(n);function N(U,Z){var ge;return(ge=U[0][U[4]])!=null&&ge.name?Ef:Mf}let S=N(n),B=S(n);function T(U,Z){var ge,pe,_e;return((_e=(pe=(ge=U[0][U[4]])==null?void 0:ge.info)==null?void 0:pe.meta)==null?void 0:_e.description)??null?Nf:Df}let P=T(n),Q=P(n);return M=new wf({props:{className:"grid grid-cols-2",suggestionPrompts:((Y=(re=(F=n[1])==null?void 0:F.info)==null?void 0:re.meta)==null?void 0:Y.suggestion_prompts)??((ue=(he=(oe=n[0][n[4]])==null?void 0:oe.info)==null?void 0:he.meta)==null?void 0:ue.suggestion_prompts)??((ke=n[8])==null?void 0:ke.default_prompt_suggestions)??[]}}),M.$on("select",n[13]),{c(){e=y("div"),t=y("div"),l=y("div");for(let U=0;U<L.length;U+=1)L[U].c();r=H(),k&&k.c(),i=H(),a=y("div"),o=y("div"),f=y("div"),B.c(),d=H(),g=y("div"),Q.c(),_=H(),v=y("div"),x(M.$$.fragment),this.h()},l(U){e=I(U,"DIV",{class:!0});var Z=w(e);t=I(Z,"DIV",{class:!0});var ge=w(t);l=I(ge,"DIV",{class:!0});var pe=w(l);for(let A=0;A<L.length;A+=1)L[A].l(pe);pe.forEach(m),ge.forEach(m),r=j(Z),k&&k.l(Z),i=j(Z),a=I(Z,"DIV",{class:!0});var _e=w(a);o=I(_e,"DIV",{});var J=w(o);f=I(J,"DIV",{class:!0});var me=w(f);B.l(me),me.forEach(m),d=j(J),g=I(J,"DIV",{});var ae=w(g);Q.l(ae),ae.forEach(m),J.forEach(m),_e.forEach(m),_=j(Z),v=I(Z,"DIV",{class:!0});var be=w(v);ee(M.$$.fragment,be),be.forEach(m),Z.forEach(m),this.h()},h(){h(l,"class","flex -space-x-4 mb-0.5"),h(t,"class","flex justify-start"),h(f,"class","capitalize line-clamp-1"),h(a,"class","mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 font-medium text-left flex items-center gap-4 font-primary"),h(v,"class","w-full font-primary"),h(e,"class","m-auto w-full max-w-6xl px-8 lg:px-20")},m(U,Z){V(U,e,Z),p(e,t),p(t,l);for(let ge=0;ge<L.length;ge+=1)L[ge]&&L[ge].m(l,null);p(e,r),k&&k.m(e,null),p(e,i),p(e,a),p(a,o),p(o,f),B.m(f,null),p(o,d),p(o,g),Q.m(g,null),p(e,_),p(e,v),te(M,v,null),C=!0},p(U,Z){var pe,_e,J,me,ae,be,A;if(Z&49){R=De(U[0]);let G;for(G=0;G<R.length;G+=1){const $=wn(U,R,G);L[G]?(L[G].p($,Z),b(L[G],1)):(L[G]=yn($),L[G].c(),b(L[G],1),L[G].m(l,null))}for(se(),G=R.length;G<L.length;G+=1)O(G);ne()}U[6]?k?(k.p(U,Z),Z&64&&b(k,1)):(k=In(U),k.c(),b(k,1),k.m(e,i)):k&&(se(),D(k,1,1,()=>{k=null}),ne()),S===(S=N(U))&&B?B.p(U,Z):(B.d(1),B=S(U),B&&(B.c(),B.m(f,null))),P===(P=T(U))&&Q?Q.p(U,Z):(Q.d(1),Q=P(U),Q&&(Q.c(),Q.m(g,null)));const ge={};Z&275&&(ge.suggestionPrompts=((J=(_e=(pe=U[1])==null?void 0:pe.info)==null?void 0:_e.meta)==null?void 0:J.suggestion_prompts)??((be=(ae=(me=U[0][U[4]])==null?void 0:me.info)==null?void 0:ae.meta)==null?void 0:be.suggestion_prompts)??((A=U[8])==null?void 0:A.default_prompt_suggestions)??[]),M.$set(ge)},i(U){if(!C){for(let Z=0;Z<R.length;Z+=1)b(L[Z]);U&&(s||Bt(()=>{s=St(l,Ot,{duration:200}),s.start()})),b(k),U&&(u||Bt(()=>{u=St(f,Ot,{duration:200}),u.start()})),U&&(c||Bt(()=>{c=St(g,Ot,{duration:200,delay:200}),c.start()})),b(M.$$.fragment,U),U&&(E||Bt(()=>{E=St(v,Ot,{duration:200,delay:300}),E.start()})),C=!0}},o(U){L=L.filter(Boolean);for(let Z=0;Z<L.length;Z+=1)D(L[Z]);D(k),D(M.$$.fragment,U),C=!1},d(U){U&&m(e),Ge(L,U),k&&k.d(),B.d(),Q.d(),le(M)}}}function Tf(n){let e=n[3],t,l,s=En(n);return{c(){s.c(),t=fe()},l(r){s.l(r),t=fe()},m(r,i){s.m(r,i),V(r,t,i),l=!0},p(r,[i]){i&8&&Be(e,e=r[3])?(se(),D(s,1,1,Me),ne(),s=En(r),s.c(),b(s,1),s.m(t.parentNode,t)):s.p(r,i)},i(r){l||(b(s),l=!0)},o(r){D(s),l=!1},d(r){r&&m(t),s.d(r)}}}function Bf(n,e,t){let l,s,r,i,a;Ee(n,jt,E=>t(11,l=E)),Ee(n,Gt,E=>t(6,r=E)),Ee(n,zt,E=>t(7,i=E)),Ee(n,On,E=>t(8,a=E));const o=Ke("i18n");Ee(n,o,E=>t(5,s=E));let{modelIds:f=[]}=e,{models:u=[]}=e,{atSelectedModel:d}=e,{submitPrompt:g}=e,c=!1,_=0;kt(()=>{t(3,c=!0)});const v=E=>{t(4,_=E)},M=E=>{g(E.detail)};return n.$$set=E=>{"modelIds"in E&&t(10,f=E.modelIds),"models"in E&&t(0,u=E.models),"atSelectedModel"in E&&t(1,d=E.atSelectedModel),"submitPrompt"in E&&t(2,g=E.submitPrompt)},n.$$.update=()=>{n.$$.dirty&3072&&t(0,u=f.map(E=>l.find(C=>C.id===E))),n.$$.dirty&1025&&f.length>0&&t(4,_=u.length-1)},[u,d,g,c,_,s,r,i,a,o,f,l,v,M]}class Sf extends Le{constructor(e){super(),Pe(this,e,Bf,Tf,Be,{modelIds:10,models:0,atSelectedModel:1,submitPrompt:2})}}function Dn(n,e,t){const l=n.slice();return l[43]=e[t],l[45]=t,l}function Of(n){let e,t=n[3],l,s=Tn(n);return{c(){e=y("div"),s.c(),this.h()},l(r){e=I(r,"DIV",{class:!0});var i=w(e);s.l(i),i.forEach(m),this.h()},h(){h(e,"class","w-full pt-2")},m(r,i){V(r,e,i),s.m(e,null),l=!0},p(r,i){i[0]&8&&Be(t,t=r[3])?(se(),D(s,1,1,Me),ne(),s=Tn(r),s.c(),b(s,1),s.m(e,null)):s.p(r,i)},i(r){l||(b(s),l=!0)},o(r){D(s),l=!1},d(r){r&&m(e),s.d(r)}}}function Rf(n){let e,t;return e=new Sf({props:{modelIds:n[5],atSelectedModel:n[6],submitPrompt:n[34]}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&32&&(r.modelIds=l[5]),s[0]&64&&(r.atSelectedModel=l[6]),s[0]&65538&&(r.submitPrompt=l[34]),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Nn(n){let e,t;return e=new Qr({props:{$$slots:{default:[Lf]},$$scope:{ctx:n}}}),e.$on("visible",n[35]),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[1]&32768&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Lf(n){let e,t,l,s,r="Loading...",i;return t=new Qt({props:{className:" size-4"}}),{c(){e=y("div"),x(t.$$.fragment),l=H(),s=y("div"),s.textContent=r,this.h()},l(a){e=I(a,"DIV",{class:!0});var o=w(e);ee(t.$$.fragment,o),l=j(o),s=I(o,"DIV",{class:!0,"data-svelte-h":!0}),Ue(s)!=="svelte-17uns3n"&&(s.textContent=r),o.forEach(m),this.h()},h(){h(s,"class",""),h(e,"class","w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2")},m(a,o){V(a,e,o),te(t,e,null),p(e,l),p(e,s),i=!0},p:Me,i(a){i||(b(t.$$.fragment,a),i=!0)},o(a){D(t.$$.fragment,a),i=!1},d(a){a&&m(e),le(t)}}}function Vn(n,e){let t,l,s,r;function i(o){e[36](o)}let a={chatId:e[3],messageId:e[43].id,idx:e[45],user:e[4],gotoMessage:e[20],showPreviousMessage:e[21],showNextMessage:e[22],updateChat:e[19],editMessage:e[24],deleteMessage:e[27],rateMessage:e[23],actionMessage:e[25],saveMessage:e[26],submitMessage:e[10],regenerateResponse:e[8],continueResponse:e[7],mergeResponses:e[9],addMessages:e[11],triggerScroll:e[28],readOnly:e[12]};return e[0]!==void 0&&(a.history=e[0]),l=new hf({props:a}),je.push(()=>Xe(l,"history",i)),{key:n,first:null,c(){t=fe(),x(l.$$.fragment),this.h()},l(o){t=fe(),ee(l.$$.fragment,o),this.h()},h(){this.first=t},m(o,f){V(o,t,f),te(l,o,f),r=!0},p(o,f){e=o;const u={};f[0]&8&&(u.chatId=e[3]),f[0]&16384&&(u.messageId=e[43].id),f[0]&16384&&(u.idx=e[45]),f[0]&16&&(u.user=e[4]),f[0]&1024&&(u.submitMessage=e[10]),f[0]&256&&(u.regenerateResponse=e[8]),f[0]&128&&(u.continueResponse=e[7]),f[0]&512&&(u.mergeResponses=e[9]),f[0]&2048&&(u.addMessages=e[11]),f[0]&4096&&(u.readOnly=e[12]),!s&&f[0]&1&&(s=!0,u.history=e[0],Ye(()=>s=!1)),l.$set(u)},i(o){r||(b(l.$$.fragment,o),r=!0)},o(o){D(l.$$.fragment,o),r=!1},d(o){o&&m(t),le(l,o)}}}function Cn(n){let e;return{c(){e=y("div"),this.h()},l(t){e=I(t,"DIV",{class:!0}),w(e).forEach(m),this.h()},h(){h(e,"class","pb-6")},m(t,l){V(t,e,l)},d(t){t&&m(e)}}}function Tn(n){var v;let e,t=((v=n[14].at(0))==null?void 0:v.parentId)!==null,l,s=[],r=new Map,i,a,o,f,u,d=t&&Nn(n),g=De(n[14]);const c=M=>M[43].id;for(let M=0;M<g.length;M+=1){let E=Dn(n,g,M),C=c(E);r.set(C,s[M]=Vn(C,E))}let _=n[13]&&Cn();return{c(){e=y("div"),d&&d.c(),l=H();for(let M=0;M<s.length;M+=1)s[M].c();i=H(),a=y("div"),o=H(),_&&_.c(),f=fe(),this.h()},l(M){e=I(M,"DIV",{class:!0});var E=w(e);d&&d.l(E),l=j(E);for(let C=0;C<s.length;C+=1)s[C].l(E);E.forEach(m),i=j(M),a=I(M,"DIV",{class:!0}),w(a).forEach(m),o=j(M),_&&_.l(M),f=fe(),this.h()},h(){h(e,"class","w-full"),h(a,"class","pb-12")},m(M,E){V(M,e,E),d&&d.m(e,null),p(e,l);for(let C=0;C<s.length;C+=1)s[C]&&s[C].m(e,null);V(M,i,E),V(M,a,E),V(M,o,E),_&&_.m(M,E),V(M,f,E),u=!0},p(M,E){var C;E[0]&16384&&(t=((C=M[14].at(0))==null?void 0:C.parentId)!==null),t?d?(d.p(M,E),E[0]&16384&&b(d,1)):(d=Nn(M),d.c(),b(d,1),d.m(e,l)):d&&(se(),D(d,1,1,()=>{d=null}),ne()),E[0]&536371097&&(g=De(M[14]),se(),s=Jt(s,E,c,1,M,g,r,e,Bn,Vn,null,Dn),ne()),M[13]?_||(_=Cn(),_.c(),_.m(f.parentNode,f)):_&&(_.d(1),_=null)},i(M){if(!u){b(d);for(let E=0;E<g.length;E+=1)b(s[E]);u=!0}},o(M){D(d);for(let E=0;E<s.length;E+=1)D(s[E]);u=!1},d(M){M&&(m(e),m(i),m(a),m(o),m(f)),d&&d.d();for(let E=0;E<s.length;E+=1)s[E].d();_&&_.d(M)}}}function Pf(n){let e,t,l,s,r;const i=[Rf,Of],a=[];function o(f,u){var d;return u[0]&1&&(t=null),t==null&&(t=Object.keys(((d=f[0])==null?void 0:d.messages)??{}).length==0),t?0:1}return l=o(n,[-1,-1]),s=a[l]=i[l](n),{c(){e=y("div"),s.c(),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=w(e);s.l(u),u.forEach(m),this.h()},h(){h(e,"class",n[2])},m(f,u){V(f,e,u),a[l].m(e,null),r=!0},p(f,u){let d=l;l=o(f,u),l===d?a[l].p(f,u):(se(),D(a[d],1,1,()=>{a[d]=null}),ne(),s=a[l],s?s.p(f,u):(s=a[l]=i[l](f),s.c()),b(s,1),s.m(e,null)),(!r||u[0]&4)&&h(e,"class",f[2])},i(f){r||(b(s),r=!0)},o(f){D(s),r=!1},d(f){f&&m(e),a[l].d()}}}function Af(n,e,t){let l,s,r,i,a;Ee(n,gt,A=>t(37,l=A)),Ee(n,pl,A=>t(38,s=A)),Ee(n,Gt,A=>t(39,r=A)),Ee(n,zt,A=>t(40,i=A)),vt();const o=Ke("i18n");Ee(n,o,A=>t(16,a=A));let{className:f="h-full flex pt-8"}=e,{chatId:u=""}=e,{user:d=i}=e,{prompt:g}=e,{history:c={}}=e,{selectedModels:_}=e,{atSelectedModel:v}=e,M=[],{sendPrompt:E}=e,{continueResponse:C}=e,{regenerateResponse:R}=e,{mergeResponses:L}=e,{chatActionHandler:O}=e,{showMessage:k=()=>{}}=e,{submitMessage:N=()=>{}}=e,{addMessages:S=()=>{}}=e,{readOnly:B=!1}=e,{bottomPadding:T=!1}=e,{autoScroll:P}=e,Q=20,F=!1;const re=async()=>{const A=document.getElementById("messages-container");A.scrollTop=A.scrollTop+100,t(15,F=!0),t(33,Q+=20),await Ve(),t(15,F=!1)},Y=()=>{const A=document.getElementById("messages-container");A.scrollTop=A.scrollHeight},oe=async()=>{r||(t(0,c),await Ve(),await Tr(localStorage.token,u,{history:c,messages:M}),pl.set(1),await Vr.set(await Br(localStorage.token,s)))},he=async(A,G)=>{let $;A.parentId!==null?$=c.messages[A.parentId].childrenIds:$=Object.values(c.messages).filter(ce=>ce.parentId===null).map(ce=>ce.id),G=Math.max(0,Math.min(G,$.length-1));let X=$[G];if(A.id!==X){let ce=c.messages[X].childrenIds;for(;ce.length!==0;)X=ce.at(-1),ce=c.messages[X].childrenIds;t(0,c.currentId=X,c)}if(await Ve(),(l==null?void 0:l.scrollOnBranchChange)??!0){const ce=document.getElementById("messages-container");t(29,P=ce.scrollHeight-ce.scrollTop<=ce.clientHeight+50),setTimeout(()=>{Y()},100)}},ue=async A=>{if(A.parentId!==null){let G=c.messages[A.parentId].childrenIds[Math.max(c.messages[A.parentId].childrenIds.indexOf(A.id)-1,0)];if(A.id!==G){let $=c.messages[G].childrenIds;for(;$.length!==0;)G=$.at(-1),$=c.messages[G].childrenIds;t(0,c.currentId=G,c)}}else{let G=Object.values(c.messages).filter(X=>X.parentId===null).map(X=>X.id),$=G[Math.max(G.indexOf(A.id)-1,0)];if(A.id!==$){let X=c.messages[$].childrenIds;for(;X.length!==0;)$=X.at(-1),X=c.messages[$].childrenIds;t(0,c.currentId=$,c)}}if(await Ve(),(l==null?void 0:l.scrollOnBranchChange)??!0){const G=document.getElementById("messages-container");t(29,P=G.scrollHeight-G.scrollTop<=G.clientHeight+50),setTimeout(()=>{Y()},100)}},ke=async A=>{if(A.parentId!==null){let G=c.messages[A.parentId].childrenIds[Math.min(c.messages[A.parentId].childrenIds.indexOf(A.id)+1,c.messages[A.parentId].childrenIds.length-1)];if(A.id!==G){let $=c.messages[G].childrenIds;for(;$.length!==0;)G=$.at(-1),$=c.messages[G].childrenIds;t(0,c.currentId=G,c)}}else{let G=Object.values(c.messages).filter(X=>X.parentId===null).map(X=>X.id),$=G[Math.min(G.indexOf(A.id)+1,G.length-1)];if(A.id!==$){let X=c.messages[$].childrenIds;for(;X.length!==0;)$=X.at(-1),X=c.messages[$].childrenIds;t(0,c.currentId=$,c)}}if(await Ve(),(l==null?void 0:l.scrollOnBranchChange)??!0){const G=document.getElementById("messages-container");t(29,P=G.scrollHeight-G.scrollTop<=G.clientHeight+50),setTimeout(()=>{Y()},100)}},U=async(A,G)=>{t(0,c.messages[A].annotation={...c.messages[A].annotation,rating:G},c),await oe()},Z=async(A,{content:G,files:$},X=!0)=>{if(c.messages[A].role==="user")if(X){let ce=G,ve=bl(),Te={id:ve,parentId:c.messages[A].parentId,childrenIds:[],role:"user",content:ce,...$&&{files:$},models:_,timestamp:Math.floor(Date.now()/1e3)},Ne=c.messages[A].parentId;Ne!==null&&t(0,c.messages[Ne].childrenIds=[...c.messages[Ne].childrenIds,ve],c),t(0,c.messages[ve]=Te,c),t(0,c.currentId=ve,c),await Ve(),await E(c,ce,ve)}else t(0,c.messages[A].content=G,c),t(0,c.messages[A].files=$,c),await oe();else if(X){const ce=bl(),ve=c.messages[A],Te=ve.parentId,Ne={...ve,id:ce,parentId:Te,childrenIds:[],files:void 0,content:G,timestamp:Math.floor(Date.now()/1e3)};t(0,c.messages[ce]=Ne,c),t(0,c.currentId=ce,c),Te!==null&&t(0,c.messages[Te].childrenIds=[...c.messages[Te].childrenIds,ce],c),await oe()}else t(0,c.messages[A].originalContent=c.messages[A].content,c),t(0,c.messages[A].content=G,c),await oe()},ge=async(A,G,$=null)=>{await O(u,A,G.model,G.id,$)},pe=async(A,G)=>{t(0,c.messages[A]=G,c),await oe()},_e=async A=>{const G=c.messages[A],$=G.parentId,X=G.childrenIds??[],ce=X.flatMap(ve=>{var Te;return((Te=c.messages[ve])==null?void 0:Te.childrenIds)??[]});$&&c.messages[$]&&t(0,c.messages[$].childrenIds=[...c.messages[$].childrenIds.filter(ve=>ve!==A),...ce],c),ce.forEach(ve=>{c.messages[ve]&&t(0,c.messages[ve].parentId=$,c)}),[A,...X].forEach(ve=>{delete c.messages[ve]}),await Ve(),k({id:$}),await oe()},J=()=>{if(P){const A=document.getElementById("messages-container");t(29,P=A.scrollHeight-A.scrollTop<=A.clientHeight+50),setTimeout(()=>{Y()},100)}},me=async A=>{let G=A;if(A.includes("{{CLIPBOARD}}")){const $=await navigator.clipboard.readText().catch(X=>(He.error(a.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));G=A.replaceAll("{{CLIPBOARD}}",$)}t(1,g=G),await Ve()},ae=A=>{console.log("visible"),F||re()};function be(A){c=A,t(0,c)}return n.$$set=A=>{"className"in A&&t(2,f=A.className),"chatId"in A&&t(3,u=A.chatId),"user"in A&&t(4,d=A.user),"prompt"in A&&t(1,g=A.prompt),"history"in A&&t(0,c=A.history),"selectedModels"in A&&t(5,_=A.selectedModels),"atSelectedModel"in A&&t(6,v=A.atSelectedModel),"sendPrompt"in A&&t(30,E=A.sendPrompt),"continueResponse"in A&&t(7,C=A.continueResponse),"regenerateResponse"in A&&t(8,R=A.regenerateResponse),"mergeResponses"in A&&t(9,L=A.mergeResponses),"chatActionHandler"in A&&t(31,O=A.chatActionHandler),"showMessage"in A&&t(32,k=A.showMessage),"submitMessage"in A&&t(10,N=A.submitMessage),"addMessages"in A&&t(11,S=A.addMessages),"readOnly"in A&&t(12,B=A.readOnly),"bottomPadding"in A&&t(13,T=A.bottomPadding),"autoScroll"in A&&t(29,P=A.autoScroll)},n.$$.update=()=>{if(n.$$.dirty[0]&1|n.$$.dirty[1]&4)if(c.currentId){let A=[],G=c.messages[c.currentId];for(;G&&A.length<=Q;)A.unshift({...G}),G=G.parentId!==null?c.messages[G.parentId]:null;t(14,M=A)}else t(14,M=[]);n.$$.dirty[0]&536879104&&P&&T&&(async()=>(await Ve(),Y()))()},[c,g,f,u,d,_,v,C,R,L,N,S,B,T,M,F,a,o,re,oe,he,ue,ke,U,Z,ge,pe,_e,J,P,E,O,k,Q,me,ae,be]}class Iu extends Le{constructor(e){super(),Pe(this,e,Af,Pf,Be,{className:2,chatId:3,user:4,prompt:1,history:0,selectedModels:5,atSelectedModel:6,sendPrompt:30,continueResponse:7,regenerateResponse:8,mergeResponses:9,chatActionHandler:31,showMessage:32,submitMessage:10,addMessages:11,readOnly:12,bottomPadding:13,autoScroll:29},null,[-1,-1])}}export{$r as K,Iu as M,wf as S};
//# sourceMappingURL=DQYvFDO1.js.map
